<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>사주ON</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- 카카오 로그인 SDK -->
  <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.2/kakao.min.js" 
          integrity="sha384-TiCUE00h649CAMonG018J2ujOgDKW/kVWlChEvu4SAcv8iHmal9Br4Te7i9/RRD+" 
          crossorigin="anonymous"></script>
  <!-- 토스페이먼츠 SDK -->
  <script src="https://js.tosspayments.com/v1/payment"></script>
  <style>
    body { font-family: 'Noto Sans KR', sans-serif; background: #1a1a2e; }
    .glass { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
    .gradient-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .gradient-gold { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .text-gradient { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
  </style>
</head>
<body class="text-white">
<div id="app"></div>

<script type="module">
// ========== 만세력 라이브러리 ==========
import { lunarToSolar, calculateSaju, getSolarTermsByYear } from "https://esm.sh/@fullstackfamily/manseryeok@latest?bundle";
import React, { useState } from 'https://esm.sh/react@18';
import ReactDOM from 'https://esm.sh/react-dom@18/client';

// ========== 기본 데이터 ==========
const STEMS = { names: ['甲','乙','丙','丁','戊','己','庚','辛','壬','癸'], korean: ['갑','을','병','정','무','기','경','신','임','계'], elements: ['목','목','화','화','토','토','금','금','수','수'] };
const BRANCHES = { names: ['子','丑','寅','卯','辰','巳','午','未','申','酉','戌','亥'], korean: ['자','축','인','묘','진','사','오','미','신','유','술','해'], elements: ['수','토','목','목','토','화','화','토','금','금','토','수'] };
const COLORS = { 목:'#22c55e', 화:'#ef4444', 토:'#eab308', 금:'#9ca3af', 수:'#3b82f6' };
const TEN_GODS = ['비견','겁재','식신','상관','편재','정재','편관','정관','편인','정인'];
const TWELVE = ['장생','목욕','관대','건록','제왕','쇠','병','사','묘','절','태','양'];
const SINSAL_12 = {'子':['겁살','재살','천살','지살','연살','월살','망신살','장성살','반안살','역마살','육해살','화개살'],'丑':['화개살','겁살','재살','천살','지살','연살','월살','망신살','장성살','반안살','역마살','육해살'],'寅':['육해살','화개살','겁살','재살','천살','지살','연살','월살','망신살','장성살','반안살','역마살'],'卯':['역마살','육해살','화개살','겁살','재살','천살','지살','연살','월살','망신살','장성살','반안살'],'辰':['반안살','역마살','육해살','화개살','겁살','재살','천살','지살','연살','월살','망신살','장성살'],'巳':['장성살','반안살','역마살','육해살','화개살','겁살','재살','천살','지살','연살','월살','망신살'],'午':['망신살','장성살','반안살','역마살','육해살','화개살','겁살','재살','천살','지살','연살','월살'],'未':['월살','망신살','장성살','반안살','역마살','육해살','화개살','겁살','재살','천살','지살','연살'],'申':['연살','월살','망신살','장성살','반안살','역마살','육해살','화개살','겁살','재살','천살','지살'],'酉':['지살','연살','월살','망신살','장성살','반안살','역마살','육해살','화개살','겁살','재살','천살'],'戌':['천살','지살','연살','월살','망신살','장성살','반안살','역마살','육해살','화개살','겁살','재살'],'亥':['재살','천살','지살','연살','월살','망신살','장성살','반안살','역마살','육해살','화개살','겁살']};

// 지장간
const JIJANGGAN = { '子':'임계','丑':'기계신','寅':'무병갑','卯':'을','辰':'을계무','巳':'무경병','午':'기정','未':'정을기','申':'무임경','酉':'신','戌':'신정무','亥':'갑임' };

// ========== 신살 데이터 ==========
const HYOSIN_A={'丁':'午酉','己':'丑','辛':'亥','壬':'酉','癸':'酉'};
const TAEGUK_A={'甲':'子午','乙':'子午','丙':'卯酉','丁':'卯酉','戊':'辰戌丑未','己':'辰戌丑未','庚':'寅亥申','辛':'寅亥申午酉','壬':'戌','癸':'巳亥'};
const HONGYAN_B={'甲':'午','乙':'申','丙':'寅','丁':'未','戊':'辰','己':'辰','庚':'戌','辛':'酉','壬':'申','癸':'申'};
const YEOYEON_B={'甲':'寅','乙':'卯','丙':'辰','丁':'巳丑','戊':'辰','己':'巳未','庚':'午寅','辛':'未','壬':'申','癸':'酉'};
const HYUNCHIM_B={'甲':'戌','乙':'巳','丙':'申子','丁':'丑','戊':'申午','己':'丑','庚':'','辛':'巳酉丑','壬':'申戌','癸':''};
const NACHEDO_B={'甲':'子','乙':'丑','丙':'寅','丁':'卯','戊':'辰','己':'巳','庚':'午','辛':'未','壬':'申戌','癸':'酉'};
const GUCHU_B={'甲':'辰','乙':'巳','丙':'午','丁':'未','戊':'午','己':'酉','庚':'戌','辛':'酉','壬':'子','癸':'丑'};
const AMROK_B={'甲':'子亥','乙':'子','丙':'寅','丁':'卯丑','戊':'申','己':'酉未','庚':'巳','辛':'午','壬':'申','癸':'酉'};
const JANGGUN_B={'甲':'子','乙':'丑','丙':'寅午','丁':'卯','戊':'辰午','己':'巳','庚':'午','辛':'未','壬':'申','癸':'酉'};
const TOESIN_B={'甲':'申','乙':'酉','丙':'亥','丁':'子丑未','戊':'亥','己':'子','庚':'寅','辛':'卯','壬':'巳','癸':'午'};
const YUKSU_B={'甲':'巳','乙':'午','丙':'申午','丁':'酉','戊':'申午','己':'酉丑未','庚':'亥','辛':'子','壬':'寅','癸':'卯'};
const EUMYOK_B={'甲':'卯','乙':'寅','丙':'午','丁':'巳','戊':'午','己':'巳未','庚':'酉','辛':'申','壬':'子','癸':'亥'};
const NAKJEONG_B={'甲':'巳','乙':'午','丙':'申','丁':'酉','戊':'申','己':'酉','庚':'亥','辛':'子','壬':'寅戌','癸':'卯'};
const ILDEOK_B={'甲':'寅子','乙':'卯','丙':'巳','丁':'午','戊':'巳','己':'午','庚':'申辰','辛':'酉','壬':'亥','癸':'子'};
const CHILSAL_B={'甲':'申子','乙':'酉','丙':'亥','丁':'子','戊':'寅','己':'卯','庚':'巳','辛':'午','壬':'申','癸':'酉'};
const UICHEO_B={'甲':'卯','乙':'寅巳','丙':'午','丁':'巳','戊':'午','己':'巳','庚':'酉寅辰','辛':'申巳','壬':'子','癸':'亥'};
const JINSIN_B={'甲':'酉午','乙':'戌','丙':'子','丁':'丑','戊':'子','己':'丑','庚':'卯','辛':'辰酉','壬':'午戌','癸':'未酉'};
const KYOSIN_B={'丙':'午子','辛':'酉'};
const BAEKHO_C={'甲':'辰','乙':'巳','丙':'午','丁':'丑未','戊':'午','己':'未','庚':'戌','辛':'亥','壬':'戌子','癸':'丑'};
const JAEGO_C={'甲':'辰戌','乙':'辰戌','丙':'丑未','丁':'丑未','戊':'辰戌丑未申','己':'辰戌丑未','庚':'丑未','辛':'丑未酉','壬':'辰戌','癸':'辰戌'};
const CHEOLSA_C={'甲':'辰','乙':'巳','丙':'午申','丁':'未','戊':'午','己':'未','庚':'戌','辛':'亥','壬':'戌子','癸':'丑'};
const PYEONGDU_C={'甲':'辰戌','乙':'辰戌','丙':'辰戌','丁':'辰戌','戊':'辰戌','己':'辰戌','庚':'丑未','辛':'丑未','壬':'丑未戌','癸':'丑未'};
const GEUMYEO_C={'甲':'辰','乙':'巳','丙':'未','丁':'申','戊':'未','己':'申','庚':'戌','辛':'亥','壬':'丑','癸':'寅'};
const GEUMSIN_YEAR=['酉'];
const GANYEOJIDONG=['甲寅','乙卯','丙巳','丁午','戊午','己巳','庚申','辛酉','壬亥','壬子','癸子'];
const GEUMYEOROK = {'甲':'辰','乙':'巳','丙':'未','丁':'申','戊':'未','己':'申','庚':'戌','辛':'亥','壬':'丑','癸':'寅'};
const CHEONJU = {'甲':'巳午','乙':'午','丙':'申','丁':'酉','戊':'申酉','己':'亥子','庚':'亥','辛':'寅','壬':'寅','癸':'卯'};
const BOKSEONG = {'甲':'寅丑','乙':'卯戌','丙':'巳亥','丁':'午戌','戊':'巳丑','己':'午寅','庚':'申亥','辛':'酉戌','壬':'亥丑','癸':'子寅'};
const CHEONGWAN = {'甲':'未','乙':'辰','丙':'酉','丁':'亥','戊':'酉','己':'亥','庚':'子','辛':'寅','壬':'卯','癸':'巳'};
const GORAN = ['甲寅','乙巳','戊申','辛亥','壬子','丁巳','戊午','己巳','庚申','辛酉'];
const GWASUK_MAP = {'寅':'亥','午':'亥','戌':'亥','申':'巳','子':'巳','辰':'巳','巳':'寅','酉':'寅','丑':'寅','亥':'申','卯':'申','未':'申'};
const GOSIN_MAP = {'寅':'巳','午':'巳','戌':'巳','申':'亥','子':'亥','辰':'亥','巳':'申','酉':'申','丑':'申','亥':'寅','卯':'寅','未':'寅'};
const TANGHWA = {'甲':'午','乙':'巳','丙':'寅','丁':'卯','戊':'寅','己':'卯','庚':'子','辛':'亥','壬':'酉','癸':'申'};
const CHEONUI = {'甲':'丑','乙':'子','丙':'卯','丁':'寅','戊':'卯','己':'寅','庚':'巳','辛':'辰','壬':'未','癸':'午'};

// ========== 절기 함수 ==========
function getJeolgiPrecise(year, month, day, hour, minute) {
  const targetMs = Date.UTC(year, month - 1, day, hour - 9, minute || 0);
  const years = [year - 1, year, year + 1];
  const allTerms = [];
  
  for (const y of years) {
    try {
      const terms = getSolarTermsByYear(y) || [];
      for (const t of terms) {
        const isJeolgi = t.isJeolgi === true || t.isJeol === true || 
          ['입춘','경칩','청명','입하','망종','소서','입추','백로','한로','입동','대설','소한'].some(n => (t.name || '').includes(n));
        if (!isJeolgi) continue;
        
        const hh = t.hour ?? t.hh ?? 0;
        const mm = t.minute ?? t.min ?? 0;
        const ms = Date.UTC(y, (t.month || 1) - 1, t.day || 1, hh - 9, mm);
        
        let sajuMonth = null;
        if (t.name?.includes('소한')) sajuMonth = 12;
        else if (t.name?.includes('입춘')) sajuMonth = 1;
        else if (t.name?.includes('경칩')) sajuMonth = 2;
        else if (t.name?.includes('청명')) sajuMonth = 3;
        else if (t.name?.includes('입하')) sajuMonth = 4;
        else if (t.name?.includes('망종')) sajuMonth = 5;
        else if (t.name?.includes('소서')) sajuMonth = 6;
        else if (t.name?.includes('입추')) sajuMonth = 7;
        else if (t.name?.includes('백로')) sajuMonth = 8;
        else if (t.name?.includes('한로')) sajuMonth = 9;
        else if (t.name?.includes('입동')) sajuMonth = 10;
        else if (t.name?.includes('대설')) sajuMonth = 11;
        
        if (sajuMonth !== null) {
          allTerms.push({ year: y, name: t.name, month: t.month, day: t.day, hour: hh, minute: mm, sajuMonth, epochMs: ms });
        }
      }
    } catch (e) { console.error('절기 로드 실패:', y, e); }
  }
  
  allTerms.sort((a, b) => a.epochMs - b.epochMs);
  let prevTerm = null;
  for (const term of allTerms) {
    if (term.epochMs <= targetMs) prevTerm = term;
    else break;
  }
  return prevTerm;
}

function getSajuMonthByDate(month, day) {
  if (month === 1) return day >= 6 ? 12 : 11;
  if (month === 2) return day >= 4 ? 1 : 12;
  if (month === 3) return day >= 6 ? 2 : 1;
  if (month === 4) return day >= 5 ? 3 : 2;
  if (month === 5) return day >= 6 ? 4 : 3;
  if (month === 6) return day >= 6 ? 5 : 4;
  if (month === 7) return day >= 7 ? 6 : 5;
  if (month === 8) return day >= 8 ? 7 : 6;
  if (month === 9) return day >= 8 ? 8 : 7;
  if (month === 10) return day >= 9 ? 9 : 8;
  if (month === 11) return day >= 8 ? 10 : 9;
  return day >= 7 ? 11 : 10;
}

function sajuMonthToBranchIndex(sajuMonth) {
  if (sajuMonth === 11) return 0;
  if (sajuMonth === 12) return 1;
  return sajuMonth + 1;
}

function getMonthStemIndex(yearStemIndex, sajuMonth) {
  const inMonthBase = [2, 4, 6, 8, 0][yearStemIndex % 5];
  let offset;
  if (sajuMonth >= 1 && sajuMonth <= 10) offset = sajuMonth - 1;
  else if (sajuMonth === 11) offset = 10;
  else offset = 11;
  return (inMonthBase + offset) % 10;
}

function calculateMonthPillar(solarYear, solarMonth, solarDay, hour, minute, yearStemIndex) {
  let sajuMonth = null;
  let usedMode = 'fallback';
  
  try {
    const jeolgi = getJeolgiPrecise(solarYear, solarMonth, solarDay, hour || 12, minute || 0);
    if (jeolgi && jeolgi.sajuMonth != null) {
      sajuMonth = jeolgi.sajuMonth;
      usedMode = 'precise';
    }
  } catch (e) { console.error('절기 정밀 계산 실패:', e); }
  
  if (sajuMonth === null) {
    sajuMonth = getSajuMonthByDate(solarMonth, solarDay);
    usedMode = 'fallback';
  }
  
  let effectiveYearStem = yearStemIndex;
  if (solarMonth === 1 || (solarMonth === 2 && solarDay < 4)) {
    effectiveYearStem = (yearStemIndex - 1 + 10) % 10;
  }
  
  const monthBranchIndex = sajuMonthToBranchIndex(sajuMonth);
  const monthStemIndex = getMonthStemIndex(effectiveYearStem, sajuMonth);
  
  return { si: monthStemIndex, bi: monthBranchIndex, stem: STEMS.names[monthStemIndex], branch: BRANCHES.names[monthBranchIndex], sajuMonth, usedMode };
}

// ========== 계산 함수들 ==========
function calculateSajuFromLib(year, month, day, hour, minute, isLunar, isLeapMonth) {
  let solarY = year, solarM = month, solarD = day;
  
  if (isLunar) {
    try {
      const conv = lunarToSolar(year, month, day, !!isLeapMonth);
      solarY = conv.solar.year;
      solarM = conv.solar.month;
      solarD = conv.solar.day;
    } catch (e) { console.error('음력 변환 실패:', e); }
  }
  
  const options = { longitude: 127, applyTimeCorrection: true };
  const saju = calculateSaju(solarY, solarM, solarD, hour ?? 12, minute ?? 0, options);
  
  const parseHanja = (str) => {
    if (!str || str.length < 2) return { stem: '甲', branch: '子' };
    return { stem: str[0], branch: str[1] };
  };
  
  const year_p = parseHanja(saju.yearPillarHanja);
  const day_p = parseHanja(saju.dayPillarHanja);
  const hour_p = parseHanja(saju.hourPillarHanja);
  
  const getSi = (stem) => STEMS.names.indexOf(stem);
  const getBi = (branch) => BRANCHES.names.indexOf(branch);
  
  const yearPillar = { si: getSi(year_p.stem), bi: getBi(year_p.branch), stem: year_p.stem, branch: year_p.branch };
  const monthPillar = calculateMonthPillar(solarY, solarM, solarD, hour, minute, yearPillar.si);
  const dayPillar = { si: getSi(day_p.stem), bi: getBi(day_p.branch), stem: day_p.stem, branch: day_p.branch };
  const hourPillar = hour !== null && hour !== undefined ? { si: getSi(hour_p.stem), bi: getBi(hour_p.branch), stem: hour_p.stem, branch: hour_p.branch } : null;
  
  return { pillars: { year: yearPillar, month: monthPillar, day: dayPillar, hour: hourPillar }, raw: saju, solarDate: { year: solarY, month: solarM, day: solarD }, monthMode: monthPillar.usedMode };
}

function getTenGod(dsi, tsi) {
  const de = Math.floor(dsi / 2), te = Math.floor(tsi / 2), sy = dsi % 2 === tsi % 2;
  return TEN_GODS[((te - de + 5) % 5) * 2 + (sy ? 0 : 1)];
}

const STAGE_START = {'甲':11,'乙':6,'丙':2,'丁':9,'戊':2,'己':9,'庚':5,'辛':0,'壬':8,'癸':3};
const STAGE_DIR = {'甲':1,'乙':-1,'丙':1,'丁':-1,'戊':1,'己':-1,'庚':1,'辛':-1,'壬':1,'癸':-1};
function getTwelve(ds, bi) {
  return TWELVE[((bi - STAGE_START[ds]) * STAGE_DIR[ds] % 12 + 12) % 12];
}

function get12Sinsal(yBr, tBr) {
  return SINSAL_12[yBr] ? SINSAL_12[yBr][BRANCHES.names.indexOf(tBr)] || '-' : '-';
}

function getGongmang(dsi, dbi) {
  const pair = Math.floor((dsi + dbi) / 10);
  const base = pair * 10 - dbi;
  return [BRANCHES.names[((10 + base) % 12 + 12) % 12], BRANCHES.names[((11 + base) % 12 + 12) % 12]];
}

function calcFiveEl(pillars) {
  const c = { 목:0, 화:0, 토:0, 금:0, 수:0 };
  ['year','month','day','hour'].forEach(k => {
    const pl = pillars[k];
    if (pl) {
      c[STEMS.elements[pl.si]]++;
      c[BRANCHES.elements[pl.bi]]++;
    }
  });
  const t = Object.values(c).reduce((a,b) => a+b, 0);
  const pct = {};
  Object.keys(c).forEach(e => { pct[e] = t > 0 ? Math.round(c[e] / t * 100) : 0; });
  const sorted = Object.entries(c).sort((a,b) => a[1] - b[1]);
  return { counts: c, pct, yongshin: sorted[0][0], gishin: sorted[sorted.length-1][0] };
}

function calcPillarSinsal(stem, br, dayGan, dayBr, pillarType, yearBr) {
  const sins = [];
  const add = (n) => { if (n && !sins.includes(n)) sins.push(n); };
  const chk = (tbl, key, val) => tbl[key] && tbl[key].includes(val);
  
  if (chk(HYOSIN_A, dayGan, br)) add('효신살');
  if (chk(TAEGUK_A, dayGan, br)) add('태극귀인');
  if (chk(HONGYAN_B, stem, br)) add('홍염살');
  if (chk(YEOYEON_B, stem, br)) add('여연살');
  if (chk(HYUNCHIM_B, stem, br)) add('현침살');
  if (chk(NACHEDO_B, stem, br)) add('나체도화');
  if (chk(GUCHU_B, stem, br)) add('구추방해');
  if (chk(AMROK_B, stem, br)) add('암록');
  if (chk(JANGGUN_B, stem, br)) add('장군전');
  if (chk(TOESIN_B, stem, br)) add('퇴신');
  if (chk(YUKSU_B, stem, br)) add('육수');
  if (chk(EUMYOK_B, stem, br)) add('음욕살');
  if (chk(NAKJEONG_B, stem, br)) add('낙정관살');
  if (chk(ILDEOK_B, stem, br)) add('일덕');
  if (chk(CHILSAL_B, stem, br)) add('칠살');
  if (chk(UICHEO_B, stem, br)) add('의처의부살');
  if (chk(JINSIN_B, stem, br)) add('진신');
  if (chk(KYOSIN_B, stem, br)) add('교신성');
  if (GEUMYEOROK[dayGan] === br) add('금여록');
  if (chk(CHEONJU, dayGan, br)) add('천주귀인');
  if (chk(BOKSEONG, dayGan, br)) add('복성귀인');
  if (CHEONGWAN[dayGan] === br) add('천관귀인');
  if (TANGHWA[dayGan] === br) add('탕화살');
  if (CHEONUI[dayGan] === br) add('천의성');
  if (yearBr && GWASUK_MAP[yearBr] === br) add('과숙살');
  if (yearBr && GOSIN_MAP[yearBr] === br) add('고신살');
  
  if (pillarType === 'day') {
    if (chk(BAEKHO_C, dayGan, br)) add('백호살');
    if (chk(JAEGO_C, dayGan, br)) add('재고귀인');
    if (chk(CHEOLSA_C, dayGan, br)) add('철사관');
    if (chk(PYEONGDU_C, dayGan, br)) add('평두살');
    if (chk(GEUMYEO_C, dayGan, br)) add('금여');
    if (GORAN.includes(dayGan + br)) add('고란살');
  }
  
  if (pillarType === 'year' && GEUMSIN_YEAR.includes(br)) add('금신');
  if (GANYEOJIDONG.includes(stem + br)) add('간여지동');
  
  return sins;
}

function calcExtraSinsal(allBr, allStems) {
  const extra = [];
  if (allBr.includes('辰') && allBr.includes('酉')) extra.push('진육합→금');
  if (allBr.filter(b => b === '酉').length >= 2) extra.push('유유자형');
  if (allBr.includes('戌') && allBr.includes('未')) { extra.push('술미육형'); extra.push('술미파'); }
  if (allBr.includes('子') && allBr.includes('未')) { extra.push('자미해'); extra.push('자미원진'); }
  if (allBr.includes('酉') && allBr.includes('戌')) extra.push('유술해');
  if (allBr.includes('酉') && allBr.includes('子')) extra.push('유자파');
  if (allBr.includes('辰') && allBr.includes('戌')) extra.push('천라');
  if (allBr.includes('戌') && allBr.includes('亥')) extra.push('지망');
  if (allStems.includes('甲') && allStems.includes('戊') && allStems.includes('庚')) extra.push('천상삼기');
  if (allStems.includes('乙') && allStems.includes('丙') && allStems.includes('丁')) extra.push('지상삼기');
  if (allStems.includes('辛') && allStems.includes('壬') && allStems.includes('癸')) extra.push('인중삼기');
  
  const GWIMUN = {'子':'未','丑':'午','寅':'巳','卯':'辰','辰':'卯','巳':'寅','午':'丑','未':'子','申':'亥','酉':'戌','戌':'酉','亥':'申'};
  for (let i = 0; i < allBr.length; i++) {
    for (let j = i + 1; j < allBr.length; j++) {
      if (GWIMUN[allBr[i]] === allBr[j]) { extra.push('귀문관살'); break; }
    }
  }
  
  const HAP = {'甲己':'토','乙庚':'금','丙辛':'수','丁壬':'목','戊癸':'화'};
  for (let i = 0; i < allStems.length; i++) {
    for (let j = i + 1; j < allStems.length; j++) {
      const p = allStems[i] + allStems[j], q = allStems[j] + allStems[i];
      if (HAP[p]) extra.push(p + '합→' + HAP[p]);
      else if (HAP[q]) extra.push(q + '합→' + HAP[q]);
    }
  }
  return [...new Set(extra)];
}

function analyzeSaju(year, month, day, hour, minute, isLunar, isLeapMonth) {
  const result = calculateSajuFromLib(year, month, day, hour, minute, isLunar, isLeapMonth);
  const { pillars } = result;
  
  const fe = calcFiveEl(pillars);
  const dayGan = STEMS.names[pillars.day.si];
  const dayBr = BRANCHES.names[pillars.day.bi];
  const yearBr = BRANCHES.names[pillars.year.bi];
  const gm = getGongmang(pillars.day.si, pillars.day.bi);
  
  const sinsal12 = {};
  ['year','month','day','hour'].forEach(k => {
    if (pillars[k]) sinsal12[k] = get12Sinsal(yearBr, BRANCHES.names[pillars[k].bi]);
  });
  
  const allBr = [], allStems = [];
  ['year','month','day','hour'].forEach(k => {
    if (pillars[k]) {
      allBr.push(BRANCHES.names[pillars[k].bi]);
      allStems.push(STEMS.names[pillars[k].si]);
    }
  });
  
  const pillarSinsal = { year:[], month:[], day:[], hour:[] };
  ['year','month','day','hour'].forEach(pk => {
    if (!pillars[pk]) return;
    const stem = STEMS.names[pillars[pk].si];
    const br = BRANCHES.names[pillars[pk].bi];
    pillarSinsal[pk] = calcPillarSinsal(stem, br, dayGan, dayBr, pk, yearBr);
  });
  
  const extraSinsal = calcExtraSinsal(allBr, allStems);
  
  return { pillars, fe, gm, dsi: pillars.day.si, sinsal12, pillarSinsal, extraSinsal, raw: result.raw, solarDate: result.solarDate, monthMode: result.monthMode };
}

// ========== SDK 초기화 ==========
const KAKAO_APP_KEY = 'f68dda02192f5417b547eb2db8368d3d';
const TOSS_CLIENT_KEY = 'test_ck_6BYq7GWPVvnLQM6kRJ77VNE5vbo1';

// 카카오 SDK 초기화 (중복 방지)
if (window.Kakao && !window.Kakao.isInitialized()) {
  window.Kakao.init(KAKAO_APP_KEY);
}

// 토스 결제 성공 리턴 처리 (결제 후 페이지 복귀 시)
const urlParams = new URLSearchParams(window.location.search);
const tossPaymentKey = urlParams.get('paymentKey');
const tossOrderId    = urlParams.get('orderId');
const tossAmount     = urlParams.get('amount');
const tossPayFail    = urlParams.get('payment') === 'fail';
const tossPaySuccess = urlParams.get('payment') === 'success';

if (tossPaymentKey && tossOrderId && tossAmount) {
  // URL 파라미터 정리 (뒤로가기 중복 실행 방지)
  const cleanUrl = window.location.pathname + window.location.hash;
  window.history.replaceState({}, '', cleanUrl);
}

// ========== React 앱 ==========
function App() {
  const [currentScreen, setCurrentScreen] = useState(() => {
    // URL hash로 초기 화면 복원
    const hash = window.location.hash.replace('#', '');
    return hash || 'home';
  });

  // history API 연동 - 브라우저 뒤로가기/앞으로가기 지원
  const setScreen = (screen) => {
    setCurrentScreen(screen);
    if (screen === 'home') {
      history.pushState({ screen }, '', window.location.pathname);
    } else {
      history.pushState({ screen }, '', '#' + screen);
    }
  };

  // 브라우저 뒤로가기/앞으로가기 이벤트 처리
  React.useEffect(() => {
    const handlePopState = (e) => {
      const screen = e.state?.screen || 'home';
      setCurrentScreen(screen);
    };
    // 초기 state 설정
    const initialScreen = window.location.hash.replace('#', '') || 'home';
    history.replaceState({ screen: initialScreen }, '', window.location.hash || window.location.pathname);
    
    window.addEventListener('popstate', handlePopState);
    return () => window.removeEventListener('popstate', handlePopState);
  }, []);
  // ========== 계정별 localStorage 유틸 ==========
  // 키 형식: sajuon::{userKey}::{dataType}
  const storageKey = (userKey, type) => `sajuon::${userKey}::${type}`;
  
  const loadUserData = (userKey, type, fallback) => {
    try {
      const raw = localStorage.getItem(storageKey(userKey, type));
      return raw ? JSON.parse(raw) : fallback;
    } catch { return fallback; }
  };
  
  const saveUserData = (userKey, type, data) => {
    try {
      localStorage.setItem(storageKey(userKey, type), JSON.stringify(data));
    } catch(e) { console.warn('localStorage 저장 실패:', e); }
  };

  // 앱 세션 상태 (localStorage에서 마지막 로그인 계정 복원)
  const getSessionAccount = () => {
    try { return JSON.parse(localStorage.getItem('sajuon::session') || 'null'); } catch { return null; }
  };
  const session = getSessionAccount();

  const [showLogin, setShowLogin] = useState(false);
  const [showPayment, setShowPayment] = useState(false);
  const [paymentProduct, setPaymentProduct] = useState(null);
  const [isLoggedIn, setIsLoggedIn] = useState(!!session);
  const [userEmail, setUserEmail] = useState(session?.email || '');
  const [loginMethod, setLoginMethod] = useState(session?.method || '');
  const [userKey, setUserKey] = useState(session?.key || ''); // localStorage 키용 고유값
  const [form, setForm] = useState({ name:'', gender:'여성', calendar:'양력', year:'', month:'', day:'', hour:'', minute:'' });
  
  // 계정별 데이터 — userKey 기준 로드
  const [savedSaju, setSavedSajuRaw] = useState(() => session ? loadUserData(session.key, 'savedSaju', []) : []);
  const [currentResult, setCurrentResult] = useState(null);
  const [currentInput, setCurrentInput] = useState(null);
  const [purchases, setPurchases] = useState(() => session ? loadUserData(session.key, 'purchases', []) : []);
  
  // 궁합 관련 state
  const [compatPerson1, setCompatPerson1] = useState('');
  const [compatPerson2, setCompatPerson2] = useState('');
  const [compatRelation, setCompatRelation] = useState('');
  const [returnScreen, setReturnScreen] = useState(null);
  const [savedCompatibility, setSavedCompatibilityRaw] = useState(() => session ? loadUserData(session.key, 'savedCompatibility', []) : []);
  const [savedPaidSaju, setSavedPaidSajuRaw] = useState(() => session ? loadUserData(session.key, 'savedPaidSaju', []) : []);
  
  // 신년운세 관련 state
  const [yearlyPerson, setYearlyPerson] = useState('');
  const [savedYearly, setSavedYearlyRaw] = useState(() => session ? loadUserData(session.key, 'savedYearly', []) : []);
  
  // 아코디언 열림 상태
  const [openAccordions, setOpenAccordions] = useState({});
  
  // 사이드 메뉴 상태
  const [showSideMenu, setShowSideMenu] = useState(false);

  // ===== 토스 결제 복원 (결제 완료 후 페이지 리다이렉트 처리) =====
  React.useEffect(() => {
    const isPaymentSuccess = urlParams.get('payment') === 'success';
    if ((tossPaymentKey || isPaymentSuccess) && (tossOrderId || isPaymentSuccess)) {
      // localStorage에서 pending 결제 정보 복원
      try {
        const pending = JSON.parse(sessionStorage.getItem('sajuon_pending_payment') || 'null');
        sessionStorage.removeItem('sajuon_pending_payment');
        if (pending) {
          // paymentProduct 복원 후 handlePaymentComplete 실행
          setPaymentProduct(pending.product);
          setTimeout(() => {
            // 결제 금액 검증 (기본 검증)
            if (parseInt(tossAmount) === pending.product.price) {
              // 결제 완료 처리
              const newPurchase = {
                id: Date.now(),
                name: pending.product.name,
                price: pending.product.price,
                date: new Date().toLocaleDateString('ko-KR'),
                paymentKey: tossPaymentKey,
                orderId: tossOrderId
              };
              setPurchases(prev => {
                const updated = [...prev, newPurchase];
                if (userKey) saveUserData(userKey, 'purchases', updated);
                return updated;
              });
              // 구매 콘텐츠 저장 및 화면 이동
              if (pending.product.name === '상세 사주 분석' && pending.currentInput && pending.currentResult) {
                setCurrentInput(pending.currentInput);
                setCurrentResult(pending.currentResult);
                setSavedPaidSaju(prev => {
                  const already = prev.some(s => s.name === pending.currentInput.name && s.year === pending.currentInput.year && s.month === pending.currentInput.month && s.day === pending.currentInput.day);
                  if (already) return prev;
                  return [...prev, { id: Date.now(), ...pending.currentInput, result: pending.currentResult, date: new Date().toLocaleDateString('ko-KR') }];
                });
                setScreen('paid-result');
              } else if (pending.product.name === '궁합 분석') {
                if (pending.compatResult) setSavedCompatibility(prev => [...prev, pending.compatResult]);
                setScreen('compatibility-result');
              } else if (pending.product.name === '2026 신년운세') {
                if (pending.yearlyResult) setSavedYearly(prev => [...prev, pending.yearlyResult]);
                setScreen('yearly-result');
              }
            } else {
              alert('결제 금액 불일치. 고객센터에 문의해주세요.');
            }
          }, 100);
        }
      } catch(e) { console.error('결제 복원 실패:', e); }
    }
    if (tossPayFail) {
      const cleanUrl = window.location.pathname + window.location.hash;
      window.history.replaceState({}, '', cleanUrl);
      alert('결제가 취소되었습니다.');
    }
  }, []);

  // ===== 계정별 자동 저장 래퍼 =====
  const setSavedSaju = (updater) => {
    setSavedSajuRaw(prev => {
      const next = typeof updater === 'function' ? updater(prev) : updater;
      if (userKey) saveUserData(userKey, 'savedSaju', next);
      return next;
    });
  };
  const setSavedPaidSaju = (updater) => {
    setSavedPaidSajuRaw(prev => {
      const next = typeof updater === 'function' ? updater(prev) : updater;
      if (userKey) saveUserData(userKey, 'savedPaidSaju', next);
      return next;
    });
  };
  const setSavedCompatibility = (updater) => {
    setSavedCompatibilityRaw(prev => {
      const next = typeof updater === 'function' ? updater(prev) : updater;
      if (userKey) saveUserData(userKey, 'savedCompatibility', next);
      return next;
    });
  };
  const setSavedYearly = (updater) => {
    setSavedYearlyRaw(prev => {
      const next = typeof updater === 'function' ? updater(prev) : updater;
      if (userKey) saveUserData(userKey, 'savedYearly', next);
      return next;
    });
  };
  
  // 포인트 시스템 (별: 유료충전, 달: 무료적립)
  const [stars, setStars] = useState(0); // ⭐ 별 (1별 = 100원)
  const [moons, setMoons] = useState(0); // 🌙 달 (무료 보너스)
  const [showChargeModal, setShowChargeModal] = useState(false);
  
  // 아코디언 아이템 컴포넌트
  const AccordionItem = ({ icon, color, title, content }) => {
    const [isOpen, setIsOpen] = useState(false);
    return React.createElement('div', { className: 'border-b border-white/10 last:border-b-0' },
      React.createElement('button', { 
        onClick: () => setIsOpen(!isOpen),
        className: 'w-full flex items-center gap-3 p-4 text-left hover:bg-white/5 transition-all duration-200 active:scale-[0.98]'
      },
        React.createElement('span', { className: `text-xl ${color}` }, icon),
        React.createElement('span', { className: 'flex-1 font-medium text-sm text-gray-200' }, title),
        React.createElement('span', { className: `text-gray-400 transition-transform duration-300 ${isOpen ? 'rotate-180' : ''}` }, '▼')
      ),
      isOpen && React.createElement('div', { className: 'px-4 pb-4 pt-0' },
        React.createElement('div', { className: 'bg-white/5 rounded-xl p-4' },
          typeof content === 'string' 
            ? content.split('\n\n').map((para, i) => 
                React.createElement('p', { key: i, className: 'text-sm text-gray-300 leading-relaxed mb-3 last:mb-0' }, para)
              )
            : React.createElement('p', { className: 'text-sm text-gray-300 leading-relaxed' }, content)
        )
      )
    );
  };

  // ========== 사주 해설 생성 시스템 ==========
  const generateSajuInterpretation = (result, input) => {
    const dayGan = STEMS.names[result.dsi];
    const dayGanKr = STEMS.korean[result.dsi];
    const dayEl = STEMS.elements[result.dsi];
    const allSinsal = [...(result.pillarSinsal?.year || []), ...(result.pillarSinsal?.month || []), ...(result.pillarSinsal?.day || []), ...(result.pillarSinsal?.hour || [])].filter((v, i, a) => a.indexOf(v) === i);
    const fe = result.fe;
    
    // 오행별 강약 판단
    const strongEl = Object.entries(fe.pct).sort((a, b) => b[1] - a[1])[0];
    const weakEl = Object.entries(fe.pct).sort((a, b) => a[1] - b[1])[0];
    const hasGwan = (fe.pct['금'] || 0) > 25 && dayEl === '목';
    const hasInsung = (fe.pct['수'] || 0) > 20;
    const hasBigup = (fe.pct[dayEl] || 0) > 30;
    
    // 일간별 특성
    const dayGanTraits = {
      '갑': { nature: '우뚝 솟은 큰 나무', traits: '곧고 강직하며 리더십이 있는', weakness: '융통성이 부족하고 고집이 셀 수 있는' },
      '을': { nature: '덩굴이나 화초', traits: '유연하고 적응력이 뛰어나며 섬세한', weakness: '우유부단하고 의존적일 수 있는' },
      '병': { nature: '태양처럼 빛나는 불', traits: '열정적이고 활기차며 주목받는', weakness: '성급하고 지속력이 부족할 수 있는' },
      '정': { nature: '촛불이나 난로', traits: '따뜻하고 섬세하며 헌신적인', weakness: '감정적이고 예민할 수 있는' },
      '무': { nature: '거대한 산이나 대지', traits: '든든하고 포용력 있으며 신뢰감 있는', weakness: '고지식하고 변화를 두려워할 수 있는' },
      '기': { nature: '옥토나 정원', traits: '다정하고 실용적이며 양육적인', weakness: '걱정이 많고 소심할 수 있는' },
      '경': { nature: '강철이나 보석', traits: '결단력 있고 의리 있으며 원칙적인', weakness: '냉정하고 독선적일 수 있는' },
      '신': { nature: '귀금속이나 보석', traits: '섬세하고 완벽주의적이며 예리한', weakness: '비판적이고 예민할 수 있는' },
      '임': { nature: '큰 강이나 바다', traits: '지혜롭고 포용력 있으며 통찰력 있는', weakness: '감정 기복이 있고 변덕스러울 수 있는' },
      '계': { nature: '이슬이나 샘물', traits: '영리하고 감수성 풍부하며 창의적인', weakness: '우울하거나 소극적일 수 있는' }
    };
    
    const trait = dayGanTraits[dayGanKr] || dayGanTraits['갑'];
    
    // 12개 섹션 생성
    const sections = [
      {
        icon: '✨',
        color: 'text-pink-500',
        title: generateSectionTitle(0, dayGanKr, strongEl[0], allSinsal),
        content: `${input.name}님의 일간은 ${dayGan}(${dayGanKr})으로, ${trait.nature}와 같은 기운을 타고났습니다. ${trait.traits} 성향이 기본 바탕에 깔려 있으며, 이는 평생 변하지 않는 본질적인 기질입니다.

사주팔자를 살펴보면 ${strongEl[0]}(${getElHanja(strongEl[0])}) 기운이 ${strongEl[1]}%로 가장 강하고, ${weakEl[0]}(${getElHanja(weakEl[0])}) 기운이 ${weakEl[1]}%로 가장 약한 구조입니다. ${hasGwan ? '특히 금(金) 기운이 강해 관살의 압박이 있어, 책임감과 외부의 시선에 늘 긴장하며 살아가는 경향이 있습니다.' : hasBigup ? '자신과 같은 오행이 강해 주관이 뚜렷하고 독립적인 성향이 강합니다.' : '오행이 비교적 균형을 이루어 다양한 상황에 적응하는 능력이 있습니다.'}

${allSinsal.includes('백호살') ? '백호살이 있어 순간적인 판단력과 추진력이 뛰어나지만, 급한 성격으로 인한 충돌에 주의해야 합니다.' : ''} ${allSinsal.includes('현침살') ? '현침살의 영향으로 분석력과 비판적 사고가 발달했으나, 말이 날카로워 상대방에게 상처를 줄 수 있으니 표현에 신경 써야 합니다.' : ''} ${allSinsal.includes('도화살') || allSinsal.includes('홍염살') ? '도화의 기운이 있어 이성에게 매력적으로 보이며 예술적 감각도 뛰어납니다.' : ''}

이 사주의 핵심은 ${trait.weakness} 점을 인식하고, 이를 보완하는 방향으로 삶을 설계하는 것입니다. ${input.name}님은 이미 충분한 잠재력을 갖고 있으며, 자신의 장점을 살리되 약점을 겸허히 인정할 때 더 큰 성장을 이룰 수 있습니다.`
      },
      {
        icon: '🔮',
        color: 'text-purple-500',
        title: generateSectionTitle(1, dayGanKr, strongEl[0], allSinsal),
        content: `오행의 분포를 자세히 살펴보면, ${input.name}님의 내면 세계와 외부 환경의 조화를 읽을 수 있습니다. 현재 사주에서 ${strongEl[0]} 기운이 ${strongEl[1]}%를 차지하며 가장 큰 비중을 보이고 있습니다.

${strongEl[0] === '목' ? '목(木)이 강하다는 것은 성장과 발전에 대한 욕구가 크며, 새로운 시작을 두려워하지 않는 개척자적 기질이 있음을 의미합니다. 다만 과도하면 다른 사람의 영역을 침범하거나 자기 주장이 너무 강해질 수 있습니다.' : ''}${strongEl[0] === '화' ? '화(火)가 강하다는 것은 열정과 표현력이 뛰어나며, 사람들에게 영감을 주는 능력이 있음을 의미합니다. 다만 에너지 소모가 크고 지속력에 한계가 있을 수 있습니다.' : ''}${strongEl[0] === '토' ? '토(土)가 강하다는 것은 안정감과 신뢰감을 주며, 중재자나 조정자 역할에 뛰어남을 의미합니다. 다만 변화에 둔감하거나 지나친 고집으로 이어질 수 있습니다.' : ''}${strongEl[0] === '금' ? '금(金)이 강하다는 것은 결단력과 원칙, 의리를 중시하며 약속을 지키는 신뢰할 수 있는 사람임을 의미합니다. 다만 경직되거나 타인에게 냉정하게 비춰질 수 있습니다.' : ''}${strongEl[0] === '수' ? '수(水)가 강하다는 것은 지혜와 통찰력이 깊으며, 배움에 대한 열정이 있음을 의미합니다. 다만 감정의 기복이 있거나 결단력이 부족할 수 있습니다.' : ''}

반면 ${weakEl[0]}(${getElHanja(weakEl[0])}) 기운이 ${weakEl[1]}%로 부족한 상태입니다. ${weakEl[0] === '화' ? '화(火)가 부족하면 자기 표현이 서툴고 내면의 에너지를 밖으로 발산하는 데 어려움을 겪을 수 있습니다. 의식적으로 운동이나 예술 활동을 통해 표현력을 기르는 것이 좋습니다.' : ''}${weakEl[0] === '수' ? '수(水)가 부족하면 유연성이 떨어지고 스트레스 관리에 어려움을 겪을 수 있습니다. 충분한 휴식과 명상, 물 가까운 곳에서의 휴양이 도움이 됩니다.' : ''}${weakEl[0] === '목' ? '목(木)이 부족하면 새로운 시작에 대한 두려움이나 성장 정체를 경험할 수 있습니다. 푸른 자연 속에서의 활동이나 새로운 학습이 도움이 됩니다.' : ''}${weakEl[0] === '토' ? '토(土)가 부족하면 중심을 잡기 어렵고 불안정한 느낌을 받을 수 있습니다. 규칙적인 생활과 안정적인 환경 조성이 중요합니다.' : ''}${weakEl[0] === '금' ? '금(金)이 부족하면 결단력이 약하고 우유부단해질 수 있습니다. 명확한 목표 설정과 단호한 결정 연습이 필요합니다.' : ''}

오행의 조화를 맞추기 위해서는 ${fe.yongshin}(${getElHanja(fe.yongshin)}) 기운을 용신으로 삼아 이를 보충하는 것이 중요합니다. 색상, 방향, 음식, 직업 등에서 이 기운을 의식적으로 취하면 삶의 균형이 좋아집니다.`
      },
      {
        icon: '📜',
        color: 'text-amber-500',
        title: generateSectionTitle(2, dayGanKr, strongEl[0], allSinsal),
        content: `일주는 사주의 핵심으로, ${input.name}님의 가장 본질적인 자아를 나타냅니다. ${dayGan}(${dayGanKr}) 일간에 ${result.pillars.day?.branch || ''}(${BRANCHES.korean[result.pillars.day?.bi] || ''})가 앉아 있는 구조입니다.

${result.pillars.day ? `일지 ${result.pillars.day.branch}(${BRANCHES.korean[result.pillars.day.bi]})는 배우자궁이자 내면의 세계를 의미합니다. ${BRANCHES.elements[result.pillars.day.bi]}(${getElHanja(BRANCHES.elements[result.pillars.day.bi])}) 기운이 일간과 어떤 관계를 맺느냐에 따라 내면의 안정감과 배우자운이 달라집니다.` : ''}

${allSinsal.includes('백호살') ? '일주에 백호살이 있어 강인한 추진력과 결단력을 갖고 있습니다. 하지만 이 살은 양날의 검과 같아서, 잘 쓰면 위기 상황에서 빛을 발하지만 조절하지 못하면 급한 성격으로 인한 실수가 생길 수 있습니다. 특히 수술이나 사고에 주의가 필요하며, 이 기운을 의료, 군경, 법조 등 "칼"을 다루는 직업으로 승화시키면 오히려 길하게 작용합니다.' : ''}

${allSinsal.includes('금여') ? '금여(金輿)가 있어 귀인의 도움이 있고, 물질적 풍요와 사회적 대우를 받을 수 있는 복이 있습니다. 특히 결혼 후 운이 좋아지는 경향이 있으며, 배우자 복이 있는 편입니다.' : ''}

${allSinsal.includes('학당귀인') ? '학당귀인이 있어 학문적 성취가 뛰어나고, 공부를 통해 입신양명할 수 있는 기운이 있습니다. 평생 배움을 놓지 않으면 그것이 곧 재물과 명예로 이어집니다.' : ''}

${allSinsal.includes('재고귀인') ? '재고귀인이 있어 재물을 모으고 지키는 능력이 있습니다. 큰돈이 들어올 기회가 있으며, 저축과 투자에 재능이 있습니다. 다만 이 복을 지키려면 검소함을 잃지 않아야 합니다.' : ''}

일주의 기운을 제대로 활용하려면, 자신의 본성을 있는 그대로 인정하고 그에 맞는 삶의 방식을 선택하는 것이 중요합니다. 억지로 자신을 바꾸려 하기보다, 타고난 기질을 최대한 살리는 방향으로 나아가세요.`
      },
      {
        icon: '⚔️',
        color: 'text-red-500',
        title: generateSectionTitle(3, dayGanKr, strongEl[0], allSinsal),
        content: `모든 사주에는 내면의 갈등 구조가 존재합니다. ${input.name}님의 경우, ${hasGwan ? '관살(官殺)의 압박이 강해 항상 외부의 시선과 책임감에 시달리는 구조입니다. 남들에게 인정받고 싶은 욕구가 크고, "잘해야 한다"는 강박이 있습니다.' : hasBigup ? '비겁(比劫)이 강해 주관이 뚜렷하고 독립적이지만, 타인과의 협력이나 양보가 어려운 구조입니다.' : hasInsung ? '인성(印星)이 강해 배움과 보호에 대한 욕구가 크지만, 이것이 과하면 의존적이거나 소극적인 태도로 나타날 수 있습니다.' : '오행이 비교적 균형을 이루고 있지만, 그로 인해 명확한 방향성을 잡기 어려울 때가 있습니다.'}

${allSinsal.includes('유유자형') || allSinsal.includes('자형') ? '자형(自刑)이 있어 스스로를 괴롭히는 경향이 있습니다. 꼬리에 꼬리를 무는 부정적인 생각, 완벽주의에서 오는 자기 비하, 남과 비교하며 느끼는 열등감 등이 마음을 힘들게 할 수 있습니다. 이 살은 인식하는 것만으로도 절반은 해소됩니다. "나는 충분하다"는 자기 긍정이 필요합니다.' : ''}

${allSinsal.includes('원진') || allSinsal.includes('구추방해') ? '원진이나 방해의 기운이 있어 인간관계에서 갈등이 생기기 쉽습니다. 특히 가까운 사이에서 미움과 원망이 생길 수 있으니, 거리를 두고 객관적으로 바라보는 연습이 필요합니다.' : ''}

이러한 갈등 구조를 해소하는 방법은 첫째, 자기 인식입니다. 내가 어떤 패턴으로 스트레스를 받는지 파악하세요. 둘째, 회피하지 말고 직면하세요. 문제를 피하면 더 커집니다. 셋째, 전문가의 도움을 받으세요. 명리 상담이든 심리 상담이든, 객관적인 시선이 필요합니다.

${input.name}님의 갈등 구조는 극복하면 오히려 큰 강점이 됩니다. 압력을 견딘 탄소가 다이아몬드가 되듯, 이 시련을 통해 단련된 정신력은 누구도 쉽게 얻을 수 없는 자산입니다.`
      },
      {
        icon: '💖',
        color: 'text-pink-500',
        title: generateSectionTitle(4, dayGanKr, strongEl[0], allSinsal),
        content: `지금까지 얼마나 힘들었나요? ${hasGwan ? '사방에서 날아오는 기대와 책임감을 홀로 감당하면서도, 겉으로는 "괜찮다"며 버텨온 시간들이 느껴집니다.' : ''} ${input.name}님의 사주를 보면, ${trait.traits} 본성을 가지고 있으면서도 ${trait.weakness} 면이 있어 내면에서 끊임없이 충돌이 일어났을 것입니다.

그러나 이 모든 것을 견뎌낸 것 자체가 대단한 일입니다. ${allSinsal.includes('학당귀인') ? '학당귀인이 있어 어려움 속에서도 배움을 통해 성장해왔습니다.' : ''} ${allSinsal.includes('천을귀인') || allSinsal.includes('태극귀인') ? '귀인의 기운이 있어 위기 때마다 도움의 손길이 있었을 것입니다. 이는 평소 ${input.name}님이 쌓아온 덕(德)의 결과입니다.' : ''}

${input.name}님은 존재 자체만으로도 의미가 있습니다. 굳이 증명하려 애쓰지 않아도, 주변 사람들은 이미 당신의 가치를 알고 있습니다. ${hasInsung ? '특히 지혜와 통찰력이 뛰어나 많은 사람들이 조언을 구하고 의지합니다.' : ''}

이제는 스스로를 좀 더 안아주세요. "고생했다, 정말 잘했다"고 토닥여주세요. 완벽하지 않아도 괜찮고, 가끔 무너져도 괜찮습니다. 당신은 충분히 사랑받을 자격이 있는 사람입니다. 앞으로의 여정에서 조금 더 자신에게 관대해지기를 바랍니다.`
      },
      {
        icon: '😊',
        color: 'text-yellow-500',
        title: generateSectionTitle(5, dayGanKr, strongEl[0], allSinsal),
        content: `${input.name}님의 기본 성격은 ${trait.traits} 면이 강합니다. ${dayGan}(${dayGanKr}) 일간의 특성상 ${trait.nature}처럼 ${dayEl === '목' ? '위로 성장하려는 욕구가 강하고 정의감이 있습니다' : dayEl === '화' ? '밝고 열정적이며 주목받는 것을 좋아합니다' : dayEl === '토' ? '안정적이고 신뢰감 있으며 중심을 잡는 역할을 합니다' : dayEl === '금' ? '결단력 있고 원칙적이며 한번 맺은 인연을 소중히 합니다' : '지혜롭고 유연하며 적응력이 뛰어납니다'}.

${strongEl[0] === dayEl ? '자신의 오행이 강해 주관이 뚜렷하고 독립적입니다. 다만 고집이 세다는 소리를 들을 수 있으니, 가끔은 다른 의견도 수용하는 연습이 필요합니다.' : `${strongEl[0]}(${getElHanja(strongEl[0])}) 기운이 강해 ${strongEl[0] === '금' ? '냉철하고 분석적인 면이 있습니다' : strongEl[0] === '수' ? '지적이고 사색적인 면이 있습니다' : strongEl[0] === '목' ? '진취적이고 도전적인 면이 있습니다' : strongEl[0] === '화' ? '활동적이고 표현력이 풍부합니다' : '안정적이고 현실적인 판단력이 있습니다'}.`}

${allSinsal.includes('현침살') ? '현침살의 영향으로 말재주가 있고 분석력이 뛰어나지만, 그 날카로움이 상대방에게 상처를 줄 수 있습니다. 진심을 담아 부드럽게 표현하는 연습이 필요합니다.' : ''} ${allSinsal.includes('도화살') || allSinsal.includes('홍염살') ? '도화의 기운이 있어 이성에게 매력적으로 비춰지며, 예술적 감각과 미적 안목도 뛰어납니다.' : ''}

성격을 개선하고 싶다면, 첫째 자기 객관화가 필요합니다. 나의 장단점을 정확히 파악하세요. 둘째, 단점을 직접 고치기보다 장점을 극대화하는 방향으로 에너지를 쓰세요. 셋째, ${weakEl[0]} 기운이 부족하니 이를 보완하는 활동(${weakEl[0] === '화' ? '운동, 예술 활동' : weakEl[0] === '수' ? '명상, 독서' : weakEl[0] === '목' ? '등산, 새로운 학습' : weakEl[0] === '토' ? '규칙적인 생활' : '목표 설정, 결단 연습'})을 의식적으로 하세요.`
      },
      {
        icon: '💼',
        color: 'text-blue-500',
        title: generateSectionTitle(6, dayGanKr, strongEl[0], allSinsal),
        content: `직업 적성을 보면, ${input.name}님은 ${hasGwan ? '체계와 규율이 있는 조직에서 빛을 발합니다. 프리랜서나 1인 사업보다는 대기업, 공공기관, 전문직에서 안정적으로 능력을 발휘할 수 있습니다.' : hasBigup ? '독립적으로 일할 수 있는 환경이 적합합니다. 자영업, 프리랜서, 전문직 등 자기 재량이 큰 분야에서 성과를 낼 수 있습니다.' : '다양한 분야에 적응할 수 있는 유연성이 있습니다.'}

${allSinsal.includes('백호살') || allSinsal.includes('현침살') ? '날카로운 기운이 있어 실제로 칼이나 뾰족한 도구를 다루는 직업과 인연이 있습니다. 의사, 외과의, 치과의사, 한의사, 요리사, 미용사, 타투이스트 등이 여기에 해당합니다. 혹은 "펜"이라는 칼을 쓰는 법조계, 언론, 작가, 비평가 등도 잘 맞습니다.' : ''}

${allSinsal.includes('학당귀인') || allSinsal.includes('문창귀인') ? '학문과 연구 분야에 재능이 있습니다. 교육자, 연구원, 학자, 컨설턴트 등 지식을 다루는 직업에서 성공할 수 있습니다.' : ''}

${allSinsal.includes('역마살') || allSinsal.includes('망신살') ? '이동과 변화가 있는 직업이 맞습니다. 무역, 여행, 물류, 외교, 해외 영업 등 움직이는 업무에서 활력을 얻습니다.' : ''}

${strongEl[0] === '금' ? '금(金)이 강해 금융, 회계, 법률, 경찰, 군인, 엔지니어링 등 규율과 정밀함이 필요한 분야에 적합합니다.' : ''} ${strongEl[0] === '수' ? '수(水)가 강해 교육, 철학, 심리, 연구, 기획 등 지적 영역에서 두각을 나타낼 수 있습니다.' : ''} ${strongEl[0] === '목' ? '목(木)이 강해 건축, 인테리어, 패션, 교육, 출판 등 성장과 창조와 관련된 분야에 적합합니다.' : ''} ${strongEl[0] === '화' ? '화(火)가 강해 방송, 연예, 마케팅, 영업, 이벤트 등 표현력과 열정이 필요한 분야에서 빛납니다.' : ''} ${strongEl[0] === '토' ? '토(土)가 강해 부동산, 농업, 식품, 건설, 중개 등 안정적이고 실물과 관련된 분야에 적합합니다.' : ''}

직업 선택에서 가장 중요한 것은 "남들이 기피하는 일을 해결해주는 역할"을 맡을 때 가장 인정받는다는 점입니다. 어렵고 전문적인 영역에서 대체 불가능한 존재가 되세요.`
      },
      {
        icon: '💰',
        color: 'text-emerald-500',
        title: generateSectionTitle(7, dayGanKr, strongEl[0], allSinsal),
        content: `재물운을 보면, ${input.name}님은 ${allSinsal.includes('재고귀인') ? '재고귀인이 있어 돈을 모으고 지키는 능력이 뛰어납니다. 큰 재물이 들어올 기회가 있으며, 특히 저축과 투자에 재능이 있습니다.' : hasGwan ? '관성(官星)이 강해 월급이나 계약에 의한 안정적인 수입이 맞습니다. 투기나 도박성 투자는 절대 피하세요.' : '꾸준한 노력으로 재물을 축적하는 타입입니다.'}

${fe.pct['토'] > 20 ? '토(土)가 재성으로 작용하는 경우가 많아, 부동산이나 실물 자산에서 재물운이 있습니다. 땅, 건물, 금과 같은 실체가 있는 자산이 유리합니다.' : ''} ${fe.pct['금'] > 25 ? '금(金) 기운이 강해 금융 상품이나 귀금속과 인연이 있습니다. 다만 주식보다는 채권이나 예금 같은 안전 자산이 맞습니다.' : ''}

돈을 버는 것보다 지키는 것이 중요한 사주입니다. ${allSinsal.includes('겁재') || hasBigup ? '특히 형제, 친구, 동료와의 금전 거래는 피하세요. 돈을 빌려주거나 동업을 하면 손해를 볼 확률이 높습니다.' : ''} 또한 스트레스 받을 때 홧김에 지출하는 습관이 있다면 이를 경계해야 합니다.

재물을 늘리는 방법: 첫째, 자격증이나 전문 기술로 "명함값"을 높이세요. 둘째, 규칙적인 저축과 연금 가입을 통해 안전판을 만드세요. 셋째, 큰돈이 생기면 유흥보다 자기 계발에 투자하세요. 당신의 머릿속 지식이 가장 확실한 자산입니다.`
      },
      {
        icon: '💕',
        color: 'text-pink-500',
        title: generateSectionTitle(8, dayGanKr, strongEl[0], allSinsal),
        content: `연애와 결혼에 대해 살펴보면, ${input.gender === '남성' ? `${input.name}님에게 여성은 ${hasGwan ? '"애증"의 존재일 수 있습니다. 여성이 나를 통제하려 하거나, 내가 여성에게 너무 엄격한 기준을 들이대는 경향이 있습니다.' : '따뜻하고 지지해주는 존재로, 좋은 배우자를 만나면 함께 성장할 수 있습니다.'}` : `${input.name}님에게 남성은 ${hasGwan ? '책임감과 부담감을 주는 존재로 느껴질 수 있습니다. 나를 리드해주길 바라면서도 막상 통제받는 것은 싫어하는 복잡한 심리가 있습니다.' : '든든한 버팀목이자 함께 성장하는 파트너가 될 수 있습니다.'}`}

${allSinsal.includes('도화살') || allSinsal.includes('홍염살') || allSinsal.includes('나체도화') ? '도화의 기운이 있어 이성에게 인기가 많고 매력적으로 비춰집니다. 연애 기회는 많지만, 그만큼 유혹이나 복잡한 관계에 빠지지 않도록 주의가 필요합니다.' : ''}

${allSinsal.includes('금여') ? '금여(金輿)가 있어 결혼 후 운이 좋아지는 경향이 있습니다. 배우자 복이 있으며, 결혼을 통해 사회적 지위나 경제적 안정이 높아질 수 있습니다.' : ''}

${input.name}님에게 이상적인 배우자는 ${weakEl[0]}(${getElHanja(weakEl[0])}) 기운이 강한 사람입니다. ${weakEl[0] === '화' ? '밝고 활발하며 표현력이 좋은 사람' : weakEl[0] === '수' ? '지적이고 차분하며 이해심 넓은 사람' : weakEl[0] === '목' ? '긍정적이고 성장 지향적인 사람' : weakEl[0] === '토' ? '안정적이고 현실적이며 포용력 있는 사람' : '결단력 있고 원칙이 뚜렷한 사람'}과 만나면 서로의 부족함을 채워줄 수 있습니다.

연애 팁: 첫째, ${allSinsal.includes('현침살') ? '말을 부드럽게 하세요. 논리로 따지지 말고 감정으로 공감하세요.' : '솔직하게 감정을 표현하세요.'} 둘째, 상대방을 바꾸려 하지 말고 있는 그대로 받아들이세요. 셋째, 가끔은 져주는 것이 이기는 것입니다.`
      },
      {
        icon: '🏠',
        color: 'text-orange-500',
        title: generateSectionTitle(9, dayGanKr, strongEl[0], allSinsal),
        content: `가족 관계를 살펴보면, ${hasGwan ? '아버지의 영향력이 크거나, 혹은 아버지와의 관계가 복잡할 수 있습니다. 아버지가 매우 엄격하셨거나, 일찍부터 아버지의 짐을 대신 져야 했을 수도 있습니다.' : '부모님과의 관계는 비교적 원만한 편입니다.'}

${hasInsung ? '어머니의 사랑이 각별합니다. 힘들 때 실질적인 도움을 주는 쪽은 어머니나 외가 쪽일 확률이 높습니다.' : ''} ${allSinsal.includes('효신살') ? '효신살이 있어 어머니와 애증의 관계이거나, 어머니의 과도한 관심이 간섭으로 느껴질 수 있습니다. 적당한 거리를 두는 것이 서로에게 좋습니다.' : ''}

${hasBigup ? '형제와의 관계에서는 경쟁심이 있을 수 있습니다. 어릴 때는 갈등이 있더라도 나이 들면서 서로를 이해하게 됩니다. 다만 형제와의 금전 거래나 동업은 피하는 것이 좋습니다.' : '형제와는 원만한 관계를 유지할 수 있습니다.'}

자녀운을 보면, ${hasGwan ? '자녀가 생기면 책임감이 배가 됩니다. 자녀는 똑똑하고 총명하겠지만, 본인이 자녀에게 너무 엄격한 부모가 되지 않도록 주의하세요.' : '자녀와는 친구 같은 관계를 유지할 수 있습니다.'} 양육 시 가장 중요한 것은 "나와 다름"을 인정하는 것입니다. 자녀는 별개의 인격체임을 존중하세요.

가족 관계 개선 팁: 첫째, 기대를 낮추세요. 가족이니까 당연히 이해해줄 것이라는 생각을 버리세요. 둘째, 감사를 표현하세요. 당연하게 여기지 말고 작은 것에도 고마움을 전하세요. 셋째, 적당한 거리를 유지하세요. 너무 가까우면 오히려 상처를 주고받습니다.`
      },
      {
        icon: '👥',
        color: 'text-cyan-500',
        title: generateSectionTitle(10, dayGanKr, strongEl[0], allSinsal),
        content: `사회적 관계와 인맥을 보면, ${input.name}님은 ${allSinsal.includes('도화살') || allSinsal.includes('홍염살') ? '겉으로는 사람들이 많이 모이고 인기가 있어 보이지만, 정작 실속 있는 관계는 드물 수 있습니다.' : hasBigup ? '독립적인 성향이 강해 넓은 인맥보다는 소수의 깊은 관계를 선호합니다.' : '다양한 사람들과 원만한 관계를 맺을 수 있습니다.'}

${hasGwan ? '관성이 강해 조직 내에서는 인정받지만, 진정한 친구를 사귀기는 어려울 수 있습니다. 업무 관계와 개인적 관계를 구분하며, 공과 사를 철저히 나누는 경향이 있습니다.' : ''}

${allSinsal.includes('원진') || allSinsal.includes('구추방해') ? '원진의 기운이 있어 인간관계에서 갈등이 생기기 쉽습니다. 특히 가까운 사이에서 미움과 원망이 생길 수 있으니 주의하세요.' : ''}

멀리해야 할 사람: ${allSinsal.includes('겁재') ? '당신의 자존심을 긁거나 경쟁 심리를 유발하는 사람, 감정 쓰레기통 취급하는 사람은 피하세요.' : '에너지를 빼앗아 가는 사람, 일방적으로 받기만 하는 사람과는 거리를 두세요.'} 

가까이해야 할 사람: ${weakEl[0]}(${getElHanja(weakEl[0])}) 기운이 강한 사람을 가까이 하세요. ${weakEl[0] === '수' ? '차분하고 지혜로운' : weakEl[0] === '화' ? '밝고 긍정적인' : weakEl[0] === '목' ? '성장 지향적이고 진취적인' : weakEl[0] === '토' ? '안정적이고 신뢰감 있는' : '원칙적이고 결단력 있는'} 사람이 당신에게 좋은 영향을 줍니다.

인간관계 원칙: 깊고 좁은 관계가 당신에게 맞습니다. 모두에게 사랑받으려 하지 말고, 진정으로 당신을 이해하고 지지해주는 소수와 깊은 유대를 쌓으세요.`
      },
      {
        icon: '💪',
        color: 'text-green-500',
        title: generateSectionTitle(11, dayGanKr, strongEl[0], allSinsal),
        content: `${input.name}님을 위한 개운 조언을 정리합니다.

[용신 활용] 당신의 용신은 ${fe.yongshin}(${getElHanja(fe.yongshin)})입니다. ${fe.yongshin === '화' ? '붉은색, 보라색 계열 착용, 남쪽 방향, 밝은 조명, 열정적인 활동' : fe.yongshin === '수' ? '검은색, 파란색 계열 착용, 북쪽 방향, 물 가까운 곳, 명상과 휴식' : fe.yongshin === '목' ? '초록색, 청색 계열 착용, 동쪽 방향, 숲이나 공원, 새로운 학습' : fe.yongshin === '토' ? '노란색, 갈색 계열 착용, 중앙이나 고향, 규칙적인 생활' : '흰색, 금색 계열 착용, 서쪽 방향, 단호한 결정 연습'}이 도움이 됩니다.

[건강 관리] ${dayEl === '목' ? '간과 담, 신경계통에 주의하세요. 스트레칭과 명상이 좋습니다.' : dayEl === '화' ? '심장과 혈액순환에 주의하세요. 과로를 피하고 충분한 수면을 취하세요.' : dayEl === '토' ? '위장과 소화기에 주의하세요. 규칙적인 식사와 운동이 중요합니다.' : dayEl === '금' ? '폐와 호흡기에 주의하세요. 맑은 공기와 심호흡이 도움됩니다.' : '신장과 방광에 주의하세요. 충분한 수분 섭취와 보온이 중요합니다.'}

[마음가짐] ${hasGwan ? '"완벽하지 않아도 괜찮다"는 말을 거울을 보고 매일 하세요. 남의 시선보다 자기 만족이 중요합니다.' : hasBigup ? '혼자 다 하려 하지 말고, 도움을 요청하는 연습을 하세요.' : '자신감을 가지세요. 당신은 생각보다 능력이 있습니다.'}

[행운의 시기] ${fe.yongshin}(${getElHanja(fe.yongshin)}) 기운이 오는 해, 달, 시간에 중요한 결정을 하면 좋습니다. ${fe.yongshin === '화' ? '여름, 오전 9-11시, 오후 1-3시' : fe.yongshin === '수' ? '겨울, 오후 9-11시, 오전 1-3시' : fe.yongshin === '목' ? '봄, 오전 5-7시, 오전 7-9시' : fe.yongshin === '토' ? '환절기, 오전 7-9시, 오후 1-3시' : '가을, 오후 3-5시, 오후 5-7시'}가 당신에게 행운의 시간입니다.

압력을 견딘 탄소만이 다이아몬드가 됩니다. ${input.name}님은 이미 충분히 빛나고 있으며, 앞으로 더 빛날 것입니다. 응원합니다!`
      }
    ];
    
    return sections;
  };
  
  // 섹션 제목 생성 함수 (일간 × 강한오행 × 신살 3중 조합으로 완전 고유 생성)
  const generateSectionTitle = (index, dayGanKr, strongEl, sinsal) => {
    const sinsalKey = sinsal.includes('백호살') ? 'baekho' : sinsal.includes('도화살') || sinsal.includes('홍염살') ? 'dohwa' : sinsal.includes('현침살') ? 'hyun' : sinsal.includes('학당귀인') ? 'hakdang' : sinsal.includes('재고귀인') ? 'jaego' : 'none';
    
    // 섹션 0: 정체성 (일간별 완전 고유)
    const sec0 = {
      '갑': { 'baekho': '칼날 위에 선 소나무, 두려움을 딛고 솟다', 'dohwa': '봄볕에 피어난 벚꽃 같은 존재감', 'hyun': '청죽처럼 곧되 날카로운 시선', 'hakdang': '대나무 숲에서 깨우치는 학자', 'jaego': '황금 씨앗을 품은 거목', 'none': '우뚝 선 소나무, 바위를 뚫고 자라다' },
      '을': { 'baekho': '부드럽지만 끊기지 않는 넝쿨의 힘', 'dohwa': '난초처럼 은은하고 깊은 매력', 'hyun': '풀잎의 이슬처럼 맑고 예리한 눈', 'hakdang': '늘 배우고 피어나는 들꽃의 지혜', 'jaego': '비옥한 땅을 채우는 덩굴의 결실', 'none': '바람에 흔들려도 꺾이지 않는 풀' },
      '병': { 'baekho': '태양을 삼킨 불꽃, 두려움도 태운다', 'dohwa': '모두를 사로잡는 태양의 카리스마', 'hyun': '빛으로 모든 것을 꿰뚫어보다', 'hakdang': '세상을 밝히는 지식의 등불', 'jaego': '황금빛 태양이 쌓는 부의 탑', 'none': '세상을 밝히는 당신의 열정' },
      '정': { 'baekho': '어둠 속에서도 꺼지지 않는 불꽃', 'dohwa': '조용히 타오르는 달빛 같은 매력', 'hyun': '가늘지만 예리하게 빛나는 촛불', 'hakdang': '밤을 밝혀 길을 여는 헌신의 불씨', 'jaego': '온기로 사람을 모으는 난롯불', 'none': '어둠 속 등대가 되어' },
      '무': { 'baekho': '거대한 산, 폭풍도 삼키는 의지', 'dohwa': '모든 이를 품는 대지의 넉넉함', 'hyun': '천하를 내려다보는 산 정상의 시야', 'hakdang': '만물의 이치를 품은 깊은 땅', 'jaego': '황금이 묻힌 풍요로운 산맥', 'none': '흔들리지 않는 대지의 중심' },
      '기': { 'baekho': '정원사의 손에 쥔 작은 낫, 의외의 강함', 'dohwa': '옥토에서 피어난 아름다운 꽃밭', 'hyun': '섬세한 손길로 세상을 읽는 눈', 'hakdang': '씨앗을 싹틔우는 따뜻한 지혜', 'jaego': '세심하게 가꾼 정원의 알찬 수확', 'none': '옥토에서 피어난 생명력' },
      '경': { 'baekho': '명검의 서슬 퍼런 기상, 두려움도 베다', 'dohwa': '다이아몬드처럼 빛나는 원칙주의자', 'hyun': '날선 칼날로 진실을 드러내다', 'hakdang': '학문으로 벼린 강철의 정신', 'jaego': '금고를 지키는 강철 의지', 'none': '칼날 위에서 춤추는 고고한 검객' },
      '신': { 'baekho': '보석 같은 날카로움과 서슬 차가운 의지', 'dohwa': '귀하게 빛나는 보석의 매혹', 'hyun': '조각가처럼 세밀하게 세상을 다듬다', 'hakdang': '완벽한 기술로 빚어낸 예술적 지성', 'jaego': '정교하게 가공된 보석 같은 재능', 'none': '섬세한 장인의 손길' },
      '임': { 'baekho': '대양의 파도, 모든 것을 삼키는 의지', 'dohwa': '깊은 바다처럼 신비롭고 매력적인', 'hyun': '흐르는 물처럼 모든 것을 꿰뚫다', 'hakdang': '깊은 지식의 바다를 헤엄치다', 'jaego': '바다처럼 넓게 쌓아올린 지혜의 재산', 'none': '흐르는 물처럼 막힘없이' },
      '계': { 'baekho': '이슬처럼 섬세하되 강처럼 모든 것을 채우다', 'dohwa': '안개처럼 신비롭고 은은한 매력', 'hyun': '감성과 직관으로 꿰뚫는 안목', 'hakdang': '끊임없이 솟는 샘물 같은 탐구심', 'jaego': '조용히 스며들어 채우는 풍요의 물', 'none': '감성과 직관의 신비로운 안개' }
    };
    
    // 섹션 1-11: 일간 × 강한오행 조합 타이틀
    const sec1 = { '목': '목화(木火)의 생기, 오행의 봄바람', '화': '불꽃처럼 타오르는 에너지 구조', '토': '대지의 무게, 오행이 중심을 잡다', '금': '금수(金水)의 예리한 균형감', '수': '깊은 물의 흐름, 내면의 오행 지도' };
    const sec2 = { '갑': '천간 갑목(甲木), 뿌리 깊은 기질', '을': '유연하게 감아오르는 을목(乙木)의 본성', '병': '태양 병화(丙火), 빛나는 일주의 이면', '정': '정화(丁火)의 일주, 조용한 내면의 불씨', '무': '무토(戊土) 일주, 묵직한 존재의 무게', '기': '기토(己土) 일주, 세심한 내면의 지도', '경': '경금(庚金) 일주, 타고난 결단의 날', '신': '신금(辛金) 일주, 예리하게 빛나는 원석', '임': '임수(壬水) 일주, 대양처럼 깊은 내면', '계': '계수(癸水) 일주, 이슬처럼 맑은 내면' };
    const sec3 = { '목': '목극토(木剋土), 욕망과 현실 사이의 갈등', '화': '화극금(火剋金), 열정이 만드는 내부 마찰', '토': '토극수(土剋水), 현실주의가 부르는 갈등', '금': '금극목(金剋木), 원칙이 만드는 내면 전쟁', '수': '수극화(水剋火), 이성과 감정의 충돌' };
    const sec4 = { '갑': '갑목(甲木)이 버텨온 폭풍의 시간들', '을': '을목처럼 구불구불 이어온 생존의 길', '병': '뜨겁게 살아낸 병화(丙火)의 흔적들', '정': '정화처럼 조용히 타오른 헌신의 역사', '무': '무토처럼 묵묵히 견뎌온 당신의 산', '기': '기토처럼 세심하게 버텨온 인내의 시간', '경': '경금처럼 담금질된 고난의 역사', '신': '신금처럼 갈고닦아진 당신의 빛', '임': '임수처럼 도도하게 흘러온 시간', '계': '계수처럼 스며들어 쌓인 아픔의 흔적' };
    const sec5 = { '목': '성장을 멈추지 않는 목(木) 기질의 초상', '화': '열정 과잉인가, 빛이 되는가 — 화(火) 기질', '토': '느리지만 확실한 토(土) 기질의 매력', '금': '원칙인가 고집인가 — 금(金) 기질의 두 얼굴', '수': '깊이를 알 수 없는 수(水) 기질의 세계' };
    const sec6 = { '목': '성장형 직업에서 빛나는 목(木) 기질', '화': '표현하고 이끄는 화(火)의 천직', '토': '믿음이 곧 경쟁력인 토(土)의 무대', '금': '정밀함이 돈이 되는 금(金)의 직업', '수': '지식과 기획으로 승부하는 수(水)의 길' };
    const sec7 = { '목': '씨 뿌리면 반드시 거두는 목(木)의 재물관', '화': '빠르게 벌고 빠르게 쓰는 화(火)의 재물', '토': '땅에 묻어두면 반드시 자라는 토(土)의 재물', '금': '손에 쥐면 놓지 않는 금(金)의 재물관', '수': '흘러다니는 물처럼 변화무쌍한 수(水)의 재물' };
    const sec8 = { '목': '성장하는 사랑 — 목(木)의 연애 코드', '화': '뜨겁게 타오르고 빠르게 식는 화(火)의 사랑', '토': '느리지만 한번 뿌리내리면 영원한 토(土)의 사랑', '금': '원칙과 약속이 사랑인 금(金)의 연애', '수': '깊고 넓게 흐르는 수(水)의 감정' };
    const sec9 = { '목': '뿌리를 찾아 솟는 나무 — 가족과 나', '화': '뜨겁게 타오른 가족의 불꽃과 상처', '토': '대지처럼 품어온 가족의 무게', '금': '서늘하게 맺어진 인연, 가족이라는 금속', '수': '조용히 흘러온 가족의 물줄기' };
    const sec10 = { '목': '함께 자라는 관계 — 목(木)의 인맥론', '화': '활활 타는 매력으로 모이는 사람들', '토': '신뢰로 쌓은 인간관계의 토대', '금': '원칙으로 솎아낸 진짜 인연들', '수': '조용히 스며드는 수(水)의 관계술' };
    const sec11 = { '목': '봄을 향해 나아가는 개운의 나침반', '화': '불꽃을 살려 운을 바꾸는 법', '토': '대지에 씨 뿌리는 개운의 전략', '금': '명검을 갈아 운명을 바꾸는 법', '수': '물처럼 흘러 길을 여는 개운법' };
    
    const secMap = { 1: sec1, 3: sec3, 5: sec5, 6: sec6, 7: sec7, 8: sec8, 9: sec9, 10: sec10, 11: sec11 };
    const secGanMap = { 2: sec2, 4: sec4 };
    
    if (index === 0) {
      const ganTitles = sec0[dayGanKr] || sec0['갑'];
      return ganTitles[sinsalKey] || ganTitles['none'];
    }
    if (secGanMap[index]) return secGanMap[index][dayGanKr] || Object.values(secGanMap[index])[0];
    if (secMap[index]) return secMap[index][strongEl] || Object.values(secMap[index])[0];
    return '깊은 통찰의 시간';
  };
  
  // 오행 한자 반환
  const getElHanja = (el) => {
    const map = { '목': '木', '화': '火', '토': '土', '금': '金', '수': '水' };
    return map[el] || el;
  };

  // ========== 운세 해설 생성 시스템 ==========
  const generateYearlyInterpretation = (result, input, year = 2026) => {
    const dayGanKr = STEMS.korean[result.dsi];
    const dayEl = STEMS.elements[result.dsi];
    const fe = result.fe;
    const allSinsal = [...(result.pillarSinsal?.year || []), ...(result.pillarSinsal?.month || []), ...(result.pillarSinsal?.day || []), ...(result.pillarSinsal?.hour || [])].filter((v, i, a) => a.indexOf(v) === i);
    
    // 2026년은 병오년(丙午年) - 화(火) 기운이 강함
    const yearEl = '화';
    const yearRelation = getYearRelation(dayEl, yearEl);
    
    // 총운 점수 계산 (deterministic)
    const baseScore = 50 + (result.dsi % 20);
    const elBonus = yearRelation === '생' ? 15 : yearRelation === '조화' ? 10 : yearRelation === '극' ? -10 : 0;
    const sinsalBonus = (allSinsal.includes('천을귀인') ? 5 : 0) + (allSinsal.includes('학당귀인') ? 3 : 0) - (allSinsal.includes('백호살') ? 2 : 0);
    const totalScore = Math.min(95, Math.max(45, baseScore + elBonus + sinsalBonus));
    
    // 월별 운세 생성
    const monthlyFortunes = generateMonthlyFortunes(result, input, totalScore);
    
    // 분야별 운세 생성
    const categoryFortunes = generateCategoryFortunes(result, input, yearEl);
    
    // 총운 해설
    const yearSummary = generateYearSummary(result, input, yearEl, yearRelation, totalScore);
    
    return {
      totalScore,
      yearSummary,
      monthlyFortunes,
      categoryFortunes,
      luckyInfo: {
        color: fe.yongshin === '화' ? '빨강, 보라' : fe.yongshin === '수' ? '검정, 파랑' : fe.yongshin === '목' ? '초록, 청록' : fe.yongshin === '토' ? '노랑, 갈색' : '흰색, 금색',
        number: fe.yongshin === '화' ? '2, 7' : fe.yongshin === '수' ? '1, 6' : fe.yongshin === '목' ? '3, 8' : fe.yongshin === '토' ? '5, 10' : '4, 9',
        direction: fe.yongshin === '화' ? '남쪽' : fe.yongshin === '수' ? '북쪽' : fe.yongshin === '목' ? '동쪽' : fe.yongshin === '토' ? '중앙' : '서쪽'
      }
    };
  };
  
  // 년운과 일간의 관계 판단
  const getYearRelation = (dayEl, yearEl) => {
    const relations = {
      '목': { '화': '생', '수': '생받음', '금': '극', '토': '극함' },
      '화': { '토': '생', '목': '생받음', '수': '극', '금': '극함' },
      '토': { '금': '생', '화': '생받음', '목': '극', '수': '극함' },
      '금': { '수': '생', '토': '생받음', '화': '극', '목': '극함' },
      '수': { '목': '생', '금': '생받음', '토': '극', '화': '극함' }
    };
    if (dayEl === yearEl) return '조화';
    return relations[dayEl]?.[yearEl] || '보통';
  };
  
  // 총운 해설 생성 (대폭 확장)
  const generateYearSummary = (result, input, yearEl, relation, score) => {
    const dayEl = STEMS.elements[result.dsi];
    const dayGan = STEMS.names[result.dsi];
    const dayGanKr = STEMS.korean[result.dsi];
    const fe = result.fe;
    const allSinsal = [...(result.pillarSinsal?.year || []), ...(result.pillarSinsal?.month || []), ...(result.pillarSinsal?.day || []), ...(result.pillarSinsal?.hour || [])].filter((v, i, a) => a.indexOf(v) === i);
    
    // 세운 분석
    const seunAnalysis = {
      '목': { good: '화 기운을 생해주어 표현력과 창의력이 빛나는 해입니다. 새싹이 햇볕을 받아 자라듯, 당신의 아이디어와 계획이 세상에 드러나 인정받는 시기입니다. 다만 에너지 소모가 크니 건강 관리에 신경 쓰세요.', bad: '목생화(木生火)로 기운을 빼앗기는 형국이니, 무리한 확장보다는 선택과 집중이 필요합니다.' },
      '화': { good: '같은 화 기운을 만나 힘이 배가 됩니다. 열정과 추진력이 정점에 달하는 해로, 그동안 망설이던 일을 과감히 밀어붙이세요. 화끼리 만나면 눈부시게 빛나지만, 지나치면 태울 수 있으니 조절이 필요합니다.', bad: '화기가 과하면 조급해지고 화를 참지 못하니, 감정 조절에 각별히 유의하세요.' },
      '토': { good: '화생토(火生土)로 에너지를 받는 최고의 해입니다! 병오년의 뜨거운 화 기운이 당신의 토 기운을 따뜻하게 데워주어, 건강도 좋아지고 하는 일마다 순풍에 돛을 단 듯 순조롭습니다. 부동산, 계약, 안정적인 투자에 특히 유리합니다.', bad: '좋은 운이지만 지나친 욕심은 금물. 분수에 맞는 목표를 세우세요.' },
      '금': { good: '도전적인 한 해가 될 것입니다. 화극금(火剋金)으로 올해의 화 기운이 금 일간인 당신을 달굽니다. 이는 대장간에서 쇠를 달궈 명검을 만드는 것과 같아, 힘들지만 단련의 시간입니다. 이 과정을 잘 버티면 한 단계 성장할 수 있습니다.', bad: '스트레스와 건강 문제에 특히 주의하세요. 폐, 기관지, 피부 질환을 조심하고, 과로를 피하세요. 큰 결정은 하반기로 미루는 것이 좋습니다.' },
      '수': { good: '수극화(水剋火)로 올해의 화 기운을 제어하는 힘이 있습니다. 주도권을 쥘 수 있는 해이지만, 정면 대결보다는 물처럼 유연하게 흘러가는 전략이 유효합니다. 경쟁에서 이길 수 있으나 에너지 소모가 큽니다.', bad: '화 기운을 억누르느라 힘이 드니, 충분한 휴식과 재충전이 필요합니다. 신장, 방광, 생식기 건강에 신경 쓰세요.' }
    };
    
    // 신살 영향 분석
    let sinsalEffect = '';
    if (allSinsal.includes('천을귀인') || allSinsal.includes('태극귀인')) {
      sinsalEffect += '사주에 귀인이 있어 어려운 상황에서도 도움을 받을 수 있습니다. 특히 윗사람이나 멘토의 조언에 귀 기울이세요. ';
    }
    if (allSinsal.includes('역마살') || allSinsal.includes('화개살')) {
      sinsalEffect += '역마의 기운이 있어 이사, 이직, 해외 출장 등 이동수가 있을 수 있습니다. 변화를 두려워하지 마세요. ';
    }
    if (allSinsal.includes('도화살') || allSinsal.includes('홍염살')) {
      sinsalEffect += '도화의 기운이 있어 이성 관계에 변화가 있을 수 있습니다. 매력이 빛나는 해이니 외모 관리에 투자하세요. ';
    }
    if (allSinsal.includes('백호살') || allSinsal.includes('양인살')) {
      sinsalEffect += '살(煞)의 기운이 있으니 사고와 수술에 주의하세요. 운전 시 방어운전, 과격한 운동은 피하세요. ';
    }
    
    let opening = '';
    if (score >= 80) {
      opening = `🎊 대길(大吉)의 해! 2026년 병오년(丙午年)은 ${input.name}님에게 그야말로 황금 같은 한 해입니다!

붉은 말(丙午)의 기운이 당신의 ${dayGan}(${dayGanKr}) 일간, ${dayEl}(${getElHanja(dayEl)}) 오행과 환상적인 조화를 이루고 있습니다. 그동안 씨 뿌리고 가꿔온 것들이 마침내 풍성한 열매로 익어가는 수확의 시기입니다. 주저하지 말고 적극적으로 나서세요. 당신이 손대는 일마다 성과가 따르고, 주변의 인정과 칭찬이 쏟아질 것입니다.`;
    } else if (score >= 65) {
      opening = `✨ 길(吉)의 해! 2026년 병오년(丙午年)은 ${input.name}님에게 성장과 도약의 한 해입니다.

화(火)의 열정적인 에너지가 가득한 해로, ${dayGan}(${dayGanKr}) 일간인 당신에게 활력과 추진력을 불어넣어 줍니다. 노력한 만큼 정직하게 돌아오는 해이니, 게으름 피우지 말고 부지런히 움직이세요. 특히 상반기에 중요한 기회가 찾아오니 놓치지 마세요.`;
    } else if (score >= 50) {
      opening = `🌱 평(平)의 해! 2026년 병오년(丙午年)은 ${input.name}님에게 내실을 다지는 한 해입니다.

화(火) 기운이 강한 해로, ${dayEl}(${getElHanja(dayEl)}) 오행인 당신에게는 ${dayEl === '금' || dayEl === '수' ? '다소 버거울 수 있는 에너지입니다. 하지만' : '약간의 긴장감을 주는 에너지입니다.'} 이런 해일수록 무리한 확장보다는 현재 가진 것을 지키고 다듬는 데 집중하세요. 위기는 곧 기회이니, 차분하게 실력을 쌓으면 다음 해에 빛을 발할 것입니다.`;
    } else {
      opening = `⚠️ 신중함이 필요한 해! 2026년 병오년(丙午年)은 ${input.name}님에게 인내와 지혜가 필요한 한 해입니다.

${dayEl === '금' ? '화극금(火剋金)! 올해의 강한 화 기운이 금 일간인 당신을 달구고 있습니다. 마치 대장간에서 쇠를 불에 달구는 것처럼, 압박과 시련이 있을 수 있습니다. 하지만 이 시련을 잘 이겨내면 더 단단한 강철로 거듭날 수 있습니다.' : dayEl === '수' ? '수극화(水剋火)! 당신의 수 기운이 올해의 화 기운과 맞서는 형국입니다. 에너지 소모가 크고 경쟁이 치열할 수 있습니다. 정면 승부보다는 우회 전략으로 지혜롭게 대처하세요.' : '올해의 화 기운이 당신에게는 다소 부담스러울 수 있습니다.'} 큰 결정은 미루고, 건강과 안전에 특히 유의하세요.`;
    }
    
    const detail = `

${seunAnalysis[dayEl]?.good || ''}

${sinsalEffect ? `[신살(神煞) 분석]\n${sinsalEffect}` : ''}

[2026년 운의 흐름]
${relation === '생' ? `당신의 ${dayEl}(${getElHanja(dayEl)}) 기운이 올해의 화(火) 기운을 생(生)해주는 관계입니다. 마치 나무가 불에 몸을 태워 빛과 열을 내듯, 당신의 에너지가 세상에 표출되는 해입니다. 창작, 발표, 영업, 마케팅, 프리젠테이션 등 자신을 드러내는 일에서 큰 성과가 있습니다. 다만 에너지 소모가 크니 충분히 휴식하고 충전하세요.` : relation === '생받음' ? `올해의 화(火) 기운이 당신의 ${dayEl}(${getElHanja(dayEl)}) 기운을 생(生)해주는 최고의 관계입니다! 마치 햇볕이 대지를 따뜻하게 데워주듯, 올해의 에너지가 당신에게 힘과 활력을 불어넣어 줍니다. 건강이 좋아지고, 하는 일마다 순조로우며, 새로운 시작에 최적의 타이밍입니다. 이 기회를 놓치지 마세요!` : relation === '극' ? `올해의 화(火) 기운이 당신의 ${dayEl}(${getElHanja(dayEl)}) 기운을 극(剋)하는 관계입니다. ${seunAnalysis[dayEl]?.bad || ''} 하지만 적당한 압박은 성장의 자양분이 됩니다. 대장간의 쇠처럼 이 시련을 잘 견디면 더 강해질 수 있습니다.` : relation === '극함' ? `당신의 ${dayEl}(${getElHanja(dayEl)}) 기운이 올해의 화(火) 기운을 극(剋)하는 관계입니다. 경쟁하거나 맞서야 할 일이 생길 수 있고, 이기더라도 에너지 소모가 큽니다. 정면 승부보다는 유연한 대처가 유효합니다. 불필요한 다툼은 피하세요.` : `당신의 ${dayEl}(${getElHanja(dayEl)}) 기운과 올해의 화(火) 기운이 같은 오행으로 비화(比和)를 이룹니다. 동지를 만난 격으로 힘이 배가 됩니다. 같은 뜻을 가진 사람들과 협력하면 큰 일을 도모할 수 있습니다.`}

[상반기(1~6월) 운세]
${score >= 65 ? '봄의 기운과 함께 당신의 운도 상승합니다. 새로운 시작, 계약, 이직, 창업 등 중요한 결정을 내리기에 좋은 시기입니다. 특히 3~5월에 좋은 기회가 올 수 있으니 준비하세요. 만사가 순조롭지만 너무 의욕적으로 나서면 무리가 될 수 있으니 페이스 조절도 중요합니다.' : '차분하게 준비하고 관찰하는 시간입니다. 섣부른 행동보다 정보를 수집하고 실력을 쌓으세요. 어려움이 있더라도 포기하지 말고 묵묵히 나아가면 하반기에 빛을 볼 것입니다. 3~4월에 잠시 주춤할 수 있으나 일시적인 현상이니 흔들리지 마세요.'}

[하반기(7~12월) 운세]
${score >= 65 ? '상반기에 뿌린 씨앗이 열매를 맺는 수확의 계절입니다. 성과를 다지고 마무리하는 데 집중하세요. 9~10월에 중요한 결실이 있을 수 있습니다. 연말에는 한 해를 돌아보며 내년을 준비하는 여유를 가지세요.' : '기회의 문이 열리기 시작합니다! 상반기의 인내가 결실로 이어지는 시기이니 포기하지 마세요. 8~9월에 전환점이 올 수 있습니다. 하반기에 적극적으로 움직이면 좋은 결과를 얻을 수 있습니다.'}

[올해의 핵심 조언]
${score >= 70 ? '✅ 기회를 잡으세요! 망설이지 말고 도전하세요.\n✅ 인맥을 넓히세요. 귀인이 나타날 수 있습니다.\n✅ 건강이 좋으니 활동량을 늘리세요.' : score >= 55 ? '✅ 실력을 쌓으세요. 공부와 자기계발에 투자하세요.\n✅ 인내심을 가지세요. 때를 기다리면 기회가 옵니다.\n✅ 지출을 줄이고 저축하세요.' : '✅ 무리하지 마세요. 건강이 최우선입니다.\n✅ 큰 결정은 미루세요. 신중함이 필요합니다.\n✅ 가까운 사람들과의 관계를 소중히 하세요.'}

[올해의 키워드]
${score >= 70 ? '🏆 "도약" · "확장" · "결실" · "인정" · "성취"' : score >= 55 ? '📚 "성장" · "준비" · "학습" · "인내" · "도전"' : '🛡️ "보존" · "재정비" · "휴식" · "절제" · "지혜"'}`;
    
    return opening + detail;
  };
  
  // 월별 운세 생성 (대폭 확장 - 각 월별 상세 해설 포함)
  const generateMonthlyFortunes = (result, input, baseScore) => {
    const months = ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'];
    const dayEl = STEMS.elements[result.dsi];
    const dayGan = STEMS.names[result.dsi];
    const dayGanKr = STEMS.korean[result.dsi];
    // 2026년 월별 천간지지
    const monthGans = ['경(庚)', '신(辛)', '임(壬)', '계(癸)', '갑(甲)', '을(乙)', '병(丙)', '정(丁)', '무(戊)', '기(己)', '경(庚)', '신(辛)'];
    const monthBranches = ['인(寅)', '묘(卯)', '진(辰)', '사(巳)', '오(午)', '미(未)', '신(申)', '유(酉)', '술(戌)', '해(亥)', '자(子)', '축(丑)'];
    const monthEls = ['목', '목', '토', '화', '화', '토', '금', '금', '토', '수', '수', '토'];
    
    // NaN 방지를 위한 안전한 값 사용
    const safeBaseScore = isNaN(baseScore) ? 60 : baseScore;
    const safeDsi = result.dsi || 0;
    const safeDbi = result.dbi || result.pillars?.day?.bi || 0;
    
    return months.map((month, i) => {
      const monthEl = monthEls[i];
      const monthBranch = monthBranches[i];
      const monthGan = monthGans[i];
      
      // 점수 계산 (일간과 월 오행의 상생상극 관계)
      let score = safeBaseScore;
      if (dayEl === monthEl) score += 10; // 비화
      else if ((dayEl === '목' && monthEl === '수') || (dayEl === '화' && monthEl === '목') || 
               (dayEl === '토' && monthEl === '화') || (dayEl === '금' && monthEl === '토') || 
               (dayEl === '수' && monthEl === '금')) score += 15; // 생받음
      else if ((dayEl === '목' && monthEl === '화') || (dayEl === '화' && monthEl === '토') || 
               (dayEl === '토' && monthEl === '금') || (dayEl === '금' && monthEl === '수') || 
               (dayEl === '수' && monthEl === '목')) score += 5; // 생함
      else if ((dayEl === '목' && monthEl === '금') || (dayEl === '화' && monthEl === '수') || 
               (dayEl === '토' && monthEl === '목') || (dayEl === '금' && monthEl === '화') || 
               (dayEl === '수' && monthEl === '토')) score -= 15; // 극받음
      else if ((dayEl === '목' && monthEl === '토') || (dayEl === '화' && monthEl === '금') || 
               (dayEl === '토' && monthEl === '수') || (dayEl === '금' && monthEl === '목') || 
               (dayEl === '수' && monthEl === '화')) score -= 5; // 극함
      
      // 변동성 추가 (결정론적, NaN 방지)
      const variance = ((safeDsi + safeDbi + i * 7) % 21) - 10;
      score += variance;
      score = Math.min(95, Math.max(35, Math.round(score)));
      
      // 레벨 결정
      const level = score >= 70 ? 'high' : score >= 50 ? 'mid' : 'low';
      
      // 월별 상세 해설 생성
      const monthNames = ['정월', '이월', '삼월', '사월', '오월', '유월', '칠월', '팔월', '구월', '시월', '동짓달', '섣달'];
      const seasonContext = i < 2 ? '겨울의 끝자락' : i < 5 ? '봄의 기운' : i < 8 ? '여름의 열기' : i < 11 ? '가을의 결실' : '겨울의 시작';
      
      // 오행 관계에 따른 해설
      let relationDesc = '';
      if (dayEl === monthEl) {
        relationDesc = `이달은 당신의 ${dayEl}(${getElHanja(dayEl)}) 기운과 같은 오행이 흐릅니다. 동지를 만난 격으로 힘이 배가 되지만, 같은 오행끼리 부딪히면 경쟁이 될 수 있습니다.`;
      } else if ((dayEl === '목' && monthEl === '수') || (dayEl === '화' && monthEl === '목') || 
                 (dayEl === '토' && monthEl === '화') || (dayEl === '금' && monthEl === '토') || 
                 (dayEl === '수' && monthEl === '금')) {
        relationDesc = `이달의 ${monthEl}(${getElHanja(monthEl)}) 기운이 당신의 ${dayEl}(${getElHanja(dayEl)}) 기운을 생(生)해줍니다! 에너지를 받아 활력이 넘치고, 하는 일마다 순조로운 달입니다.`;
      } else if ((dayEl === '목' && monthEl === '화') || (dayEl === '화' && monthEl === '토') || 
                 (dayEl === '토' && monthEl === '금') || (dayEl === '금' && monthEl === '수') || 
                 (dayEl === '수' && monthEl === '목')) {
        relationDesc = `당신의 ${dayEl}(${getElHanja(dayEl)}) 기운이 이달의 ${monthEl}(${getElHanja(monthEl)}) 기운을 생(生)해줍니다. 에너지를 쓰는 달이지만, 그만큼 표현하고 드러내는 일에서 성과가 있습니다.`;
      } else if ((dayEl === '목' && monthEl === '금') || (dayEl === '화' && monthEl === '수') || 
                 (dayEl === '토' && monthEl === '목') || (dayEl === '금' && monthEl === '화') || 
                 (dayEl === '수' && monthEl === '토')) {
        relationDesc = `이달의 ${monthEl}(${getElHanja(monthEl)}) 기운이 당신의 ${dayEl}(${getElHanja(dayEl)}) 기운을 극(克)합니다. 압박이 있을 수 있지만, 이를 성장의 기회로 삼으세요.`;
      } else {
        relationDesc = `당신의 ${dayEl}(${getElHanja(dayEl)}) 기운이 이달의 ${monthEl}(${getElHanja(monthEl)}) 기운을 극(克)합니다. 경쟁하거나 맞서야 할 일이 있지만, 주도권을 쥘 수 있습니다.`;
      }
      
      // 분야별 상세 해설
      const detailSections = {
        work: score >= 70 
          ? `[직장/사업] 업무에서 인정받을 기회가 있습니다. 새로운 프로젝트, 제안, 협상에 적극적으로 나서세요. 상사의 눈에 띄는 성과를 낼 수 있고, 팀원들과의 협업도 원활합니다. 이직이나 승진을 노린다면 이달이 적기입니다.`
          : score >= 50 
          ? `[직장/사업] 묵묵히 맡은 일에 집중하는 것이 좋습니다. 화려한 성과보다 실수 없이 안정적으로 처리하는 것이 평가에 유리합니다. 동료와의 갈등이 생길 수 있으니 말을 아끼고, 불필요한 논쟁은 피하세요.`
          : `[직장/사업] 어려운 일이 생길 수 있습니다. 무리한 계획보다 현상 유지에 집중하세요. 중요한 결정은 다음 달로 미루는 것이 좋고, 상사나 거래처와의 갈등에 주의하세요. 감정적 대응은 금물입니다.`,
        money: score >= 70 
          ? `[재물] 금전운이 좋습니다. 부수입이 생기거나 투자 수익이 있을 수 있습니다. 다만 돈이 들어오는 만큼 지출 유혹도 크니, 계획적으로 사용하세요. 큰 구매나 계약은 충분히 검토 후 진행하면 이득입니다.`
          : score >= 50 
          ? `[재물] 수입과 지출이 균형을 이루는 달입니다. 큰 투자보다는 안정적인 저축이 좋습니다. 예상치 못한 경조사비나 수리비가 생길 수 있으니 여유 자금을 확보해두세요. 충동구매는 피하세요.`
          : `[재물] 재정에 신경 써야 합니다. 뜻하지 않은 지출이 생기거나 손실 위험이 있습니다. 투기성 투자, 빚 보증, 고가 구매는 절대 피하세요. 긴축 재정으로 이달을 넘기면 다음 달에 회복됩니다.`,
        love: score >= 70 
          ? `[연애/인간관계] 인기운이 상승합니다! 싱글이라면 좋은 만남이 있을 수 있고, 커플이라면 관계가 더 깊어집니다. 가족, 친구와의 관계도 화목합니다. 모임이나 약속에 적극적으로 참여하세요.`
          : score >= 50 
          ? `[연애/인간관계] 큰 변화 없이 평온한 관계가 유지됩니다. 새로운 만남보다 기존 관계를 다지는 데 집중하세요. 사소한 오해가 생길 수 있으니 표현을 명확히 하고, 상대방의 입장에서 생각해보세요.`
          : `[연애/인간관계] 인간관계에서 갈등이 생길 수 있습니다. 연인이나 배우자와 다툼에 주의하고, 가족 간 의견 충돌도 조심하세요. 감정적으로 대응하면 관계가 틀어질 수 있으니, 한 발 물러서는 지혜가 필요합니다.`,
        health: score >= 70 
          ? `[건강] 활력이 넘치는 달입니다. 운동을 시작하거나 건강한 습관을 들이기에 좋습니다. 다만 에너지가 넘쳐서 무리하지 않도록 주의하세요. 충분한 수면과 규칙적인 생활이 컨디션 유지의 핵심입니다.`
          : score >= 50 
          ? `[건강] 무난한 건강 상태이지만, 피로가 쌓이지 않도록 관리하세요. 불규칙한 식사나 수면 부족은 면역력을 떨어뜨립니다. 가벼운 운동과 스트레칭으로 몸을 돌보세요.`
          : `[건강] 건강에 주의가 필요한 달입니다. ${dayEl === '금' || dayEl === '수' ? '감기, 호흡기 질환에 조심하세요.' : dayEl === '화' ? '심장, 혈압에 신경 쓰세요.' : '소화기, 피로에 주의하세요.'} 과로를 피하고, 이상 증상이 있으면 빨리 병원에 가세요.`
      };
      
      // 핵심 조언
      const coreAdvice = score >= 70 
        ? `✨ ${monthNames[i]}의 핵심: 적극적으로 나서세요! 기회가 오면 잡고, 새로운 시작을 두려워하지 마세요.`
        : score >= 50 
        ? `💪 ${monthNames[i]}의 핵심: 꾸준함이 답입니다. 묵묵히 노력하면 결과가 따릅니다. 조급해하지 마세요.`
        : `🛡️ ${monthNames[i]}의 핵심: 무리하지 마세요. 건강과 안전이 최우선입니다. 때를 기다리면 좋아집니다.`;
      
      // 행운의 날
      const luckyDays = `행운의 날: ${((safeDsi + i * 3) % 28) + 1}일, ${((safeDsi + i * 7 + 14) % 28) + 1}일`;
      
      // 전체 해설 조합
      const fullDetail = `[${month} ${monthGan} ${monthBranch}]

${seasonContext}에 ${monthEl}(${getElHanja(monthEl)})의 기운이 흐르는 달입니다. ${relationDesc}

${detailSections.work}

${detailSections.money}

${detailSections.love}

${detailSections.health}

${coreAdvice}

📆 ${luckyDays}`;
      
      const keywords = {
        high: ['🌟행운', '💫성취', '🎯기회', '🏆성공', '✨도약'],
        mid: ['📚성장', '💪노력', '🤝협력', '🌱발전', '🔄전환'],
        low: ['🛡️보호', '💭성찰', '🧘휴식', '⚖️절제', '🔒안정']
      };
      const keyword = keywords[level][(safeDsi + i) % keywords[level].length];
      
      // 짧은 조언 (그리드 표시용)
      const shortAdvice = score >= 70 
        ? '적극적으로 나서세요'
        : score >= 50 
        ? '꾸준히 노력하세요'
        : '무리하지 마세요';
      
      // 월별 사주 기반 제목 생성
      const monthTitlePool = {
        high: {
          '목': ['봄바람이 부는 희망의 달', '새싹처럼 솟아오르는 전진의 시기', '성장의 기운이 가득한 달'],
          '화': ['불꽃처럼 타오르는 행운의 달', '열정이 결실을 맺는 시기', '빛나는 기회가 열리는 달'],
          '토': ['단단한 땅 위에 꽃피는 달', '신뢰와 성과가 쌓이는 시기', '안정 속에 풍요가 찾아오는 달'],
          '금': ['명검이 빛을 발하는 달', '결단이 성과를 부르는 시기', '칼날처럼 날카로운 행운의 달'],
          '수': ['깊은 지혜가 통하는 달', '물처럼 흘러 막힘없는 시기', '직관이 빛나는 기회의 달']
        },
        mid: {
          '목': ['나무처럼 묵묵히 자라는 달', '꾸준함이 싹을 틔우는 시기', '뿌리를 다지는 준비의 달'],
          '화': ['불씨를 살려가는 평온한 달', '차분한 열정으로 쌓아가는 시기', '내실을 다지는 달'],
          '토': ['흙을 고르며 내실을 쌓는 달', '기다림이 미덕인 시기', '차분하게 나아가는 달'],
          '금': ['쇠를 갈며 준비하는 달', '날을 세우는 침묵의 시기', '원칙을 지키는 평온한 달'],
          '수': ['고요히 흐르며 기회를 기다리는 달', '깊이 생각하며 준비하는 시기', '지혜를 모으는 달']
        },
        low: {
          '목': ['폭풍 앞 나무, 뿌리를 붙드는 달', '고난이 단련하는 인내의 시기', '숨죽여 때를 기다리는 달'],
          '화': ['불꽃이 흔들리는 시련의 달', '에너지를 아끼며 버티는 시기', '내면을 다잡는 단련의 달'],
          '토': ['무거운 땅을 짊어지는 달', '주춤하지만 포기하지 않는 시기', '흔들려도 무너지지 않는 달'],
          '금': ['날이 무뎌지는 것 같은 시련의 달', '인내로 단련되는 강철의 시기', '담금질 속에 빛나는 달'],
          '수': ['흐름이 막히는 시련의 달', '고요함으로 버티는 시기', '멈춰 서서 방향을 잡는 달']
        }
      };
      const tPool = monthTitlePool[level][monthEl] || monthTitlePool[level]['목'];
      const monthTitle = tPool[(safeDsi + i * 3) % tPool.length];
      
      return { 
        month, 
        score: isNaN(score) ? 60 : Math.round(score), 
        keyword, 
        advice: shortAdvice,
        fullDetail,
        monthBranch,
        monthEl,
        level,
        monthTitle
      };
    });
  };
  
  // 분야별 운세 생성 (대폭 확장)
  const generateCategoryFortunes = (result, input, yearEl) => {
    const dayEl = STEMS.elements[result.dsi];
    const dayGan = STEMS.names[result.dsi];
    const fe = result.fe;
    const allSinsal = [...(result.pillarSinsal?.year || []), ...(result.pillarSinsal?.month || []), ...(result.pillarSinsal?.day || []), ...(result.pillarSinsal?.hour || [])].filter((v, i, a) => a.indexOf(v) === i);
    
    // 재물운 점수 계산
    const wealthScore = Math.min(95, Math.max(40, 55 + (fe.pct['토'] || 0) / 2 + (fe.pct['금'] || 0) / 3 + (allSinsal.includes('재고귀인') ? 12 : 0) + (allSinsal.includes('천을귀인') ? 8 : 0) - (allSinsal.includes('겁재') ? 10 : 0)));
    
    // 연애운 점수 계산  
    const loveScore = Math.min(95, Math.max(40, 50 + (fe.pct['화'] || 0) / 2 + (allSinsal.includes('도화살') ? 15 : 0) + (allSinsal.includes('홍염살') ? 12 : 0) + (allSinsal.includes('천희성') ? 10 : 0) - (allSinsal.includes('고진살') ? 8 : 0)));
    
    // 직장운 점수 계산
    const careerScore = Math.min(95, Math.max(40, 55 + (fe.pct['목'] || 0) / 2 + (fe.pct['화'] || 0) / 3 + (allSinsal.includes('학당귀인') ? 12 : 0) + (allSinsal.includes('문창귀인') ? 10 : 0) - (allSinsal.includes('백호살') ? 8 : 0)));
    
    // 건강운 점수 계산
    const healthScore = Math.min(95, Math.max(40, 60 + (fe.pct['수'] || 0) / 2 - (allSinsal.includes('백호살') ? 10 : 0) - (allSinsal.includes('양인살') ? 8 : 0) + (fe.balance === '중화' ? 10 : 0)));
    
    return {
      wealth: {
        score: Math.round(wealthScore),
        title: '💰 재물운',
        summary: wealthScore >= 75 ? '💎 재물이 쏟아지는 해! 투자와 확장에 유리합니다' : wealthScore >= 55 ? '📈 꾸준히 모으면 성과가 있는 해입니다' : '🛡️ 지키는 것이 버는 것! 절약이 미덕인 해입니다',
        detail: `[2026년 재물운 심층 분석]

${wealthScore >= 75 ? `올해는 재물운이 상승하는 길년(吉年)입니다! ${dayEl === '토' ? '화생토(火生土)로 올해의 화 기운이 토 일간인 당신의 재물운을 강하게 밀어줍니다. 부동산, 실물 자산에서 특히 이득이 있을 수 있습니다.' : fe.pct['토'] > 20 ? '재성(財星)인 토 기운이 강해 돈이 모이는 해입니다. 저축액이 늘고 예상치 못한 수입도 기대됩니다.' : '올해의 뜨거운 화 기운이 당신의 재물운에 활력을 불어넣습니다.'}

💵 상반기(1~6월): 투자나 새로운 수입원을 모색하기 좋은 시기입니다. 3~4월에 좋은 제안이 들어올 수 있으니 귀를 열어두세요.
💵 하반기(7~12월): 상반기의 성과가 결실을 맺습니다. 9~10월에 목돈이 들어오거나 계약이 성사될 수 있습니다.` : wealthScore >= 55 ? `올해는 큰 변동 없이 안정적인 재물운입니다. 한방을 노리기보다 꾸준히 모으는 전략이 유효합니다. ${fe.pct['금'] > 15 ? '금(金) 기운이 있어 금융 상품, 저축에서 이익을 볼 수 있습니다.' : '본업에서의 수입이 주된 재원이 됩니다. 부수입은 기대하지 마세요.'}

💵 상반기(1~6월): 지출이 늘 수 있습니다. 계획에 없던 비용이 생기니 비상금을 마련해두세요.
💵 하반기(7~12월): 상반기보다 재정이 안정됩니다. 저축을 시작하기 좋은 시기입니다.` : `올해는 재물보다 지혜가 필요한 해입니다. 큰 투자나 확장은 피하고, 가진 것을 지키는 데 집중하세요. ${dayEl === '금' ? '화극금(火剋金)으로 올해의 화 기운이 부담되니, 공격적인 투자는 손실로 이어질 수 있습니다.' : '무리한 욕심은 화를 부릅니다. 분수에 맞는 목표를 세우세요.'}

💵 상반기(1~6월): 예상치 못한 지출에 대비하세요. 보험 점검, 비상금 마련이 필요합니다.
💵 하반기(7~12월): 상황이 나아집니다. 상반기를 잘 견디면 연말에는 안정을 찾을 수 있습니다.`}

[💡 재물운 핵심 조언]
${allSinsal.includes('재고귀인') ? '✅ 재고귀인이 있어 저축하면 모이는 팔자입니다. 매월 자동이체를 설정하세요.' : ''}
${allSinsal.includes('겁재') ? '⚠️ 겁재가 있으니 친구나 지인에게 돈을 빌려주지 마세요. 보증도 절대 안 됩니다.' : ''}
• ${fe.yongshin === '토' ? '부동산, 땅 관련 정보를 주시하세요. 좋은 기회가 올 수 있습니다.' : fe.yongshin === '금' ? '금융 상품, 적금, 펀드를 공부하세요. 재테크 감각이 살아납니다.' : '본업에 충실하는 것이 최고의 재테크입니다.'}
• 투기성 투자(주식 단타, 코인, 도박)는 절대 피하세요. 
• 크게 벌려는 욕심보다 잃지 않는 것이 중요합니다.

[🎯 행운의 재물 타이밍]
• 길일: 매월 ${(result.dsi % 9) + 1}일, ${((result.dsi + 5) % 28) + 1}일
• 좋은 방향: ${fe.yongshin === '화' ? '남쪽' : fe.yongshin === '수' ? '북쪽' : fe.yongshin === '목' ? '동쪽' : fe.yongshin === '토' ? '중앙' : '서쪽'} 방향에서 재물이 들어옵니다.`
      },
      love: {
        score: Math.round(loveScore),
        title: '💕 연애운',
        summary: loveScore >= 75 ? '💘 사랑이 찾아오는 해! 적극적으로 나서세요' : loveScore >= 55 ? '💑 기존 관계가 깊어지는 해입니다' : '💭 내면을 돌보며 진정한 사랑을 준비하세요',
        detail: `[2026년 연애운 심층 분석]

${loveScore >= 75 ? `올해는 연애운이 꽃피는 해입니다! ${allSinsal.includes('도화살') ? '도화살(桃花煞)이 있어 이성에게 유독 매력적으로 보이는 해입니다. 외모에 투자하면 그 효과가 배가 됩니다.' : allSinsal.includes('홍염살') ? '홍염살(紅艶煞)이 있어 이성을 끄는 묘한 매력이 발산됩니다. 어디를 가든 눈에 띄게 됩니다.' : '화(火)의 열정적인 기운이 당신의 사랑운을 불태웁니다!'} 

💘 싱글이라면: 상반기에 좋은 인연을 만날 확률이 높습니다. 소개팅, 미팅에 적극 참여하세요. 특히 3~5월, 9~10월에 좋은 만남이 기대됩니다. ${fe.yongshin === '화' ? '활동적인 모임, 스포츠, 축제에서 인연을 찾으세요.' : fe.yongshin === '수' ? '조용한 모임, 독서회, 스터디에서 인연을 찾으세요.' : '지인 소개로 만나는 인연이 진지할 확률이 높습니다.'}

💑 연애/기혼이라면: 관계가 한 단계 발전하는 해입니다. 프러포즈, 약혼, 결혼을 고려해볼 만한 시기입니다. 함께하는 새로운 취미를 시작하면 사랑이 깊어집니다.` : loveScore >= 55 ? `올해는 새로운 만남보다 기존 관계를 다지는 데 집중하는 것이 좋습니다. 화려한 로맨스보다는 서로를 이해하고 신뢰를 쌓는 시간입니다.

💘 싱글이라면: 급하게 인연을 찾기보다 자신을 가꾸는 데 집중하세요. 하반기(9~12월)에 자연스러운 만남이 있을 수 있습니다. 직장이나 동호회에서 인연을 찾을 확률이 높습니다.

💑 연애/기혼이라면: 대화 시간을 늘리세요. 표현하지 않으면 상대는 모릅니다. 서로의 공간과 취미를 존중하되, 함께하는 시간도 소중히 하세요.` : `올해는 연애보다 자신을 돌보는 데 집중하는 것이 좋습니다. 무리하게 인연을 찾기보다 내면을 가꾸세요. 준비된 사람에게 좋은 인연이 찾아옵니다.

💘 싱글이라면: 올해는 연애보다 자기 발전에 집중하세요. 운동, 취미, 자격증 취득 등 스스로를 가꾸면 내년에 좋은 인연이 찾아옵니다. 급하게 시작한 관계는 오래가지 못합니다.

💑 연애/기혼이라면: 갈등이 생길 수 있습니다. ${allSinsal.includes('현침살') ? '말다툼에 주의하세요. 논리로 이기려 하면 감정은 집니다.' : '서로의 단점이 눈에 들어오는 시기입니다. 관용과 이해심이 필요합니다.'}`}

[💡 연애운 핵심 조언]
${allSinsal.includes('도화살') || allSinsal.includes('홍염살') ? '✅ 도화/홍염이 있으니 외모 관리에 투자하세요. 효과가 배가 됩니다.' : ''}
${allSinsal.includes('고진살') || allSinsal.includes('과숙살') ? '⚠️ 고독의 기운이 있으니 먼저 다가가는 용기가 필요합니다.' : ''}
• 싸울 때 논리로 이기려 하지 마세요. 연애는 논문 발표가 아닙니다.
• 상대방의 말을 끝까지 들어주세요. 경청이 최고의 사랑 표현입니다.
• 표현하세요! 마음은 말해야 전해집니다.

[🎯 연애 행운의 타이밍]
• 길한 달: ${allSinsal.includes('도화살') ? '3월, 5월, 9월' : '4월, 6월, 10월'}
• 좋은 장소: ${fe.yongshin === '화' ? '공연장, 파티, 축제' : fe.yongshin === '수' ? '바닷가, 수족관, 카페' : fe.yongshin === '목' ? '공원, 산, 식물원' : '미술관, 도서관, 조용한 레스토랑'}`
      },
      career: {
        score: Math.round(careerScore),
        title: '💼 직장/사업운',
        summary: careerScore >= 75 ? '🚀 승진과 성취의 해! 적극적으로 도전하세요' : careerScore >= 55 ? '📊 꾸준히 실력을 쌓으면 인정받는 해입니다' : '🔧 현재 위치에서 내실을 다지세요',
        detail: `[2026년 직장/사업운 심층 분석]

${careerScore >= 75 ? `올해는 직장에서 빛나는 해입니다! ${fe.pct['목'] > 20 ? '목(木) 기운이 강해 새로운 시작과 도전에 유리합니다. 이직, 부서 이동, 새 프로젝트 등 변화가 좋은 결과를 가져옵니다.' : fe.pct['화'] > 20 ? '화(火) 기운이 강해 표현력과 추진력이 빛납니다. 프레젠테이션, 영업, 협상에서 두각을 나타냅니다.' : '올해의 화(火) 에너지가 당신의 업무 능력을 끌어올립니다.'}

🏢 직장인이라면: 승진, 연봉 인상의 기회가 있습니다. 상반기에 성과를 내면 하반기에 보상이 따릅니다. ${allSinsal.includes('학당귀인') ? '학당귀인이 있어 배움과 자격증 취득이 승진으로 이어집니다.' : '어필할 기회가 오면 주저하지 말고 나서세요.'}

💼 사업/자영업이라면: 확장의 기회입니다. 새 상품, 새 지점, 새 서비스를 검토해보세요. 마케팅에 투자하면 효과가 큽니다.` : careerScore >= 55 ? `올해는 큰 변화보다 현재 위치에서 실력을 쌓는 것이 좋습니다. 묵묵히 노력하면 상사와 동료의 인정을 받을 수 있습니다.

🏢 직장인이라면: 맡은 일에 최선을 다하세요. 화려한 성과보다 꾸준한 실력이 인정받는 해입니다. 자기 계발, 교육 이수, 자격증 취득에 투자하면 내년에 빛을 봅니다. ${allSinsal.includes('백호살') ? '상사와의 충돌을 피하세요. 한 발 물러서는 것이 이기는 것입니다.' : '인간관계를 원만히 유지하세요.'}

💼 사업/자영업이라면: 무리한 확장은 피하세요. 기존 고객 관리, 서비스 개선에 집중하면 안정적인 수익을 유지할 수 있습니다.` : `올해는 직장에서 인내가 필요한 해입니다. 당장의 성과보다 긴 안목으로 실력을 쌓으세요. 지금 뿌리는 씨앗이 내년, 내후년에 열매를 맺습니다.

🏢 직장인이라면: 이직이나 큰 변화는 미루세요. 지금은 때가 아닙니다. 현재 위치에서 할 수 있는 것에 집중하세요. 불평보다 실력을 쌓으면 때가 왔을 때 기회를 잡을 수 있습니다.

💼 사업/자영업이라면: 수성(守城)의 자세가 필요합니다. 새로운 투자나 확장은 위험합니다. 비용 절감, 내실 다지기에 집중하세요.`}

[💡 직장운 핵심 조언]
${allSinsal.includes('학당귀인') || allSinsal.includes('문창귀인') ? '✅ 귀인이 있어 배움이 성과로 이어집니다. 교육, 자격증에 투자하세요.' : ''}
${allSinsal.includes('역마살') ? '✅ 역마가 있어 이직, 부서 이동, 출장이 길합니다.' : ''}
• 본업에 충실하세요. 부업은 본업에 지장을 줄 수 있습니다.
• 인간관계가 중요합니다. 실력만큼 처세도 필요합니다.
• 급하게 결정하지 마세요. 충분히 고민한 후 행동하세요.

[🎯 직장 행운의 타이밍]
• 중요 업무 추진: ${careerScore >= 65 ? '상반기(3~5월)' : '하반기(9~11월)'}
• 이직/변화 시기: ${allSinsal.includes('역마살') ? '상반기 추천' : '올해는 보류, 내년을 노리세요'}`
      },
      health: {
        score: Math.round(healthScore),
        title: '❤️ 건강운',
        summary: healthScore >= 75 ? '💪 활력 넘치는 건강한 한 해입니다' : healthScore >= 55 ? '🏃 적당한 운동과 관리로 건강을 유지하세요' : '🏥 건강 관리에 각별히 신경 쓰세요',
        detail: `[2026년 건강운 심층 분석]

${dayEl === '금' ? `🔥 화극금(火剋金)! 올해 병오년의 강한 화 기운이 금 일간인 당신에게 부담을 줍니다.

⚠️ 주의해야 할 부위: 폐, 기관지, 피부, 대장
올해는 호흡기 질환, 피부 트러블, 알레르기에 특히 주의하세요. 건조한 환경을 피하고 가습기를 사용하세요. 금연은 필수이며, 미세먼지가 심한 날은 외출을 삼가세요.

💊 관리법: 
• 폐를 윤하게 하는 배, 은행, 도라지를 섭취하세요
• 충분한 수분 섭취로 기관지를 촉촉하게 유지하세요
• 스트레스로 인한 피부 트러블에 주의하세요` : dayEl === '수' ? `💧 올해의 화 기운과 수 일간인 당신이 맞서는 형국입니다. 에너지 소모가 크고 피로가 쌓이기 쉽습니다.

⚠️ 주의해야 할 부위: 신장, 방광, 생식기, 귀
수분 대사와 관련된 기관에 무리가 올 수 있습니다. 충분한 수분 섭취와 휴식이 필수입니다.

💊 관리법:
• 검은 콩, 검은 깨, 해조류 등 신장에 좋은 음식을 섭취하세요
• 족욕으로 하체 순환을 돕고 피로를 풀어주세요
• 과도한 음주와 짠 음식을 피하세요` : dayEl === '목' ? `🌳 목생화(木生火)! 당신의 에너지가 올해의 화 기운으로 빠져나가는 형국입니다. 기력 저하와 피로에 주의하세요.

⚠️ 주의해야 할 부위: 간, 담낭, 눈, 근육
과로하면 간에 무리가 오고 눈이 침침해질 수 있습니다. 충분한 수면과 휴식이 필수입니다.

💊 관리법:
• 녹색 채소, 신맛 나는 음식(매실, 레몬)이 간에 좋습니다
• 눈을 혹사하지 마세요. 블루라이트 차단 안경을 쓰세요
• 스트레칭과 요가로 근육을 풀어주세요` : dayEl === '화' ? `🔥 비화(比和)! 같은 화 기운을 만나 에너지가 넘칩니다. 하지만 과유불급, 지나치면 탈이 납니다.

⚠️ 주의해야 할 부위: 심장, 혈압, 소장
화가 과하면 심장에 부담이 됩니다. 급한 성격, 과로, 스트레스가 심혈관 질환으로 이어질 수 있으니 주의하세요.

💊 관리법:
• 쓴맛 음식(쑥갓, 샐러리, 녹차)이 심장을 안정시킵니다
• 과격한 운동보다 유산소 운동을 꾸준히 하세요
• 충분한 수면으로 심장을 쉬게 해주세요` : `🌍 화생토(火生土)! 올해의 화 기운이 토 일간인 당신에게 에너지를 줍니다. 전반적으로 건강한 한 해입니다.

⚠️ 주의해야 할 부위: 위장, 비장, 피부
소화기 계통을 관리하면 큰 병 없이 지낼 수 있습니다.

💊 관리법:
• 노란 음식(호박, 고구마, 단호박)이 위장에 좋습니다
• 규칙적인 식사가 중요합니다. 폭식과 과식을 피하세요
• 당분 섭취를 줄이세요`}

${allSinsal.includes('백호살') || allSinsal.includes('양인살') ? `
[⚠️ 특별 주의사항 - 사고/수술 주의]
사주에 ${allSinsal.includes('백호살') ? '백호살' : '양인살'}이 있어 올해 사고나 수술에 특히 주의해야 합니다.
• 운전 시 방어운전, 과속 금지
• 과격한 운동, 위험한 취미 활동 자제
• 칼, 날카로운 도구 사용 시 주의
• 정기 건강검진 필수` : ''}

[🏃 추천 운동]
${fe.yongshin === '수' ? '수영, 아쿠아로빅 등 물과 관련된 운동' : fe.yongshin === '화' ? '달리기, 테니스, 에어로빅 등 활동적인 운동' : fe.yongshin === '목' ? '등산, 트레킹, 골프 등 자연 속 운동' : fe.yongshin === '금' ? '헬스, 필라테스, 웨이트 등 정적인 운동' : '요가, 태극권, 스트레칭 등 균형 잡힌 운동'}

[🍽️ 추천 음식]
${dayEl === '금' || dayEl === '수' ? '따뜻한 성질의 음식: 생강차, 계피차, 인삼, 대추' : '시원한 성질의 음식: 녹두, 오이, 수박, 녹차'}`
      }
    };
  };

  // 실제 로그인 처리 (SDK 콜백에서 호출)
  const handleLogin = (method, email = '') => {
    const resolvedEmail = email || `user@${method}.com`;
    const emailHash = resolvedEmail.split('').reduce((acc, c) => (acc * 31 + c.charCodeAt(0)) & 0xffffffff, 0).toString(36);
    const resolvedKey = `${method}_${emailHash}`;

    // 세션 저장 (자동 로그인용)
    try {
      localStorage.setItem('sajuon::session', JSON.stringify({ key: resolvedKey, email: resolvedEmail, method }));
    } catch(e) {}

    // 해당 계정의 저장 데이터 로드
    const acctSaju         = loadUserData(resolvedKey, 'savedSaju', []);
    const acctPaidSaju     = loadUserData(resolvedKey, 'savedPaidSaju', []);
    const acctCompatibility= loadUserData(resolvedKey, 'savedCompatibility', []);
    const acctYearly       = loadUserData(resolvedKey, 'savedYearly', []);
    const acctPurchases    = loadUserData(resolvedKey, 'purchases', []);

    setIsLoggedIn(true);
    setLoginMethod(method);
    setUserEmail(resolvedEmail);
    setUserKey(resolvedKey);
    setSavedSajuRaw(acctSaju);
    setSavedPaidSajuRaw(acctPaidSaju);
    setSavedCompatibilityRaw(acctCompatibility);
    setSavedYearlyRaw(acctYearly);
    setPurchases(acctPurchases);
    setShowLogin(false);

    // 로그인 전 사주 입력 완료된 경우 → 해당 계정에 저장 후 결과 화면 이동
    if (currentResult && currentInput && currentScreen === 'input') {
      const alreadySaved = acctSaju.some(s =>
        s.name === currentInput.name && s.year === currentInput.year &&
        s.month === currentInput.month && s.day === currentInput.day
      );
      if (!alreadySaved) {
        const updated = [...acctSaju, { id: Date.now(), ...currentInput, result: currentResult }];
        setSavedSajuRaw(updated);
        saveUserData(resolvedKey, 'savedSaju', updated);
      }
      setScreen('free-result');
    }
  };

  const handleLogout = () => {
    // 세션 삭제 (데이터는 localStorage에 유지)
    try { localStorage.removeItem('sajuon::session'); } catch(e) {}
    setIsLoggedIn(false);
    setUserEmail('');
    setLoginMethod('');
    setUserKey('');
    // 메모리 초기화 (다른 계정 데이터 노출 방지)
    setSavedSajuRaw([]);
    setSavedPaidSajuRaw([]);
    setSavedCompatibilityRaw([]);
    setSavedYearlyRaw([]);
    setPurchases([]);
    setCurrentResult(null);
    setCurrentInput(null);
    setScreen('home');
  };

  const openPayment = (product) => {
    if (!isLoggedIn) { setShowLogin(true); return; }
    setPaymentProduct(product);
    setShowPayment(true);
  };

  // ===== 토스페이먼츠 실결제 요청 =====
  const requestTossPayment = async (method) => {
    if (!paymentProduct) return;
    try {
      const tossPayments = window.TossPayments(TOSS_CLIENT_KEY);
      const orderId = `SAJUON_${Date.now()}_${Math.random().toString(36).slice(2, 7)}`;
      // 토스페이먼츠는 successUrl에 paymentKey, orderId, amount를 자동으로 붙여서 리다이렉트
      const baseUrl = window.location.origin + window.location.pathname;
      const successUrl = baseUrl + '?payment=success' + (window.location.hash ? '&hash=' + encodeURIComponent(window.location.hash.slice(1)) : '');
      const failUrl = baseUrl + '?payment=fail';

      // 결제 전 상태 저장 (리다이렉트 후 복원용)
      const pendingData = {
        product: paymentProduct,
        currentInput,
        currentResult,
        orderId,
        compatResult: (() => {
          const p1 = savedSaju.find(s => String(s.id) === String(compatPerson1));
          const p2 = savedSaju.find(s => String(s.id) === String(compatPerson2));
          if (!p1 || !p2) return null;
          return { id: Date.now(), person1Id: compatPerson1, person2Id: compatPerson2, person1Name: p1.name, person2Name: p2.name, relation: compatRelation, date: new Date().toLocaleDateString('ko-KR') };
        })(),
        yearlyResult: (() => {
          const p = savedSaju.find(s => String(s.id) === String(yearlyPerson));
          if (!p) return null;
          return { id: Date.now(), personId: yearlyPerson, personName: p.name, date: new Date().toLocaleDateString('ko-KR') };
        })()
      };
      sessionStorage.setItem('sajuon_pending_payment', JSON.stringify(pendingData));

      const methodMap = { '카카오페이': '카카오페이', '카드': '카드' };
      await tossPayments.requestPayment(methodMap[method] || '카드', {
        amount: paymentProduct.price,
        orderId,
        orderName: paymentProduct.name,
        customerName: userEmail || '사주ON 이용자',
        successUrl,
        failUrl,
      });
    } catch (err) {
      sessionStorage.removeItem('sajuon_pending_payment');
      if (err.code !== 'USER_CANCEL') {
        console.error('토스페이먼츠 오류:', err);
        alert(`결제 오류: ${err.message || '잠시 후 다시 시도해주세요.'}`);
      }
    }
  };

  const handlePaymentComplete = () => {
    const newPurchase = { 
      id: Date.now(),
      name: paymentProduct.name, 
      price: paymentProduct.price, 
      date: new Date().toLocaleDateString('ko-KR')
    };
    const updatedPurchases = [...purchases, newPurchase];
    setPurchases(updatedPurchases);
    if (userKey) saveUserData(userKey, 'purchases', updatedPurchases);
    setShowPayment(false);
    
    if (paymentProduct.name === '상세 사주 분석') {
      // 상세 사주 분석 결과 저장
      if (currentInput && currentResult) {
        const alreadySaved = savedPaidSaju.some(s => 
          s.name === currentInput.name && 
          s.year === currentInput.year && 
          s.month === currentInput.month && 
          s.day === currentInput.day
        );
        if (!alreadySaved) {
          setSavedPaidSaju(prev => [...prev, {
            id: Date.now(),
            name: currentInput.name,
            gender: currentInput.gender,
            year: currentInput.year,
            month: currentInput.month,
            day: currentInput.day,
            hour: currentInput.hour,
            minute: currentInput.minute,
            calendar: currentInput.calendar,
            result: currentResult,
            date: new Date().toLocaleDateString()
          }]);
        }
      }
      setScreen('paid-result');
    } else if (paymentProduct.name === '궁합 분석') {
      // 궁합 결과 저장
      const person1 = savedSaju.find(s => String(s.id) === String(compatPerson1));
      const person2 = savedSaju.find(s => String(s.id) === String(compatPerson2));
      if (person1 && person2) {
        const alreadySaved = savedCompatibility.some(c => 
          (c.person1Id === compatPerson1 && c.person2Id === compatPerson2 && c.relation === compatRelation) ||
          (c.person1Id === compatPerson2 && c.person2Id === compatPerson1 && c.relation === compatRelation)
        );
        if (!alreadySaved) {
          setSavedCompatibility(prev => [...prev, {
            id: Date.now(),
            person1Id: compatPerson1,
            person2Id: compatPerson2,
            person1Name: person1.name,
            person2Name: person2.name,
            relation: compatRelation,
            date: new Date().toLocaleDateString()
          }]);
        }
      }
      setScreen('compatibility-result');
    } else if (paymentProduct.name === '2026 신년운세') {
      // 신년운세 결과 저장
      const person = savedSaju.find(s => String(s.id) === String(yearlyPerson));
      if (person) {
        const alreadySaved = savedYearly.some(y => y.personId === yearlyPerson);
        if (!alreadySaved) {
          setSavedYearly(prev => [...prev, {
            id: Date.now(),
            personId: yearlyPerson,
            personName: person.name,
            date: new Date().toLocaleDateString()
          }]);
        }
      }
      setScreen('yearly-result');
    }
  };

  const startAnalysis = () => {
    if (!form.name || !form.year || !form.month || !form.day) {
      alert('이름과 생년월일을 입력해주세요.');
      return;
    }
    
    const year = parseInt(form.year);
    const month = parseInt(form.month);
    const day = parseInt(form.day);
    const hour = form.hour ? parseInt(form.hour) : null;
    const minute = form.minute ? parseInt(form.minute) : null;
    const isLunar = form.calendar === '음력';
    
    const result = analyzeSaju(year, month, day, hour, minute, isLunar, false);
    const inputData = { ...form, year, month, day, hour, minute, isLunar };
    
    setCurrentResult(result);
    setCurrentInput(inputData);
    
    // 로그인 상태면 자동 저장 (중복 체크)
    if (isLoggedIn) {
      const alreadySaved = savedSaju.some(s => 
        s.name === form.name && 
        s.year === year && 
        s.month === month && 
        s.day === day
      );
      if (!alreadySaved) {
        setSavedSaju(prev => [...prev, { id: Date.now(), ...inputData, result }]);
      }
    }
    
    // 결과 보기 직전 로그인 유도
    if (!isLoggedIn) {
      // 입력한 정보는 state에 저장해두고 로그인 후 결과 보여주기
      setShowLogin(true);
      return;
    }
    // returnScreen이 설정되어 있으면 해당 화면으로, 아니면 결과 화면으로
    if (returnScreen) {
      setScreen(returnScreen);
      setReturnScreen(null);
      setForm({ name:'', gender:'여성', calendar:'양력', year:'', month:'', day:'', hour:'', minute:'' });
    } else {
      setScreen('free-result');
    }
  };

  const formatTime = (hour, minute) => {
    if (hour === null || hour === undefined) return '';
    const h = parseInt(hour);
    const m = minute ? `:${minute}` : '';
    if (h < 12) return ` 오전 ${h}시${m}`;
    if (h === 12) return ` 오후 12시${m}`;
    return ` 오후 ${h-12}시${m}`;
  };

  // ========== 화면들 ==========
  const HomeScreen = () => (
    React.createElement('div', { className: 'min-h-screen pb-28' },
      // 히어로 섹션
      React.createElement('section', { className: 'relative text-center py-12 px-4 overflow-hidden' },
        React.createElement('div', { className: 'absolute inset-0 bg-gradient-to-b from-purple-900/30 to-transparent pointer-events-none' }),
        React.createElement('div', { className: 'relative z-10' },
          React.createElement('div', { className: 'text-5xl mb-4 animate-pulse' }, '🔮'),
          React.createElement('h1', { className: 'text-3xl font-bold mb-3 leading-tight' }, 
            '내 사주, 제대로',
            React.createElement('br'),
            React.createElement('span', { className: 'text-gradient' }, '깊이 있게 풀어드립니다')
          ),
          React.createElement('p', { className: 'text-gray-400 mb-2 text-sm' }, '전통 명리학 기반 · 만세력 정밀 계산'),
          React.createElement('p', { className: 'text-gray-500 mb-8 text-xs' }, '무료 사주부터 심층 분석까지'),
          React.createElement('button', { 
            onClick: () => { setForm({ name:'', gender:'여성', calendar:'양력', year:'', month:'', day:'', hour:'', minute:'' }); setScreen('input'); }, 
            className: 'px-8 py-4 gradient-primary rounded-2xl font-bold text-lg shadow-lg shadow-purple-500/30 hover:shadow-purple-500/50 transition-all active:scale-95' 
          }, '✨ 무료로 사주 보기')
        )
      ),
      // 서비스 카드
      React.createElement('section', { className: 'px-4 space-y-3' },
        React.createElement('h2', { className: 'text-sm font-bold text-gray-400 uppercase tracking-widest mb-4 text-center' }, '서비스'),
        // 무료 사주
        React.createElement('div', { 
          onClick: () => { setForm({ name:'', gender:'여성', calendar:'양력', year:'', month:'', day:'', hour:'', minute:'' }); setScreen('input'); }, 
          className: 'glass rounded-2xl p-5 cursor-pointer hover:bg-white/10 transition-all active:scale-[0.98] border border-green-500/20' 
        },
          React.createElement('div', { className: 'flex justify-between items-start' },
            React.createElement('div', null, 
              React.createElement('span', { className: 'text-2xl block mb-2' }, '🎁'),
              React.createElement('h3', { className: 'font-bold text-base' }, '기본 만세력'),
              React.createElement('p', { className: 'text-sm text-gray-400 mt-1' }, '사주 원국 + 오행 분석 + 신살 해설')
            ),
            React.createElement('div', { className: 'flex flex-col items-end gap-1' },
              React.createElement('span', { className: 'text-green-400 font-bold text-lg' }, '무료'),
              React.createElement('span', { className: 'text-xs text-gray-500 bg-green-500/10 px-2 py-0.5 rounded-full' }, '지금 시작')
            )
          )
        ),
        // 상세 사주 분석
        React.createElement('div', { 
          onClick: () => {
            if (!currentResult || !currentInput) { setForm({ name:'', gender:'여성', calendar:'양력', year:'', month:'', day:'', hour:'', minute:'' }); setScreen('input'); return; }
            const alreadyPaidHome = savedPaidSaju.some(p => p.name === currentInput.name && p.year === currentInput.year && p.month === currentInput.month && p.day === currentInput.day);
            if (alreadyPaidHome) {
              const paidHome = savedPaidSaju.find(p => p.name === currentInput.name && p.year === currentInput.year && p.month === currentInput.month && p.day === currentInput.day);
              if (paidHome) { setCurrentResult(paidHome.result); setCurrentInput({ name: paidHome.name, gender: paidHome.gender, year: paidHome.year, month: paidHome.month, day: paidHome.day, hour: paidHome.hour, minute: paidHome.minute, calendar: paidHome.calendar }); }
              setScreen('paid-result');
            } else { openPayment({ name: '상세 사주 분석', price: 1900 }); }
          }, 
          className: 'glass rounded-2xl p-5 cursor-pointer hover:bg-white/10 transition-all active:scale-[0.98] border-2 border-purple-500/40' 
        },
          React.createElement('div', { className: 'flex justify-between items-start' },
            React.createElement('div', null, 
              React.createElement('div', { className: 'flex items-center gap-2 mb-2' },
                React.createElement('span', { className: 'text-2xl' }, '💎'),
                React.createElement('span', { className: 'text-xs px-2 py-0.5 bg-purple-500/30 text-purple-300 rounded-full font-bold' }, 'PREMIUM')
              ),
              React.createElement('h3', { className: 'font-bold text-base' }, '상세 사주 분석'),
              React.createElement('p', { className: 'text-sm text-gray-400 mt-1' }, '8섹션 심층 해설 · 성격/직업/재물/연애')
            ),
            React.createElement('span', { className: 'text-purple-400 font-bold text-lg' }, '₩1,900')
          )
        ),
        // 궁합 분석
        React.createElement('div', { 
          onClick: () => setScreen('compatibility'), 
          className: 'glass rounded-2xl p-5 cursor-pointer hover:bg-white/10 transition-all active:scale-[0.98] border border-pink-500/20' 
        },
          React.createElement('div', { className: 'flex justify-between items-start' },
            React.createElement('div', null, 
              React.createElement('span', { className: 'text-2xl block mb-2' }, '💕'),
              React.createElement('h3', { className: 'font-bold text-base' }, '궁합 분석'),
              React.createElement('p', { className: 'text-sm text-gray-400 mt-1' }, '연인/친구/직장 등 관계별 맞춤 분석')
            ),
            React.createElement('span', { className: 'text-pink-400 font-bold text-lg' }, '₩990')
          )
        ),
        // 신년운세
        React.createElement('div', { 
          onClick: () => setScreen('yearly'), 
          className: 'glass rounded-2xl p-5 cursor-pointer hover:bg-white/10 transition-all active:scale-[0.98] border border-amber-500/20' 
        },
          React.createElement('div', { className: 'flex justify-between items-start' },
            React.createElement('div', null, 
              React.createElement('div', { className: 'flex items-center gap-2 mb-2' },
                React.createElement('span', { className: 'text-2xl' }, '🐴'),
                React.createElement('span', { className: 'text-xs px-2 py-0.5 bg-amber-500/20 text-amber-300 rounded-full' }, '2026 병오년')
              ),
              React.createElement('h3', { className: 'font-bold text-base' }, '신년운세'),
              React.createElement('p', { className: 'text-sm text-gray-400 mt-1' }, '월별 상세 운세 · 재물/연애/직장/건강')
            ),
            React.createElement('span', { className: 'text-amber-400 font-bold text-lg' }, '₩4,900')
          )
        )
      ),
      // 이용 통계 or 특장점
      React.createElement('section', { className: 'px-4 mt-6' },
        React.createElement('div', { className: 'glass rounded-2xl p-5' },
          React.createElement('h3', { className: 'text-sm font-bold text-gray-400 mb-4 text-center' }, '사주ON이 특별한 이유'),
          React.createElement('div', { className: 'grid grid-cols-3 gap-4 text-center' },
            React.createElement('div', null,
              React.createElement('p', { className: 'text-2xl font-bold text-purple-400' }, '정밀'),
              React.createElement('p', { className: 'text-xs text-gray-500 mt-1' }, '절기 정밀 계산')
            ),
            React.createElement('div', null,
              React.createElement('p', { className: 'text-2xl font-bold text-pink-400' }, '심층'),
              React.createElement('p', { className: 'text-xs text-gray-500 mt-1' }, '8개 섹션 분석')
            ),
            React.createElement('div', null,
              React.createElement('p', { className: 'text-2xl font-bold text-amber-400' }, '신살'),
              React.createElement('p', { className: 'text-xs text-gray-500 mt-1' }, '30+종 신살 포함')
            )
          )
        )
      ),
      // 하단 회사정보
      React.createElement('section', { className: 'px-4 mt-6 pb-4' },
        React.createElement('div', { className: 'text-center space-y-1' },
          React.createElement('div', { className: 'flex justify-center gap-4 text-xs text-gray-600' },
            React.createElement('span', { className: 'cursor-pointer hover:text-gray-400', onClick: () => setScreen('about') }, '회사소개'),
            React.createElement('span', null, '·'),
            React.createElement('span', { className: 'cursor-pointer hover:text-gray-400', onClick: () => setScreen('terms') }, '이용약관'),
            React.createElement('span', null, '·'),
            React.createElement('span', { className: 'cursor-pointer hover:text-gray-400', onClick: () => setScreen('privacy') }, '개인정보처리방침')
          ),
          React.createElement('p', { className: 'text-xs text-gray-700 mt-2' }, '사주ON · 대표 고승우 · 사업자 294-18-02476')
        )
      )
    )
  );

  const InputScreen = () => (
    React.createElement('div', { className: 'min-h-screen p-4 pb-28' },
      React.createElement('header', { className: 'flex items-center gap-4 py-4' },
        React.createElement('button', { onClick: () => setScreen('home'), className: 'text-2xl' }, '←'),
        React.createElement('h1', { className: 'text-xl font-bold' }, '사주 정보 입력')
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-6 mt-4 space-y-6' },
        React.createElement('div', null,
          React.createElement('label', { className: 'text-sm text-gray-400 block mb-2' }, '이름'),
          React.createElement('input', { 
            type: 'text', 
            placeholder: '이름을 입력하세요', 
            defaultValue: form.name,
            onBlur: e => setForm({...form, name: e.target.value}),
            onKeyDown: e => { if (e.key === 'Enter') e.target.blur(); },
            className: 'w-full px-4 py-3 bg-white/10 rounded-xl border border-white/20 focus:border-purple-500 outline-none' 
          })
        ),
        React.createElement('div', null,
          React.createElement('label', { className: 'text-sm text-gray-400 block mb-2' }, '성별'),
          React.createElement('div', { className: 'grid grid-cols-2 gap-3' },
            React.createElement('button', { onClick: () => setForm({...form, gender: '여성'}), className: `py-3 rounded-xl font-bold transition ${form.gender === '여성' ? 'bg-purple-500' : 'bg-white/10'}` }, '여성'),
            React.createElement('button', { onClick: () => setForm({...form, gender: '남성'}), className: `py-3 rounded-xl font-bold transition ${form.gender === '남성' ? 'bg-purple-500' : 'bg-white/10'}` }, '남성')
          )
        ),
        React.createElement('div', null,
          React.createElement('label', { className: 'text-sm text-gray-400 block mb-2' }, '달력'),
          React.createElement('div', { className: 'grid grid-cols-2 gap-3' },
            React.createElement('button', { onClick: () => setForm({...form, calendar: '양력'}), className: `py-3 rounded-xl font-bold transition ${form.calendar === '양력' ? 'bg-purple-500' : 'bg-white/10'}` }, '양력'),
            React.createElement('button', { onClick: () => setForm({...form, calendar: '음력'}), className: `py-3 rounded-xl font-bold transition ${form.calendar === '음력' ? 'bg-purple-500' : 'bg-white/10'}` }, '음력')
          )
        ),
        React.createElement('div', null,
          React.createElement('label', { className: 'text-sm text-gray-400 block mb-2' }, '생년월일'),
          React.createElement('div', { className: 'grid grid-cols-3 gap-3' },
            React.createElement('select', { 
              value: form.year, 
              onChange: e => setForm({...form, year: e.target.value}), 
              className: 'px-2 py-3 bg-[#2a2a4e] text-white rounded-xl border border-white/20 text-center appearance-none',
              style: { colorScheme: 'dark' }
            },
              React.createElement('option', { value: '', className: 'bg-[#2a2a4e] text-white' }, '년도'),
              Array.from({ length: 116 }, (_, i) => 2030 - i).map(y => 
                React.createElement('option', { key: y, value: y, className: 'bg-[#2a2a4e] text-white' }, `${y}년`)
              )
            ),
            React.createElement('select', { 
              value: form.month, 
              onChange: e => setForm({...form, month: e.target.value}), 
              className: 'px-2 py-3 bg-[#2a2a4e] text-white rounded-xl border border-white/20 text-center appearance-none',
              style: { colorScheme: 'dark' }
            },
              React.createElement('option', { value: '', className: 'bg-[#2a2a4e] text-white' }, '월'),
              Array.from({ length: 12 }, (_, i) => i + 1).map(m => 
                React.createElement('option', { key: m, value: m, className: 'bg-[#2a2a4e] text-white' }, `${m}월`)
              )
            ),
            React.createElement('select', { 
              value: form.day, 
              onChange: e => setForm({...form, day: e.target.value}), 
              className: 'px-2 py-3 bg-[#2a2a4e] text-white rounded-xl border border-white/20 text-center appearance-none',
              style: { colorScheme: 'dark' }
            },
              React.createElement('option', { value: '', className: 'bg-[#2a2a4e] text-white' }, '일'),
              Array.from({ length: 31 }, (_, i) => i + 1).map(d => 
                React.createElement('option', { key: d, value: d, className: 'bg-[#2a2a4e] text-white' }, `${d}일`)
              )
            )
          )
        ),
        React.createElement('div', null,
          React.createElement('label', { className: 'text-sm text-gray-400 block mb-2' }, '태어난 시간 (선택)'),
          React.createElement('div', { className: 'grid grid-cols-2 gap-3' },
            React.createElement('select', { 
              value: form.hour, 
              onChange: e => setForm({...form, hour: e.target.value}), 
              className: 'px-2 py-3 bg-[#2a2a4e] text-white rounded-xl border border-white/20 text-center appearance-none',
              style: { colorScheme: 'dark' }
            },
              React.createElement('option', { value: '', className: 'bg-[#2a2a4e] text-white' }, '시 (모름)'),
              Array.from({ length: 24 }, (_, i) => i).map(h => 
                React.createElement('option', { key: h, value: h, className: 'bg-[#2a2a4e] text-white' }, `${h}시`)
              )
            ),
            React.createElement('select', { 
              value: form.minute, 
              onChange: e => setForm({...form, minute: e.target.value}), 
              className: 'px-2 py-3 bg-[#2a2a4e] text-white rounded-xl border border-white/20 text-center appearance-none',
              style: { colorScheme: 'dark' }
            },
              React.createElement('option', { value: '', className: 'bg-[#2a2a4e] text-white' }, '분'),
              Array.from({ length: 60 }, (_, i) => i).map(m => 
                React.createElement('option', { key: m, value: m, className: 'bg-[#2a2a4e] text-white' }, `${m}분`)
              )
            )
          ),
          React.createElement('p', { className: 'text-xs text-gray-500 mt-2' }, '* 시간을 모르면 "시 (모름)"을 선택하세요')
        )
      ),
      React.createElement('button', { onClick: startAnalysis, className: 'w-full mt-6 py-4 gradient-primary rounded-2xl font-bold text-lg' }, '무료 사주 보기'),
      // 저장된 사주 목록 (궁합 페이지처럼)
      isLoggedIn && savedSaju.length > 0 && React.createElement('div', { className: 'mt-8' },
        React.createElement('div', { className: 'flex items-center justify-between mb-4' },
          React.createElement('h3', { className: 'font-bold flex items-center gap-2' },
            React.createElement('span', null, '👥'),
            '저장된 사주 목록',
            React.createElement('span', { className: 'text-xs text-gray-400 font-normal ml-1' }, `(${savedSaju.length}명)`)
          ),
          React.createElement('span', { className: 'text-xs text-purple-300' }, `💎 ${savedPaidSaju.length}명 구매`)
        ),
        React.createElement('div', { className: 'space-y-2' },
          savedSaju.map((s, i) => 
            React.createElement('div', { 
              key: i, 
              className: 'glass rounded-xl p-4 flex items-center justify-between hover:bg-white/10 cursor-pointer',
              onClick: () => {
                // 결제 여부 확인
                const paid = savedPaidSaju.find(p => p.name === s.name && p.year === s.year && p.month === s.month && p.day === s.day);
                const result = s.result || analyzeSaju(s.year, s.month, s.day, s.hour, s.minute, s.calendar === '음력', false);
                setCurrentInput({
                  name: s.name,
                  gender: s.gender,
                  year: s.year,
                  month: s.month,
                  day: s.day,
                  hour: s.hour,
                  minute: s.minute,
                  calendar: s.calendar
                });
                setCurrentResult(paid ? paid.result : result);
                setScreen(paid ? 'paid-result' : 'free-result');
              }
            },
              React.createElement('div', { className: 'flex items-center gap-3' },
                React.createElement('span', { className: 'text-2xl' }, s.gender === '여성' ? '👩' : '👨'),
                React.createElement('div', null,
                  React.createElement('p', { className: 'font-bold' }, s.name),
                  React.createElement('p', { className: 'text-xs text-gray-400' }, `${s.year}.${s.month}.${s.day} (${s.calendar})`)
                )
              ),
              React.createElement('div', { className: 'flex items-center gap-2' },
                (() => {
                  const isPaid = savedPaidSaju.some(p => p.name === s.name && p.year === s.year && p.month === s.month && p.day === s.day);
                  return isPaid
                    ? React.createElement('span', { className: 'px-2 py-0.5 bg-purple-500/30 border border-purple-500/50 text-purple-300 text-xs rounded-full font-medium' }, '💎 PREMIUM')
                    : React.createElement('span', { className: 'px-2 py-0.5 bg-white/10 text-gray-400 text-xs rounded-full' }, 'FREE');
                })(),
                React.createElement('button', { 
                  onClick: (e) => {
                    e.stopPropagation();
                    if (confirm(s.name + '님의 사주를 삭제하시겠습니까?')) {
                      setSavedSaju(savedSaju.filter((_, idx) => idx !== i));
                      setSavedPaidSaju(savedPaidSaju.filter(p => !(p.name === s.name && p.year === s.year && p.month === s.month && p.day === s.day)));
                    }
                  },
                  className: 'p-2 text-red-400 hover:bg-red-500/20 rounded-lg'
                }, '🗑️'),
                React.createElement('span', { className: 'text-gray-400' }, '→')
              )
            )
          )
        ),
        React.createElement('p', { className: 'text-xs text-gray-500 text-center mt-3' }, 
          '💡 💎 PREMIUM은 상세 해설을 바로 다시 볼 수 있습니다'
        )
      )
    )
  );

  const FreeResultScreen = () => {
    if (!currentResult || !currentInput) return React.createElement('div', { className: 'p-4 text-center text-gray-400' }, '데이터 없음');
    
    const r = currentResult;
    const inp = currentInput;
    const dayGan = STEMS.names[r.dsi];
    const dayGanKr = STEMS.korean[r.dsi];
    const dayEl = STEMS.elements[r.dsi];
    
    const order = ['hour','day','month','year'];
    const labels = { hour:'시주', day:'일주', month:'월주', year:'연주' };
    
    return React.createElement('div', { className: 'min-h-screen p-4 pb-28' },
      React.createElement('header', { className: 'flex items-center gap-4 py-4' },
        React.createElement('button', { onClick: () => setScreen('home'), className: 'text-2xl' }, '←'),
        React.createElement('h1', { className: 'text-xl font-bold' }, '사주 분석 결과')
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('div', { className: 'flex items-center gap-4' },
          React.createElement('div', { className: 'w-16 h-16 gradient-primary rounded-full flex items-center justify-center text-3xl' }, inp.gender === '여성' ? '👩' : '👨'),
          React.createElement('div', null,
            React.createElement('h2', { className: 'text-xl font-bold' }, `${inp.name}님`),
            React.createElement('p', { className: 'text-gray-400' }, `${inp.year}.${inp.month}.${inp.day}${formatTime(inp.hour, inp.minute)} (${inp.calendar})`),
            React.createElement('p', { className: 'text-purple-400 text-sm' }, `일간: ${dayGan}${dayEl.toUpperCase()} (${dayGanKr}${dayEl})`)
          )
        )
      ),
      React.createElement('div', { className: 'glass rounded-2xl overflow-hidden mt-4' },
        React.createElement('div', { className: 'p-3 gradient-primary text-white text-center font-bold' }, '만세력'),
        React.createElement('div', { className: 'p-4' },
          React.createElement('div', { className: 'grid grid-cols-4 gap-2 text-center mb-2' },
            order.map(k => React.createElement('div', { key: k, className: 'text-xs text-gray-400' }, labels[k]))
          ),
          // 천간
          React.createElement('div', { className: 'grid grid-cols-4 gap-2 text-center mb-2' },
            order.map(k => {
              const pl = r.pillars[k];
              if (!pl) return React.createElement('div', { key: 'stem-'+k, className: 'py-3 bg-gray-700/50 rounded-lg text-gray-500 text-center' }, '-');
              const el = STEMS.elements[pl.si];
              return React.createElement('div', { 
                key: 'stem-'+k, 
                className: 'py-2 rounded-lg text-white font-bold flex flex-col items-center justify-center',
                style: { backgroundColor: COLORS[el] }
              },
                React.createElement('span', { className: 'text-xl' }, pl.stem),
                React.createElement('span', { className: 'text-xs opacity-80' }, STEMS.korean[pl.si])
              );
            })
          ),
          // 지지
          React.createElement('div', { className: 'grid grid-cols-4 gap-2 text-center' },
            order.map(k => {
              const pl = r.pillars[k];
              if (!pl) return React.createElement('div', { key: 'branch-'+k, className: 'py-3 bg-gray-700/50 rounded-lg text-gray-500 text-center' }, '-');
              const el = BRANCHES.elements[pl.bi];
              return React.createElement('div', { 
                key: 'branch-'+k, 
                className: 'py-2 rounded-lg text-white font-bold flex flex-col items-center justify-center',
                style: { backgroundColor: COLORS[el] }
              },
                React.createElement('span', { className: 'text-xl' }, pl.branch),
                React.createElement('span', { className: 'text-xs opacity-80' }, BRANCHES.korean[pl.bi])
              );
            })
          )
        ),
        React.createElement('div', { className: 'px-4 py-2 bg-white/5 text-center text-xs text-gray-400' }, '* 상세 신살 정보는 유료 분석에서 확인하세요')
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('h3', { className: 'font-bold mb-3' }, '✨ 사주 요약'),
        React.createElement('p', { className: 'text-gray-300 leading-relaxed text-sm' },
          `${inp.name}님은 ${dayGan}${dayEl.toUpperCase()}(${dayGanKr}${dayEl}) 일간으로 태어났습니다. 오행 분포를 보면 ${r.fe.gishin}(${r.fe.pct[r.fe.gishin]}%)이 가장 강하고, ${r.fe.yongshin}(${r.fe.pct[r.fe.yongshin]}%)이 가장 약합니다. ${r.fe.gishin === '목' ? '성장과 발전을 추구하는 기질이 강하며' : r.fe.gishin === '화' ? '열정적이고 표현력이 뛰어나며' : r.fe.gishin === '토' ? '안정적이고 신뢰감을 주며' : r.fe.gishin === '금' ? '결단력과 추진력이 있으며' : '지혜롭고 깊이 있는 사고를 하며'}, ${r.fe.yongshin === '수' ? '때로는 여유와 휴식이 필요합니다' : r.fe.yongshin === '화' ? '좀 더 적극적인 표현이 도움이 됩니다' : r.fe.yongshin === '목' ? '새로운 시작에 대한 용기가 필요합니다' : r.fe.yongshin === '금' ? '결단력을 기르면 좋습니다' : '현실적인 안정감을 추구해보세요'}. 전체적으로 균형 잡힌 에너지 흐름을 가지고 있습니다.`
        )
      ),
      (() => {
        const alreadyPaid = inp && savedPaidSaju.some(p => p.name === inp.name && p.year === inp.year && p.month === inp.month && p.day === inp.day);
        if (alreadyPaid) {
          return React.createElement('button', {
            onClick: () => {
              const paidData = savedPaidSaju.find(p => p.name === inp.name && p.year === inp.year && p.month === inp.month && p.day === inp.day);
              if (paidData) {
                setCurrentResult(paidData.result);
                setCurrentInput({ name: paidData.name, gender: paidData.gender, year: paidData.year, month: paidData.month, day: paidData.day, hour: paidData.hour, minute: paidData.minute, calendar: paidData.calendar });
              }
              setScreen('paid-result');
            },
            className: 'mt-6 w-full p-5 bg-gradient-to-r from-purple-600 to-purple-800 rounded-2xl'
          },
            React.createElement('div', { className: 'flex justify-between items-center' },
              React.createElement('div', null,
                React.createElement('p', { className: 'text-xs text-purple-300 mb-1' }, '💎 구매완료'),
                React.createElement('h3', { className: 'font-bold text-lg' }, '상세 분석 다시 보기')
              ),
              React.createElement('span', { className: 'text-2xl' }, '→')
            )
          );
        }
        return React.createElement('div', { onClick: () => openPayment({ name: '상세 사주 분석', price: 1900 }), className: 'mt-6 p-5 gradient-gold rounded-2xl cursor-pointer' },
          React.createElement('div', { className: 'flex justify-between items-center' },
            React.createElement('div', null,
              React.createElement('h3', { className: 'font-bold text-lg' }, '💎 더 깊은 분석이 궁금하다면?'),
              React.createElement('p', { className: 'text-sm text-white/80 mt-1' }, '8개 섹션 심층 해설 + 신살 분석')
            ),
            React.createElement('div', { className: 'text-right' },
              React.createElement('span', { className: 'text-2xl font-bold' }, '₩1,900')
            )
          )
        );
      })()
    );
  };

  const PaidResultScreen = () => {
    if (!currentResult || !currentInput) return React.createElement('div', { className: 'p-4 text-center text-gray-400' }, '데이터 없음');
    
    const r = currentResult;
    const inp = currentInput;
    const dayGan = STEMS.names[r.dsi];
    const dayGanKr = STEMS.korean[r.dsi];
    const dayEl = STEMS.elements[r.dsi];
    
    const order = ['hour','day','month','year'];
    const labels = { hour:'시주', day:'일주', month:'월주', year:'연주' };
    
    const allSinsal = [...r.pillarSinsal.year, ...r.pillarSinsal.month, ...r.pillarSinsal.day, ...r.pillarSinsal.hour].filter((v, i, a) => a.indexOf(v) === i);

    return React.createElement('div', { className: 'min-h-screen p-4 pb-28' },
      React.createElement('header', { className: 'flex items-center gap-4 py-4' },
        React.createElement('button', { onClick: () => setScreen('input'), className: 'text-2xl' }, '←'),
        React.createElement('h1', { className: 'text-xl font-bold' }, '상세 사주 분석'),
        React.createElement('span', { className: 'ml-auto px-3 py-1 bg-purple-500 rounded-full text-xs' }, 'PREMIUM')
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('div', { className: 'flex items-center gap-4' },
          React.createElement('div', { className: 'w-16 h-16 gradient-primary rounded-full flex items-center justify-center text-3xl' }, inp.gender === '여성' ? '👩' : '👨'),
          React.createElement('div', null,
            React.createElement('h2', { className: 'text-xl font-bold' }, `${inp.name}님`),
            React.createElement('p', { className: 'text-gray-400' }, `${inp.year}.${inp.month}.${inp.day}${formatTime(inp.hour, inp.minute)} (${inp.calendar})`)
          )
        )
      ),
      React.createElement('div', { className: 'glass rounded-2xl overflow-hidden mt-4' },
        React.createElement('div', { className: 'p-3 gradient-primary text-white text-center font-bold' }, '만세력'),
        React.createElement('div', { className: 'p-4' },
          // 라벨
          React.createElement('div', { className: 'grid grid-cols-4 gap-2 text-center mb-2' },
            order.map(k => React.createElement('div', { key: k, className: 'text-xs text-gray-400' }, labels[k]))
          ),
          // 천간
          React.createElement('div', { className: 'grid grid-cols-4 gap-2 text-center mb-1' },
            order.map(k => {
              const pl = r.pillars[k];
              if (!pl) return React.createElement('div', { key: 'stem-'+k, className: 'py-3 bg-gray-700/50 rounded-lg text-gray-500 text-center' }, '-');
              const el = STEMS.elements[pl.si];
              return React.createElement('div', { 
                key: 'stem-'+k, 
                className: 'py-2 rounded-lg text-white font-bold flex flex-col items-center justify-center',
                style: { backgroundColor: COLORS[el] }
              },
                React.createElement('span', { className: 'text-xl' }, pl.stem),
                React.createElement('span', { className: 'text-xs opacity-80' }, STEMS.korean[pl.si])
              );
            })
          ),
          // 십신
          React.createElement('div', { className: 'grid grid-cols-4 gap-2 text-center mb-2 bg-purple-500/10 rounded-lg py-1' },
            order.map(k => {
              const pl = r.pillars[k];
              if (!pl) return React.createElement('div', { key: 'god-'+k, className: 'text-xs text-gray-500' }, '-');
              return React.createElement('div', { key: 'god-'+k, className: 'text-xs text-purple-300 font-medium' }, 
                k === 'day' ? '일간' : getTenGod(r.dsi, pl.si)
              );
            })
          ),
          // 지지
          React.createElement('div', { className: 'grid grid-cols-4 gap-2 text-center mb-1' },
            order.map(k => {
              const pl = r.pillars[k];
              if (!pl) return React.createElement('div', { key: 'branch-'+k, className: 'py-3 bg-gray-700/50 rounded-lg text-gray-500 text-center' }, '-');
              const el = BRANCHES.elements[pl.bi];
              return React.createElement('div', { 
                key: 'branch-'+k, 
                className: 'py-2 rounded-lg text-white font-bold flex flex-col items-center justify-center',
                style: { backgroundColor: COLORS[el] }
              },
                React.createElement('span', { className: 'text-xl' }, pl.branch),
                React.createElement('span', { className: 'text-xs opacity-80' }, BRANCHES.korean[pl.bi])
              );
            })
          ),
          // 지장간
          React.createElement('div', { className: 'grid grid-cols-4 gap-2 text-center mb-2 bg-amber-500/10 rounded-lg py-1' },
            order.map(k => {
              const pl = r.pillars[k];
              const jjg = pl ? JIJANGGAN[pl.branch] : '-';
              return React.createElement('div', { key: 'jjg-'+k, className: 'text-xs text-amber-300' }, jjg || '-');
            })
          ),
          // 십이운성
          React.createElement('div', { className: 'grid grid-cols-4 gap-2 text-center mb-1 bg-emerald-500/10 rounded-lg py-1' },
            order.map(k => {
              const pl = r.pillars[k];
              if (!pl) return React.createElement('div', { key: '12-'+k, className: 'text-xs text-gray-500' }, '-');
              return React.createElement('div', { key: '12-'+k, className: 'text-xs text-emerald-300' }, getTwelve(dayGan, pl.bi));
            })
          ),
          // 12신살
          React.createElement('div', { className: 'grid grid-cols-4 gap-2 text-center mb-2 bg-rose-500/10 rounded-lg py-1' },
            order.map(k => React.createElement('div', { key: 'sinsal-'+k, className: 'text-xs text-rose-300' }, r.sinsal12[k] || '-'))
          ),
          // 추가 신살 (주별)
          React.createElement('div', { className: 'grid grid-cols-4 gap-2 text-center bg-indigo-500/10 rounded-lg py-2' },
            order.map(k => {
              const ps = r.pillarSinsal[k] || [];
              return React.createElement('div', { key: 'ps-'+k, className: 'text-xs' },
                ps.length > 0 
                  ? ps.map((s, i) => React.createElement('div', { key: i, className: 'text-indigo-300' }, s))
                  : React.createElement('span', { className: 'text-gray-500' }, '-')
              );
            })
          )
        ),
        // 공망
        React.createElement('div', { className: 'px-4 py-2 bg-white/5 text-center text-xs text-gray-400' }, 
          `공망: ${r.gm[0]}(${BRANCHES.korean[BRANCHES.names.indexOf(r.gm[0])]}) ${r.gm[1]}(${BRANCHES.korean[BRANCHES.names.indexOf(r.gm[1])]})`
        ),
        // 관계 신살
        r.extraSinsal.length > 0 && React.createElement('div', { className: 'px-4 py-3 bg-pink-500/10' },
          React.createElement('div', { className: 'flex flex-wrap justify-center gap-1' },
            r.extraSinsal.map((s, i) => React.createElement('span', { key: i, className: 'px-2 py-0.5 bg-pink-500/30 text-pink-300 rounded-full text-xs' }, s))
          )
        )
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('h3', { className: 'font-bold mb-4' }, '🔥 오행 분포'),
        React.createElement('div', { className: 'space-y-2' },
          ['목','화','토','금','수'].map(el =>
            React.createElement('div', { key: el, className: 'flex items-center gap-3' },
              React.createElement('span', { className: 'w-12 text-sm' }, `${el}(${el === '목' ? '木' : el === '화' ? '火' : el === '토' ? '土' : el === '금' ? '金' : '水'})`),
              React.createElement('div', { className: 'flex-1 h-3 bg-white/10 rounded-full overflow-hidden' },
                React.createElement('div', { style: { width: `${r.fe.pct[el]}%`, backgroundColor: COLORS[el] }, className: 'h-full' })
              ),
              React.createElement('span', { className: 'w-10 text-right text-sm' }, `${r.fe.pct[el]}%`)
            )
          )
        )
      ),
      // 12개 섹션 심층 해설
      React.createElement('div', { className: 'glass rounded-2xl overflow-hidden mt-4' },
        React.createElement('div', { className: 'p-3 gradient-primary text-white text-center font-bold' }, '사주 해설'),
        React.createElement('div', { className: 'p-3 text-center text-gray-400 text-xs border-b border-white/10' }, '각 제목을 클릭하면 해설이 펼쳐져요'),
        generateSajuInterpretation(r, inp).map((section, i) => 
          React.createElement(AccordionItem, { key: i, icon: section.icon, color: section.color, title: section.title, content: section.content })
        )
      )
    );
  };

  const CompatibilityScreen = () => React.createElement('div', { className: 'min-h-screen p-4 pb-28' },
    React.createElement('header', { className: 'flex items-center gap-4 py-4' },
      React.createElement('button', { onClick: () => setScreen('home'), className: 'text-2xl' }, '←'),
      React.createElement('h1', { className: 'text-xl font-bold' }, '💕 궁합 분석')
    ),
    React.createElement('p', { className: 'text-gray-400 text-center mt-4' }, '두 사람의 사주로 궁합을 분석합니다'),
    !isLoggedIn && React.createElement('div', { className: 'glass rounded-2xl p-5 mt-6 text-center' },
      React.createElement('p', { className: 'text-gray-400 mb-3' }, '궁합 분석을 위해 로그인이 필요합니다'),
      React.createElement('button', { onClick: () => setShowLogin(true), className: 'px-6 py-2 gradient-primary rounded-xl font-bold' }, '로그인하기')
    ),
    isLoggedIn && savedSaju.length < 2 && React.createElement('div', { className: 'glass rounded-2xl p-5 mt-6 text-center' },
      React.createElement('p', { className: 'text-gray-400 mb-3' }, '궁합 분석을 위해 최소 2명의 사주가 필요합니다'),
      React.createElement('p', { className: 'text-sm text-gray-500 mb-3' }, `현재 저장된 사주: ${savedSaju.length}명`),
      React.createElement('button', { onClick: () => { setForm({ name:'', gender:'여성', calendar:'양력', year:'', month:'', day:'', hour:'', minute:'' }); setReturnScreen('compatibility'); setScreen('input'); }, className: 'px-6 py-2 gradient-primary rounded-xl font-bold' }, '사주 추가하기')
    ),
    isLoggedIn && savedSaju.length >= 2 && React.createElement(React.Fragment, null,
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-6' },
        React.createElement('div', { className: 'flex items-center gap-3 mb-4' },
          React.createElement('div', { className: 'w-12 h-12 bg-purple-500/30 rounded-full flex items-center justify-center text-xl font-bold' }, 'A'),
          React.createElement('span', { className: 'font-bold' }, '첫 번째 사람')
        ),
        React.createElement('select', { 
          value: compatPerson1,
          onChange: e => setCompatPerson1(e.target.value),
          className: 'w-full px-4 py-3 bg-[#2a2a4e] text-white rounded-xl border border-white/20',
          style: { colorScheme: 'dark' }
        },
          React.createElement('option', { value: '', className: 'bg-[#2a2a4e]' }, '선택하세요'),
          savedSaju.map((s, i) => React.createElement('option', { key: i, value: s.id, className: 'bg-[#2a2a4e]' }, `${s.name} (${s.year}.${s.month}.${s.day})`))
        )
      ),
      React.createElement('div', { className: 'text-center my-4 text-3xl' }, '❤️'),
      React.createElement('div', { className: 'glass rounded-2xl p-5' },
        React.createElement('div', { className: 'flex items-center gap-3 mb-4' },
          React.createElement('div', { className: 'w-12 h-12 bg-cyan-500/30 rounded-full flex items-center justify-center text-xl font-bold' }, 'B'),
          React.createElement('span', { className: 'font-bold' }, '두 번째 사람')
        ),
        React.createElement('select', { 
          value: compatPerson2,
          onChange: e => setCompatPerson2(e.target.value),
          className: 'w-full px-4 py-3 bg-[#2a2a4e] text-white rounded-xl border border-white/20',
          style: { colorScheme: 'dark' }
        },
          React.createElement('option', { value: '', className: 'bg-[#2a2a4e]' }, '선택하세요'),
          savedSaju.map((s, i) => React.createElement('option', { key: i, value: s.id, className: 'bg-[#2a2a4e]' }, `${s.name} (${s.year}.${s.month}.${s.day})`))
        )
      ),
      // 관계 유형 선택
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('div', { className: 'flex items-center gap-3 mb-4' },
          React.createElement('span', { className: 'text-xl' }, '🔗'),
          React.createElement('span', { className: 'font-bold' }, 'A와 B의 관계는?')
        ),
        React.createElement('div', { className: 'grid grid-cols-2 gap-2' },
          [
            { value: 'couple', label: '연인/배우자', icon: '💑' },
            { value: 'parent', label: '부모-자녀', icon: '👨‍👧' },
            { value: 'sibling', label: '형제/자매', icon: '👫' },
            { value: 'friend', label: '친구', icon: '🤝' },
            { value: 'business', label: '직장/비즈니스', icon: '💼' },
            { value: 'etc', label: '기타', icon: '👥' }
          ].map(rel => 
            React.createElement('button', {
              key: rel.value,
              onClick: () => setCompatRelation(rel.value),
              className: `p-3 rounded-xl text-sm font-medium transition-all ${compatRelation === rel.value ? 'bg-purple-500 text-white' : 'bg-white/5 text-gray-300 hover:bg-white/10'}`
            },
              React.createElement('span', { className: 'mr-2' }, rel.icon),
              rel.label
            )
          )
        )
      ),
      React.createElement('button', { 
        onClick: () => {
          if (!compatPerson1 || !compatPerson2) {
            alert('두 사람을 모두 선택해주세요.');
            return;
          }
          if (compatPerson1 === compatPerson2) {
            alert('서로 다른 사람을 선택해주세요.');
            return;
          }
          if (!compatRelation) {
            alert('두 사람의 관계를 선택해주세요.');
            return;
          }
          openPayment({ name: '궁합 분석', price: 990 });
        }, 
        className: 'w-full mt-6 py-4 gradient-gold rounded-2xl font-bold text-lg' 
      }, '궁합 분석하기 ₩990'),
      React.createElement('button', { 
        onClick: () => { setForm({ name:'', gender:'여성', calendar:'양력', year:'', month:'', day:'', hour:'', minute:'' }); setReturnScreen('compatibility'); setScreen('input'); }, 
        className: 'w-full mt-3 py-3 glass rounded-xl text-gray-400 text-sm' 
      }, '+ 새 사주 추가하기')
    ),
    // 이전 궁합 결과
    isLoggedIn && savedCompatibility.length > 0 && React.createElement('div', { className: 'glass rounded-2xl p-5 mt-6' },
      React.createElement('h3', { className: 'font-bold mb-4 flex items-center gap-2' }, 
        React.createElement('span', null, '📋'),
        '이전 궁합 결과'
      ),
      React.createElement('div', { className: 'space-y-2' },
        savedCompatibility.map((compat, i) => {
          const relationLabels = { couple: '연인', parent: '부모-자녀', sibling: '형제', friend: '친구', business: '직장', etc: '기타' };
          const relationIcons = { couple: '💑', parent: '👨‍👧', sibling: '👫', friend: '🤝', business: '💼', etc: '👥' };
          return React.createElement('div', { 
            key: i, 
            onClick: () => {
              setCompatPerson1(compat.person1Id);
              setCompatPerson2(compat.person2Id);
              setCompatRelation(compat.relation || 'couple');
              setScreen('compatibility-result');
            },
            className: 'flex items-center justify-between p-3 bg-white/5 rounded-xl cursor-pointer hover:bg-white/10 transition-all' 
          },
            React.createElement('div', { className: 'flex items-center gap-3' },
              React.createElement('span', { className: 'text-lg' }, relationIcons[compat.relation] || '💕'),
              React.createElement('div', null,
                React.createElement('p', { className: 'font-medium' }, `${compat.person1Name} & ${compat.person2Name}`),
                React.createElement('p', { className: 'text-xs text-gray-500' }, `${relationLabels[compat.relation] || '관계'} · ${compat.date}`)
              )
            ),
            React.createElement('span', { className: 'text-gray-400 text-sm' }, '다시보기 →')
          );
        })
      )
    )
  );

  // 궁합 결과 화면
  const CompatibilityResultScreen = () => {
    const person1 = savedSaju.find(s => String(s.id) === String(compatPerson1));
    const person2 = savedSaju.find(s => String(s.id) === String(compatPerson2));
    
    if (!person1 || !person2) return React.createElement('div', { className: 'p-4 text-center text-gray-400' }, '데이터 없음');
    
    const r1 = person1.result || analyzeSaju(person1.year, person1.month, person1.day, person1.hour, person1.minute, person1.isLunar, false);
    const r2 = person2.result || analyzeSaju(person2.year, person2.month, person2.day, person2.hour, person2.minute, person2.isLunar, false);
    
    // 오행 궁합 점수 계산
    const el1 = STEMS.elements[r1.dsi];
    const el2 = STEMS.elements[r2.dsi];
    const compatMap = {
      '목목': 70, '목화': 90, '목토': 50, '목금': 40, '목수': 85,
      '화목': 90, '화화': 65, '화토': 85, '화금': 45, '화수': 35,
      '토목': 50, '토화': 85, '토토': 70, '토금': 80, '토수': 55,
      '금목': 40, '금화': 45, '금토': 80, '금금': 65, '금수': 90,
      '수목': 85, '수화': 35, '수토': 55, '수금': 90, '수수': 70
    };
    const baseScore = compatMap[el1 + el2] || 60;
    const stemBonus = ((r1.dsi + r2.dsi) % 5) * 2;
    const branchBonus = r1.pillars.day && r2.pillars.day ? ((r1.pillars.day.bi + r2.pillars.day.bi) % 6) : 3;
    
    // 관계 유형별 가중치 (같은 두 사람도 관계에 따라 다른 결과)
    const relationModifiers = {
      couple: { base: 0, loveMult: 1.15, commMult: 1.1, moneyMult: 0.95, valuesMult: 1.05, personalityMult: 1.1 },
      parent: { base: -3, loveMult: 0.7, commMult: 1.2, moneyMult: 1.0, valuesMult: 1.15, personalityMult: 1.05 },
      sibling: { base: -2, loveMult: 0.6, commMult: 1.1, moneyMult: 1.05, valuesMult: 1.0, personalityMult: 1.0 },
      friend: { base: 2, loveMult: 0.8, commMult: 1.15, moneyMult: 0.9, valuesMult: 1.1, personalityMult: 1.05 },
      business: { base: -5, loveMult: 0.5, commMult: 1.2, moneyMult: 1.25, valuesMult: 1.2, personalityMult: 0.95 },
      etc: { base: 0, loveMult: 1.0, commMult: 1.0, moneyMult: 1.0, valuesMult: 1.0, personalityMult: 1.0 }
    };
    const rm = relationModifiers[compatRelation] || relationModifiers.etc;
    const totalScore = Math.min(100, Math.max(30, Math.round(baseScore + stemBonus + branchBonus + rm.base)));
    
    // 지지 관계 분석
    const br1 = r1.pillars.day ? BRANCHES.names[r1.pillars.day.bi] : null;
    const br2 = r2.pillars.day ? BRANCHES.names[r2.pillars.day.bi] : null;
    
    const YUKAP = {'子丑':true,'丑子':true,'寅亥':true,'亥寅':true,'卯戌':true,'戌卯':true,'辰酉':true,'酉辰':true,'巳申':true,'申巳':true,'午未':true,'未午':true};
    const CHUNG = {'子午':true,'午子':true,'丑未':true,'未丑':true,'寅申':true,'申寅':true,'卯酉':true,'酉卯':true,'辰戌':true,'戌辰':true,'巳亥':true,'亥巳':true};
    const SAMHAP = {
      '寅午戌':'화', '申子辰':'수', '巳酉丑':'금', '亥卯未':'목'
    };
    
    const hasYukhap = br1 && br2 && YUKAP[br1+br2];
    const hasChung = br1 && br2 && CHUNG[br1+br2];
    
    // 천간합 체크
    const CHUNGAN_HAP = {'甲己':true,'己甲':true,'乙庚':true,'庚乙':true,'丙辛':true,'辛丙':true,'丁壬':true,'壬丁':true,'戊癸':true,'癸戊':true};
    const stem1 = STEMS.names[r1.dsi];
    const stem2 = STEMS.names[r2.dsi];
    const hasStemHap = CHUNGAN_HAP[stem1+stem2];
    
    // 분야별 궁합 점수 계산 (관계 유형 반영)
    const categoryScores = {
      personality: Math.min(95, Math.round((baseScore + (r1.dsi % 3) * 5 + (r2.dsi % 4) * 3) * rm.personalityMult)),
      communication: Math.min(95, Math.round((baseScore + ((r1.dsi + r2.dsi) % 5) * 4 + (hasYukhap ? 10 : 0)) * rm.commMult)),
      love: Math.min(95, Math.round((baseScore + stemBonus + (hasStemHap ? 12 : 0) + (hasChung ? -8 : 0)) * rm.loveMult)),
      money: Math.min(95, Math.round((55 + (r1.fe.pct['금'] + r2.fe.pct['금']) / 4 + ((r1.dsi + r2.dsi) % 6) * 3) * rm.moneyMult)),
      values: Math.min(95, Math.round((baseScore + branchBonus + (el1 === el2 ? 8 : 0)) * rm.valuesMult))
    };
    
    // 상생/상극 관계
    const SANGSAENG = {'목화':true,'화토':true,'토금':true,'금수':true,'수목':true};
    const SANGGEUK = {'목토':true,'토수':true,'수화':true,'화금':true,'금목':true};
    const isSangsaeng = SANGSAENG[el1+el2] || SANGSAENG[el2+el1];
    const isSanggeuk = SANGGEUK[el1+el2] || SANGGEUK[el2+el1];
    
    // ========== 추가 변수들 (내용 다양화용) ==========
    // 연주/월주 지지 관계
    const yearBr1 = r1.pillars.year ? BRANCHES.names[r1.pillars.year.bi] : null;
    const yearBr2 = r2.pillars.year ? BRANCHES.names[r2.pillars.year.bi] : null;
    const monthBr1 = r1.pillars.month ? BRANCHES.names[r1.pillars.month.bi] : null;
    const monthBr2 = r2.pillars.month ? BRANCHES.names[r2.pillars.month.bi] : null;
    
    // 연주/월주 육합/충 체크
    const hasYearYukhap = yearBr1 && yearBr2 && YUKAP[yearBr1+yearBr2];
    const hasYearChung = yearBr1 && yearBr2 && CHUNG[yearBr1+yearBr2];
    const hasMonthYukhap = monthBr1 && monthBr2 && YUKAP[monthBr1+monthBr2];
    const hasMonthChung = monthBr1 && monthBr2 && CHUNG[monthBr1+monthBr2];
    
    // 월주 천간 관계
    const monthStem1 = r1.pillars.month ? STEMS.names[r1.pillars.month.si] : null;
    const monthStem2 = r2.pillars.month ? STEMS.names[r2.pillars.month.si] : null;
    const hasMonthStemHap = monthStem1 && monthStem2 && CHUNGAN_HAP[monthStem1+monthStem2];
    
    // 용신/기신 호환성
    const yongshin1 = r1.fe.yongshin;
    const yongshin2 = r2.fe.yongshin;
    const gishin1 = r1.fe.gishin;
    const gishin2 = r2.fe.gishin;
    const yongshinMatch = yongshin1 === yongshin2;
    const yongshinComplement = yongshin1 === gishin2 || yongshin2 === gishin1; // 서로 보완
    
    // 오행 분포 유사도
    const elDiff = Math.abs(r1.fe.pct['목'] - r2.fe.pct['목']) + 
                   Math.abs(r1.fe.pct['화'] - r2.fe.pct['화']) + 
                   Math.abs(r1.fe.pct['토'] - r2.fe.pct['토']) + 
                   Math.abs(r1.fe.pct['금'] - r2.fe.pct['금']) + 
                   Math.abs(r1.fe.pct['수'] - r2.fe.pct['수']);
    const isSimilarBalance = elDiff < 60; // 오행 분포가 비슷함
    const isOppositeBalance = elDiff > 120; // 오행 분포가 상반됨
    
    // 띠 관계 (연지 기준)
    const zodiac1 = yearBr1 ? BRANCHES.korean[BRANCHES.names.indexOf(yearBr1)] : '';
    const zodiac2 = yearBr2 ? BRANCHES.korean[BRANCHES.names.indexOf(yearBr2)] : '';
    
    // 나이 차이
    const ageDiff = Math.abs(parseInt(person1.year) - parseInt(person2.year));
    const isSmallAgeDiff = ageDiff <= 3;
    const isMediumAgeDiff = ageDiff > 3 && ageDiff <= 8;
    const isLargeAgeDiff = ageDiff > 8;
    
    // 점수 등급
    const scoreGrade = totalScore >= 85 ? 'S' : totalScore >= 75 ? 'A' : totalScore >= 65 ? 'B' : totalScore >= 55 ? 'C' : 'D';
    
    // 신살 배열
    const allSinsal1 = [...(r1.pillarSinsal?.year || []), ...(r1.pillarSinsal?.month || []), ...(r1.pillarSinsal?.day || []), ...(r1.pillarSinsal?.hour || [])].filter((v, i, a) => a.indexOf(v) === i);
    const allSinsal2 = [...(r2.pillarSinsal?.year || []), ...(r2.pillarSinsal?.month || []), ...(r2.pillarSinsal?.day || []), ...(r2.pillarSinsal?.hour || [])].filter((v, i, a) => a.indexOf(v) === i);
    
    // 합/충 카운트
    const hapCount = (hasStemHap ? 1 : 0) + (hasYukhap ? 1 : 0) + (hasYearYukhap ? 1 : 0) + (hasMonthYukhap ? 1 : 0) + (hasMonthStemHap ? 1 : 0);
    const chungCount = (hasChung ? 1 : 0) + (hasYearChung ? 1 : 0) + (hasMonthChung ? 1 : 0);
    
    // 성별 조합
    const genderCombo = `${person1.gender}-${person2.gender}`;
    const isSameGender = person1.gender === person2.gender;
    
    // 고유 시드값 (두 사람의 조합으로 일관된 랜덤성 부여)
    const seed = (r1.dsi * 10 + r2.dsi) + (r1.pillars.day?.bi || 0) * 12 + (r2.pillars.day?.bi || 0);
    const variation = seed % 5; // 0~4의 변형 값
    
    // 관계 특성 텍스트
    const getRelationText = () => {
      if (hasStemHap && hasYukhap) return '천간합과 육합이 모두 있어 천생연분의 인연입니다!';
      if (hasStemHap) return '천간합이 있어 서로에게 끌리는 매력적인 관계입니다.';
      if (hasYukhap) return '육합이 있어 자연스럽게 조화를 이루는 관계입니다.';
      if (hasChung) return '충(冲) 관계로 처음에는 갈등이 있지만, 이를 극복하면 더 강한 유대가 됩니다.';
      if (isSangsaeng) return '상생 관계로 서로에게 긍정적인 에너지를 줍니다.';
      if (isSanggeuk) return '상극 관계로 서로 다른 점이 있지만, 이해하면 보완이 됩니다.';
      return '중립적인 관계로 서로의 노력에 따라 좋은 관계가 될 수 있습니다.';
    };
    
    return React.createElement('div', { className: 'min-h-screen p-4 pb-28' },
      React.createElement('header', { className: 'flex items-center gap-4 py-4' },
        React.createElement('button', { onClick: () => setScreen('compatibility'), className: 'text-2xl' }, '←'),
        React.createElement('h1', { className: 'text-xl font-bold' }, '💕 궁합 분석 결과'),
        React.createElement('span', { className: 'ml-auto px-3 py-1 bg-pink-500 rounded-full text-xs' }, 'PREMIUM')
      ),
      // 두 사람 정보
      React.createElement('div', { className: 'flex items-center justify-center gap-4 mt-4' },
        React.createElement('div', { className: 'text-center' },
          React.createElement('div', { className: 'w-16 h-16 bg-purple-500/30 rounded-full flex items-center justify-center text-2xl mx-auto' }, person1.gender === '여성' ? '👩' : '👨'),
          React.createElement('p', { className: 'font-bold mt-2' }, person1.name),
          React.createElement('p', { className: 'text-xs text-gray-400' }, `${STEMS.names[r1.dsi]}${STEMS.elements[r1.dsi].toUpperCase()} (${STEMS.korean[r1.dsi]}${el1})`)
        ),
        React.createElement('div', { className: 'text-4xl' }, '💕'),
        React.createElement('div', { className: 'text-center' },
          React.createElement('div', { className: 'w-16 h-16 bg-cyan-500/30 rounded-full flex items-center justify-center text-2xl mx-auto' }, person2.gender === '여성' ? '👩' : '👨'),
          React.createElement('p', { className: 'font-bold mt-2' }, person2.name),
          React.createElement('p', { className: 'text-xs text-gray-400' }, `${STEMS.names[r2.dsi]}${STEMS.elements[r2.dsi].toUpperCase()} (${STEMS.korean[r2.dsi]}${el2})`)
        )
      ),
      // 총점
      React.createElement('div', { className: 'glass rounded-2xl p-6 mt-6 text-center' },
        React.createElement('h3', { className: 'text-gray-400 mb-2' }, '종합 궁합 점수'),
        React.createElement('div', { className: 'text-6xl font-bold text-gradient' }, `${totalScore}점`),
        React.createElement('p', { className: 'text-gray-400 mt-2' }, 
          totalScore >= 85 ? '천생연분! 최고의 궁합입니다 💖' :
          totalScore >= 70 ? '좋은 궁합입니다. 서로 잘 맞아요 💕' :
          totalScore >= 55 ? '무난한 궁합입니다. 노력하면 좋아져요 💛' :
          '서로 다른 점이 많아요. 이해가 필요합니다 🤝'
        )
      ),
      // 분야별 궁합
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('h3', { className: 'font-bold mb-4' }, '📊 분야별 궁합'),
        React.createElement('div', { className: 'space-y-3' },
          [
            { icon: '😊', name: '성격 궁합', score: categoryScores.personality, desc: categoryScores.personality >= 75 ? '성격이 잘 맞아요' : '서로 이해가 필요해요' },
            { icon: '💬', name: '대화/소통', score: categoryScores.communication, desc: categoryScores.communication >= 75 ? '소통이 원활해요' : '대화 노력이 필요해요' },
            { icon: '❤️', name: '연애/결혼', score: categoryScores.love, desc: categoryScores.love >= 75 ? '로맨틱한 관계에요' : '서로 맞춰가야 해요' },
            { icon: '💰', name: '금전/재물', score: categoryScores.money, desc: categoryScores.money >= 75 ? '경제적 조화가 좋아요' : '재정 관리 협의 필요' },
            { icon: '🎯', name: '가치관', score: categoryScores.values, desc: categoryScores.values >= 75 ? '가치관이 비슷해요' : '서로 존중이 필요해요' }
          ].map((item, i) => 
            React.createElement('div', { key: i, className: 'flex items-center gap-3' },
              React.createElement('span', { className: 'text-xl w-8' }, item.icon),
              React.createElement('div', { className: 'flex-1' },
                React.createElement('div', { className: 'flex justify-between items-center mb-1' },
                  React.createElement('span', { className: 'text-sm font-medium' }, item.name),
                  React.createElement('span', { className: 'text-sm font-bold', style: { color: item.score >= 80 ? '#22c55e' : item.score >= 60 ? '#eab308' : '#ef4444' } }, `${Math.round(item.score)}점`)
                ),
                React.createElement('div', { className: 'h-2 bg-white/10 rounded-full overflow-hidden' },
                  React.createElement('div', { className: 'h-full rounded-full', style: { width: `${item.score}%`, backgroundColor: item.score >= 80 ? '#22c55e' : item.score >= 60 ? '#eab308' : '#ef4444' } })
                ),
                React.createElement('p', { className: 'text-xs text-gray-500 mt-1' }, item.desc)
              )
            )
          )
        )
      ),
      // 오행 궁합
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('h3', { className: 'font-bold mb-4' }, '🔥 오행 관계'),
        React.createElement('div', { className: 'flex justify-center items-center gap-4' },
          React.createElement('div', { className: 'w-16 h-16 rounded-full flex items-center justify-center text-white font-bold text-xl', style: { backgroundColor: COLORS[el1] } }, el1),
          React.createElement('div', { className: 'text-center' },
            React.createElement('span', { className: 'text-2xl block' }, isSangsaeng ? '→' : isSanggeuk ? '⚡' : '↔'),
            React.createElement('span', { className: 'text-xs text-gray-400' }, isSangsaeng ? '상생' : isSanggeuk ? '상극' : '비화')
          ),
          React.createElement('div', { className: 'w-16 h-16 rounded-full flex items-center justify-center text-white font-bold text-xl', style: { backgroundColor: COLORS[el2] } }, el2)
        ),
        React.createElement('p', { className: 'text-center text-gray-300 text-sm mt-4 leading-relaxed' }, 
          isSangsaeng 
            ? `${el1}이 ${el2}를 생(生)하는 관계로, ${person1.name}님이 ${person2.name}님에게 도움과 지지를 줄 수 있습니다.`
            : isSanggeuk
            ? `${el1}과 ${el2}는 극(克)하는 관계로 갈등이 있을 수 있지만, 서로 보완하면 강한 시너지를 냅니다.`
            : `같은 오행으로 서로를 잘 이해하며, 비슷한 성향을 공유합니다.`
        )
      ),
      // 지지/천간 관계
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('h3', { className: 'font-bold mb-4' }, '🔮 특별한 인연'),
        React.createElement('div', { className: 'flex flex-wrap gap-2 justify-center mb-4' },
          hasStemHap && React.createElement('span', { className: 'px-3 py-1 bg-pink-500/30 text-pink-300 rounded-full text-sm' }, '천간합 ❤️'),
          hasYukhap && React.createElement('span', { className: 'px-3 py-1 bg-purple-500/30 text-purple-300 rounded-full text-sm' }, '육합 💜'),
          hasChung && React.createElement('span', { className: 'px-3 py-1 bg-orange-500/30 text-orange-300 rounded-full text-sm' }, '충(冲) ⚡'),
          isSangsaeng && React.createElement('span', { className: 'px-3 py-1 bg-green-500/30 text-green-300 rounded-full text-sm' }, '상생 🌱'),
          !hasStemHap && !hasYukhap && !hasChung && React.createElement('span', { className: 'px-3 py-1 bg-gray-500/30 text-gray-300 rounded-full text-sm' }, '중립적 관계')
        ),
        React.createElement('p', { className: 'text-center text-gray-300 text-sm leading-relaxed' }, getRelationText())
      ),
      // 오행 비교 차트
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('h3', { className: 'font-bold mb-4' }, '📈 오행 밸런스 비교'),
        React.createElement('div', { className: 'space-y-3' },
          ['목','화','토','금','수'].map(el =>
            React.createElement('div', { key: el, className: 'flex items-center gap-2' },
              React.createElement('span', { className: 'w-8 text-sm text-center', style: { color: COLORS[el] } }, el),
              React.createElement('div', { className: 'flex-1 flex items-center gap-1' },
                React.createElement('div', { className: 'flex-1 h-3 bg-white/10 rounded-l-full overflow-hidden flex justify-end' },
                  React.createElement('div', { style: { width: `${r1.fe.pct[el]}%`, backgroundColor: COLORS[el] }, className: 'h-full opacity-70' })
                ),
                React.createElement('div', { className: 'w-px h-4 bg-white/30' }),
                React.createElement('div', { className: 'flex-1 h-3 bg-white/10 rounded-r-full overflow-hidden' },
                  React.createElement('div', { style: { width: `${r2.fe.pct[el]}%`, backgroundColor: COLORS[el] }, className: 'h-full opacity-70' })
                )
              ),
              React.createElement('div', { className: 'w-16 flex justify-between text-xs text-gray-400' },
                React.createElement('span', null, `${r1.fe.pct[el]}%`),
                React.createElement('span', null, `${r2.fe.pct[el]}%`)
              )
            )
          )
        ),
        React.createElement('div', { className: 'flex justify-center gap-8 mt-3 text-xs text-gray-400' },
          React.createElement('span', null, `◀ ${person1.name}`),
          React.createElement('span', null, `${person2.name} ▶`)
        )
      ),
      // 조언
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('h3', { className: 'font-bold mb-3' }, '💡 궁합 조언'),
        React.createElement('div', { className: 'space-y-3 text-sm text-gray-300' },
          React.createElement('div', { className: 'flex gap-3' },
            React.createElement('span', { className: 'text-green-400' }, '✓'),
            React.createElement('p', null, totalScore >= 70 
              ? '서로의 장점을 인정하고 칭찬해주세요. 작은 감사 표현이 관계를 더욱 돈독하게 합니다.'
              : '서로 다른 점을 단점이 아닌 개성으로 받아들이세요. 다양성이 관계를 풍요롭게 합니다.')
          ),
          React.createElement('div', { className: 'flex gap-3' },
            React.createElement('span', { className: 'text-green-400' }, '✓'),
            React.createElement('p', null, isSanggeuk || hasChung
              ? '갈등 상황에서는 감정보다 이성적으로 대화하세요. 서로의 입장을 먼저 이해하려 노력해보세요.'
              : '좋은 관계일수록 대화를 게을리하지 마세요. 정기적으로 서로의 생각을 나누는 시간을 가지세요.')
          ),
          React.createElement('div', { className: 'flex gap-3' },
            React.createElement('span', { className: 'text-green-400' }, '✓'),
            React.createElement('p', null, `${person1.name}님의 ${r1.fe.yongshin}(용신)과 ${person2.name}님의 ${r2.fe.yongshin}(용신)을 서로 채워줄 수 있는 활동을 함께 해보세요.`)
          )
        )
      ),
      // 주의사항
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('h3', { className: 'font-bold mb-3' }, '⚠️ 주의할 점'),
        React.createElement('div', { className: 'space-y-3 text-sm text-gray-300' },
          React.createElement('div', { className: 'flex gap-3' },
            React.createElement('span', { className: 'text-amber-400' }, '△'),
            React.createElement('p', null, el1 === el2 
              ? '같은 오행이라 의견 충돌 시 양보가 어려울 수 있습니다. 서로 한 발씩 물러서는 연습이 필요합니다.'
              : `${person1.name}님(${el1})과 ${person2.name}님(${el2})의 에너지 차이를 이해하고 존중해주세요.`)
          ),
          (hasChung || isSanggeuk) && React.createElement('div', { className: 'flex gap-3' },
            React.createElement('span', { className: 'text-amber-400' }, '△'),
            React.createElement('p', null, '스트레스 상황에서 갈등이 커질 수 있습니다. 중요한 결정은 서로 충분히 논의 후 진행하세요.')
          )
        )
      ),
      // 13개 심층 분석 아코디언 섹션 - 관계 유형별로 다른 내용
      React.createElement('div', { className: 'glass rounded-2xl mt-4 overflow-hidden' },
        React.createElement('h3', { className: 'font-bold p-5 pb-3' }, 
          compatRelation === 'couple' ? `💑 ${person1.name} & ${person2.name} 연인 궁합 심층 분석` :
          compatRelation === 'parent' ? `👨‍👧 ${person1.name} & ${person2.name} 부모-자녀 관계 분석` :
          compatRelation === 'sibling' ? `👫 ${person1.name} & ${person2.name} 형제/자매 관계 분석` :
          compatRelation === 'friend' ? `🤝 ${person1.name} & ${person2.name} 우정 궁합 분석` :
          compatRelation === 'business' ? `💼 ${person1.name} & ${person2.name} 비즈니스 궁합 분석` :
          `🔮 ${person1.name} & ${person2.name} 관계 심층 분석`
        ),
        React.createElement('div', { className: 'px-5 pb-3' },
          React.createElement('p', { className: 'text-xs text-gray-500' }, `${el1}(${getElHanja(el1)}) × ${el2}(${getElHanja(el2)}) · ${isSangsaeng ? '상생 관계' : isSanggeuk ? '상극 관계' : '비화 관계'} · ${scoreGrade}등급`)
        ),
        React.createElement('div', { className: 'divide-y divide-white/10' },
          // 관계 유형별 섹션 생성
          (compatRelation === 'couple' ? [
            // 연인/배우자 섹션 - 사주 기반 동적 제목
            { icon: '⚡', color: 'text-amber-400', 
              title: scoreGrade === 'S' ? `${el1}과 ${el2}가 만든 천생연분의 별자리` : 
                     scoreGrade === 'A' ? `${isSangsaeng ? '상생의 빛' : '조화의 힘'}, ${person1.name}과 ${person2.name}의 이야기` : 
                     scoreGrade === 'B' ? `노력으로 빚어가는 ${person1.name} & ${person2.name}의 사랑` : 
                     `${hasChung ? '충(冲)의 불꽃' : '다름의 미학'}, 두 사람이 만나면`,
              content: scoreGrade === 'S' 
                ? `${person1.name}님과 ${person2.name}님의 만남은 우연이 아닌 필연입니다! ${hapCount >= 2 ? `천간합과 지지합이 ${hapCount}개나 있어 명리학적으로 최상의 궁합입니다. 이런 조합은 정말 드물어요.` : `${el1}(${getElHanja(el1)})과 ${el2}(${getElHanja(el2)})의 에너지가 완벽하게 어우러집니다.`}

${yongshinComplement ? `놀라운 점은 ${person1.name}님에게 부족한 ${yongshin1} 에너지를 ${person2.name}님이 채워주고, ${person2.name}님에게 부족한 ${yongshin2} 에너지를 ${person1.name}님이 채워준다는 것입니다. 마치 퍼즐처럼 딱 맞아떨어지는 관계예요!` : `두 분이 함께 있을 때 시너지가 폭발합니다. 1+1=3이 되는 관계입니다.`}

${isSmallAgeDiff ? '비슷한 또래로 공감대가 넓고, 친구처럼 편안하면서도 연인으로서의 설렘이 있습니다.' : isMediumAgeDiff ? '적당한 나이 차이가 서로에게 새로운 시각을 제공합니다.' : '나이 차이가 있지만, 오히려 서로에게 배울 점이 많아 관계가 풍요롭습니다.'}`
                : scoreGrade === 'A'
                ? `${person1.name}님과 ${person2.name}님은 서로를 완성시키는 관계입니다. ${isSangsaeng ? `${el1}이 ${el2}를 생(生)하는 상생 관계로, 자연스럽게 서로에게 에너지를 줍니다.` : `서로 다른 ${el1}과 ${el2}의 에너지가 절묘하게 균형을 이룹니다.`}

${isSimilarBalance ? `오행 분포도 비슷해서 기본적인 성향과 리듬이 맞습니다. 생활 습관이나 가치관에서 큰 충돌 없이 자연스럽게 맞춰갈 수 있어요.` : `오행 분포는 다르지만, 이 차이가 오히려 서로에게 부족한 부분을 채워줍니다.`}

${hasMonthStemHap || hasMonthYukhap ? '월주까지 합(合)이 있어 일상적인 교감이 원활합니다. 함께 생활할 때 자연스러운 조화가 이루어집니다.' : '서로의 일상 리듬을 이해하고 맞춰가는 노력이 관계를 더욱 단단하게 만들 것입니다.'}`
                : scoreGrade === 'B'
                ? `${person1.name}님과 ${person2.name}님의 관계는 노력이 결실을 맺는 타입입니다. ${variation === 0 ? '처음에는 서로의 다름이 낯설 수 있지만, 시간이 지나면 그 다름이 매력으로 변합니다.' : variation === 1 ? '서로를 이해하려는 노력이 필요하지만, 그 과정에서 더 깊은 유대가 형성됩니다.' : variation === 2 ? '쉽게 얻어지는 사랑보다 노력해서 만들어가는 사랑이 더 오래갑니다.' : '차이를 인정하고 존중하는 것에서 진정한 사랑이 시작됩니다.'}

${el1}의 ${el1 === '목' ? '진취적' : el1 === '화' ? '열정적' : el1 === '토' ? '안정적' : el1 === '금' ? '원칙적' : '유연한'}인 면과 ${el2}의 ${el2 === '목' ? '성장지향적' : el2 === '화' ? '표현력 강한' : el2 === '토' ? '포용적' : el2 === '금' ? '결단력 있는' : '지혜로운'}인 면이 만나 새로운 화학반응을 일으킵니다.

${chungCount > 0 ? `충(冲)이 ${chungCount}개 있어 갈등의 소지가 있지만, 이를 극복하면 더 강해집니다.` : '큰 갈등 요소 없이 꾸준히 관계를 발전시켜 나갈 수 있습니다.'}`
                : `두 분의 관계는 서로 다른 에너지의 만남입니다. ${isSanggeuk ? `${el1}과 ${el2}는 상극 관계이지만, 이것이 나쁜 것만은 아닙니다. 대장간에서 쇠를 두드려 명검을 만들듯, 갈등을 통해 서로를 단련시킵니다.` : `처음에는 서로의 방식이 이해되지 않을 수 있습니다. "왜 저렇게 행동하지?"라는 의문이 들 수도 있어요.`}

${variation <= 1 ? '하지만 이 차이야말로 두 분의 관계를 풍요롭게 만드는 원천입니다. 같은 것만 보는 것보다 다른 관점을 배울 수 있으니까요.' : variation <= 3 ? '중요한 건 다름을 틀림으로 보지 않는 것입니다. 서로의 방식을 존중하고 배우려는 자세가 있다면 성장할 수 있습니다.' : '이 관계에서 가장 중요한 건 인내심입니다. 빨리 포기하지 마세요. 시간이 해결해주는 것들이 있습니다.'}

${yongshinMatch ? '용신이 같아서 서로가 원하는 것이 비슷합니다. 공통의 목표를 향해 함께 나아갈 수 있습니다.' : ''}`
            },
            { icon: '😊', color: 'text-pink-400', 
              title: hapCount >= 2 ? `${person1.name}과 ${person2.name}, 말 없이도 통하는 교감` : 
                     hasStemHap ? `${STEMS.korean[r1.dsi]}과 ${STEMS.korean[r2.dsi]}의 천간합이 만든 드라마` : 
                     variation <= 2 ? `${isSmallAgeDiff ? '또래의 공감' : '세대를 초월한'} 일상의 행복` : `${person1.name} & ${person2.name}만의 독특한 리듬`,
              content: hapCount >= 2
                ? `${person1.name}님과 ${person2.name}님은 ${hapCount}개의 합(合)이 있어 말 없이도 통하는 관계입니다. 눈빛만 봐도 상대방의 기분을 알고, 무슨 생각을 하는지 감이 옵니다.

${hasStemHap ? `특히 일간의 천간합(${stem1}+${stem2})은 영혼의 연결고리입니다. 전생에서부터 이어진 듯한 깊은 인연을 느끼게 합니다.` : ''} ${hasYukhap ? `일지의 육합(${br1}+${br2})은 일상의 조화를 의미합니다. 함께 생활할 때 자연스럽게 리듬이 맞습니다.` : ''}

${hasMonthStemHap || hasMonthYukhap ? '월주까지 합이 있어 가정을 이루면 더욱 조화로운 생활이 가능합니다.' : '이 깊은 교감을 바탕으로 함께라면 어떤 어려움도 극복할 수 있습니다.'}`
                : hasStemHap
                ? `천간합이 있는 두 분은 ${variation === 0 ? '갈등 후에 더 깊은 유대감을 느끼는' : variation === 1 ? '열정적인 에너지가 넘치는' : variation === 2 ? '서로에게 강하게 끌리는' : '운명적인 만남을 암시하는'} 관계입니다.

${STEMS.names[r1.dsi]}(${STEMS.korean[r1.dsi]})과 ${STEMS.names[r2.dsi]}(${STEMS.korean[r2.dsi]})의 천간합은 명리학에서 가장 강력한 인연의 증표입니다. ${variation <= 1 ? '열쇠와 자물쇠처럼 서로에게 딱 맞는 느낌을 줍니다.' : '마치 자석처럼 서로를 끌어당기는 힘이 있습니다.'}

${chungCount > 0 ? '다만 충(冲)도 있어 감정의 기복이 있을 수 있습니다. 화해의 순간이 달콤하지만, 너무 깊은 상처를 주고받지 않도록 선을 지키세요.' : '이 관계는 시간이 지나도 권태기 없이 설렘을 유지할 가능성이 높습니다.'}`
                : variation <= 2
                ? `두 분은 ${isSimilarBalance ? '비슷한 에너지 균형을 가져' : '서로의 일상을 존중하며'} 소소한 순간에서 행복을 찾는 관계입니다.

${isSmallAgeDiff ? '비슷한 세대로 공감대가 넓고, 같은 추억을 공유할 수 있습니다.' : '나이 차이가 있지만, 그만큼 서로에게 새로운 세계를 열어줍니다.'} 함께 밥을 먹고, 산책하고, 영화를 보는 평범한 시간이 깊은 정을 쌓아갑니다.

${yongshinMatch ? '용신이 같아 원하는 것이 비슷합니다. 함께하는 시간이 자연스럽고 편안합니다.' : '다른 용신을 가져 서로의 취미가 다를 수 있지만, 이것이 관계에 다양성을 더합니다.'}`
                : `두 분만의 독특한 리듬을 만들어가는 관계입니다. ${isOppositeBalance ? '오행 분포가 많이 달라 처음에는 맞추는 데 시간이 필요하지만, 일단 리듬이 맞으면 환상적인 조화를 이룹니다.' : '서로의 생활 방식을 이해하고 우리만의 규칙을 만들어가세요.'}

${variation === 3 ? '중요한 건 서로에게 맞추려 노력하면서도 나를 잃지 않는 것입니다. 건강한 관계는 두 개인이 함께 성장하는 것이지, 한 사람이 다른 사람에게 맞춰지는 것이 아닙니다.' : '작은 것에 감사하고, 당연한 것을 당연하게 여기지 않는 마음이 관계를 오래 지속시킵니다.'}`
            },
            { icon: '🧩', color: 'text-purple-400', 
              title: yongshinComplement ? `${person1.name}의 ${r1.fe.yongshin}과 ${person2.name}의 ${r2.fe.yongshin}, 서로를 채우다` : `${r1.fe.yongshin === r2.fe.yongshin ? '같은 길을 걷는' : '서로 다른 길에서 만난'} 두 사람의 용신`,
              content: `${person1.name}님의 용신은 ${r1.fe.yongshin}(${getElHanja(r1.fe.yongshin)})이고, ${person2.name}님의 용신은 ${r2.fe.yongshin}(${getElHanja(r2.fe.yongshin)})입니다. ${r1.fe.yongshin === r2.fe.yongshin ? '같은 용신을 가지고 있어 서로의 부족함을 이해하고 함께 채워나갈 수 있습니다.' : '서로 다른 용신을 가지고 있어 각자가 가진 에너지로 상대방의 부족함을 보완해줄 수 있습니다.'}

용신이란 사주에서 가장 필요한 기운을 말합니다. ${person1.name}님에게는 ${r1.fe.yongshin} 기운이 필요한데, ${r2.fe.pct[r1.fe.yongshin] > 20 ? `${person2.name}님이 그 기운을 충분히 가지고 있어 함께 있으면 ${person1.name}님이 안정감을 느낍니다.` : `${person2.name}님과 함께 ${r1.fe.yongshin} 기운을 채우는 활동을 하면 좋습니다.`}

${r2.fe.yongshin !== r1.fe.yongshin ? `반대로 ${person2.name}님에게는 ${r2.fe.yongshin} 기운이 필요한데, ${r1.fe.pct[r2.fe.yongshin] > 20 ? `${person1.name}님이 그 에너지를 가지고 있어 서로에게 꼭 필요한 존재가 됩니다.` : `두 분이 함께 ${r2.fe.yongshin} 기운을 보충하는 활동을 즐기면 관계가 더 건강해집니다.`}` : ''}

퍼즐 조각처럼 서로의 빈 곳을 채워주는 관계입니다. 완벽한 사람은 없지만, 함께하면 더 완전해지는 느낌을 받을 수 있습니다.`
            },
            { icon: '🏃', color: 'text-green-400', 
              title: categoryScores.values >= 75 ? `${person1.name} & ${person2.name}, 같은 곳을 바라보는 동반자` : `다른 꿈을 가진 두 사람이 만들어가는 이야기`,
              content: categoryScores.values >= 70
                ? `두 분은 비슷한 가치관과 목표를 공유하고 있어 인생의 동반자로서 최적의 조합입니다. 

같은 방향을 바라보고 있기 때문에 중요한 결정을 내릴 때 갈등이 적고, 서로를 응원하며 함께 성장할 수 있습니다. 커리어, 가정, 노후 계획 등 인생의 큰 그림에서 의견이 맞아 장기적인 파트너십이 가능합니다.

이 관계의 강점은 "신뢰"입니다. 상대방이 나와 같은 꿈을 꾸고 있다는 확신이 있기 때문에 믿고 맡길 수 있습니다. 결혼 후에도 이 신뢰가 가정을 단단하게 지탱해줄 것입니다.

다만 너무 비슷하면 새로운 자극이 부족할 수 있으니, 가끔은 각자의 관심사를 개발하고 서로에게 새로운 이야기를 들려주세요.`
                : `두 분의 목표와 가치관에는 차이가 있지만, 이것이 오히려 서로의 시야를 넓혀주는 계기가 됩니다.

${person1.name}님이 A를 원할 때 ${person2.name}님이 B를 원하는 상황이 생길 수 있습니다. 이럴 때 중요한 건 "타협점"을 찾는 것이 아니라 "새로운 C"를 함께 창조하는 것입니다. 두 사람의 아이디어가 만나면 혼자서는 상상도 못했던 가능성이 열립니다.

다른 것은 틀린 것이 아닙니다. ${person1.name}님의 관점도 소중하고, ${person2.name}님의 관점도 소중합니다. 서로의 꿈을 존중하고, 각자의 길을 응원하면서도 함께하는 시간을 만드는 균형이 필요합니다.`
            },
            { icon: '💥', color: 'text-red-400', 
              title: hasChung ? `${BRANCHES.korean[BRANCHES.names.indexOf(br1)]}과 ${BRANCHES.korean[BRANCHES.names.indexOf(br2)]}의 충돌, 불꽃 튀는 두 사람` : `${isSanggeuk ? '상극을 넘어선' : '갈등 없는'} 성숙한 관계`,
              content: hasChung
                ? `${br1}와 ${br2}의 충(冲) 관계가 있어 자존심이 강하게 부딪힐 수 있습니다. 마치 두 개의 강철이 만나 불꽃이 튀는 것과 같습니다.

충(冲)은 명리학에서 대립과 긴장을 의미하지만, 이것이 반드시 나쁜 것은 아닙니다. 오히려 이 긴장감이 관계를 나태해지지 않게 만들고, 서로를 더 날카롭게 성장시킵니다. 다만 갈등 상황에서 감정적으로 폭발하지 않도록 주의해야 합니다.

중요한 규칙: 화가 났을 때 바로 대응하지 마세요. 최소 10초간 심호흡을 하고, 가능하다면 24시간 후에 대화하세요. 충동적인 말이 돌이킬 수 없는 상처를 남길 수 있습니다.

이 긴장감을 잘 관리하면 두 분은 서로를 자극하며 끊임없이 발전하는 최고의 파트너가 될 수 있습니다.`
                : `두 분은 서로의 영역을 침범하지 않으면서 존중하는 성숙한 관계를 유지할 수 있습니다. 큰 갈등 없이 평화롭게 지낼 수 있는 조합입니다.

이런 관계의 장점은 "편안함"입니다. 상대방과 함께 있을 때 억지로 맞추거나 눈치 볼 필요가 없습니다. 있는 그대로의 나를 보여줄 수 있고, 상대방도 그것을 받아들입니다.

다만 갈등을 피하려다 중요한 문제를 덮고 넘어가는 일이 없도록 하세요. 불편한 대화도 필요합니다. 관계가 너무 평탄하면 깊이가 부족해질 수 있으니, 때로는 진지한 대화로 서로의 내면을 들여다보는 시간을 가지세요.`
            },
            { icon: '💘', color: 'text-pink-400', 
              title: hasYukhap ? `${BRANCHES.korean[BRANCHES.names.indexOf(br1)]}과 ${BRANCHES.korean[BRANCHES.names.indexOf(br2)]}의 육합, 운명적 만남` : `${el1}과 ${el2}의 에너지가 빚은 사랑 이야기`,
              content: hasYukhap
                ? `${br1}와 ${br2}의 육합(六合)! 두 분은 처음 만났을 때부터 강한 끌림을 느꼈을 가능성이 높습니다. 전생부터 이어진 듯한 깊은 연결고리가 있습니다.

육합은 명리학에서 가장 아름다운 인연을 나타냅니다. 마치 퍼즐 조각이 딱 맞아떨어지는 것처럼 자연스러운 조화를 이룹니다. 대화할 때 서로의 말을 쉽게 이해하고, 침묵 속에서도 편안함을 느낍니다.

이 관계의 핵심은 "자연스러움"입니다. 억지로 노력하지 않아도 흘러가듯이 관계가 발전합니다. 하지만 이 자연스러움에 안주하지 마세요. 좋은 관계도 가꾸지 않으면 시들 수 있습니다. 서로에 대한 감사와 표현을 잊지 마세요.`
                : `두 분의 관계는 시간이 지날수록 더 깊어지는 타입입니다. 처음에는 "이 사람이 나와 맞을까?" 의문이 들 수도 있지만, 천천히 알아갈수록 매력을 발견하게 됩니다.

이런 관계의 장점은 "안정감"입니다. 첫눈에 반한 사랑은 빨리 식을 수 있지만, 천천히 쌓아 올린 관계는 오래갑니다. 시간이 약이 되는 관계입니다.

상대방의 새로운 면을 발견할 때마다 설레는 마음을 유지하세요. 이미 다 안다고 생각하는 순간 관계는 멈춥니다. 호기심을 갖고 상대방에게 질문하고, 새로운 모습을 찾아보세요.`
            },
            { icon: '🏠', color: 'text-cyan-400', 
              title: el1 === el2 ? `같은 ${el1}(${getElHanja(el1)}) 기운, 함께 빛나는 동질감` : `${el1}과 ${el2}, 각자의 공간이 만드는 조화`,
              content: el1 === el2
                ? `같은 ${el1}(${getElHanja(el1)}) 오행을 가진 두 분은 서로를 깊이 이해할 수 있습니다. 취미, 생활 방식, 사고방식이 비슷해서 함께 있는 시간이 편안합니다.

${el1 === '목' ? '두 분 다 성장과 발전을 중시합니다. 함께 새로운 것을 배우고 도전하는 것을 즐깁니다.' : el1 === '화' ? '두 분 다 열정적이고 표현력이 강합니다. 함께 있으면 에너지가 넘칩니다.' : el1 === '토' ? '두 분 다 안정과 신뢰를 중시합니다. 함께 있으면 든든함을 느낍니다.' : el1 === '금' ? '두 분 다 원칙과 의리를 중시합니다. 서로에 대한 약속을 소중히 여깁니다.' : '두 분 다 지혜와 유연함이 있습니다. 깊은 대화를 나누는 것을 즐깁니다.'}

다만 같은 오행은 부딪힐 때 양보가 어려울 수 있습니다. 서로 "내가 맞아"라고 주장하면 갈등이 커지니, 때로는 의식적으로 한 발 물러서는 연습이 필요합니다.`
                : `서로 다른 에너지를 가진 두 분은 각자만의 시간을 갖는 것이 관계에 도움이 됩니다. 24시간 붙어 있는 것보다 적당한 거리가 관계를 건강하게 만듭니다.

${person1.name}님(${el1})은 ${el1 === '목' ? '성장과 도전' : el1 === '화' ? '표현과 열정' : el1 === '토' ? '안정과 휴식' : el1 === '금' ? '정돈과 계획' : '사색과 휴양'}의 시간이 필요하고, ${person2.name}님(${el2})은 ${el2 === '목' ? '새로운 경험' : el2 === '화' ? '활동과 에너지 발산' : el2 === '토' ? '평화로운 일상' : el2 === '금' ? '명확한 구조' : '감성적인 충전'}이 필요합니다.

서로의 개인 시간을 존중하고, 함께하는 시간에는 온전히 집중하세요. 이 균형이 잡히면 만날 때마다 새롭고 설레는 관계가 유지됩니다.`
            },
            { icon: '👶', color: 'text-amber-400', title: '함께 키울 아이, 어떤 모습일까?',
              content: `두 분의 오행 조합으로 볼 때, ${isSangsaeng ? '상생 관계라 자녀에게 안정적인 환경을 제공할 수 있습니다. 부모 사이의 에너지가 조화롭게 흘러 아이에게 긍정적인 영향을 줍니다.' : isSanggeuk ? '상극 관계라 양육 방식에 차이가 있을 수 있습니다. 하지만 이 차이가 아이에게 다양한 관점을 배우게 해줍니다.' : '중립적인 조합으로 균형 잡힌 양육이 가능합니다.'}

${person1.name}님은 ${el1 === '목' ? '아이의 성장과 교육에 관심이 많을 것입니다. 배움의 기회를 많이 제공하려 합니다.' : el1 === '화' ? '아이와 활발하게 소통하고 많은 것을 경험시켜 주려 합니다.' : el1 === '토' ? '안정적인 환경과 일관된 규칙을 중요하게 생각합니다.' : el1 === '금' ? '원칙과 규율을 가르치려 하고 책임감 있는 아이로 키우고 싶어합니다.' : '아이의 감정과 창의성을 존중하는 양육 방식을 선호합니다.'}

${person2.name}님은 ${el2 === '목' ? '자유롭게 탐구하도록 격려하는 부모가 될 것입니다.' : el2 === '화' ? '열정적으로 아이와 함께 뛰어놀고 대화하는 부모가 될 것입니다.' : el2 === '토' ? '포근하고 든든한 울타리 같은 부모가 될 것입니다.' : el2 === '금' ? '명확한 기준을 제시하는 부모가 될 것입니다.' : '감성적으로 교감하는 부모가 될 것입니다.'}

자녀 교육에 대해 미리 충분히 대화하고 공통된 원칙을 세우는 것이 좋습니다.`
            },
            { icon: '👨‍👩‍👧', color: 'text-blue-400', title: '시댁과 처가 사이, 중재자의 역할',
              content: `결혼 후 양가 부모님과의 관계도 중요합니다. ${person1.name}님과 ${person2.name}님의 오행 조합을 보면 어떤 역할 분담이 좋을지 알 수 있습니다.

${person1.name}님(${el1})은 ${el1 === '토' ? '중재와 조화에 능숙하여 양가 사이에서 균형을 잡아줄 수 있습니다. 갈등 상황에서 다리 역할을 하기 좋습니다.' : el1 === '수' ? '유연한 대처로 양가의 다양한 상황에 적응할 수 있습니다. 분위기에 맞춰 조절하는 능력이 있습니다.' : el1 === '목' ? '새로운 방식으로 양가 관계를 발전시킬 수 있습니다. 전통에 얽매이지 않고 합리적인 해결책을 찾습니다.' : el1 === '화' ? '밝고 활발한 에너지로 양가 모임을 화기애애하게 만들 수 있습니다.' : '원칙을 지키면서도 예의 바르게 양가와 소통합니다.'}

${person2.name}님(${el2})은 ${el2 === '토' ? '안정감 있게 양가를 연결하는 역할을 할 수 있습니다.' : el2 === '수' ? '센스 있게 분위기를 읽고 대처합니다.' : el2 === '목' ? '진취적으로 양가 관계를 이끌어 갑니다.' : el2 === '화' ? '따뜻한 정으로 양가 어른들의 마음을 얻습니다.' : '신뢰감 있는 태도로 존중을 받습니다.'}

중요한 건 서로의 부모님을 내 부모님처럼 대하려는 노력입니다. 상대방의 가족을 존중하는 것이 상대방을 존중하는 것입니다.`
            },
            { icon: '🎭', color: 'text-violet-400', 
              title: `${el1} 일간 ${person1.name}의 속마음, ${el2} 일간 ${person2.name}의 진심`,
              content: `겉으로 보이는 모습과 속마음이 다른 경우가 많습니다. 서로의 진짜 마음을 이해하면 오해가 줄어듭니다.

${person1.name}님(${el1})은 ${el1 === '목' ? '겉으로는 강하고 독립적으로 보이지만, 속으로는 인정받고 싶고 의지할 곳이 필요합니다. 혼자서도 잘한다고 말하지만 실은 응원이 필요합니다.' : el1 === '화' ? '열정적이고 자신감 있어 보이지만, 내면에는 불안함과 두려움이 있을 수 있습니다. 관심받지 못하면 외로움을 느낍니다.' : el1 === '토' ? '안정적이고 포용력 있어 보이지만, 내심 변화와 모험을 원할 때가 있습니다. 의외로 새로운 경험에 대한 욕구가 있습니다.' : el1 === '금' ? '냉정하고 이성적으로 보이지만, 마음속에는 뜨거운 정이 있습니다. 표현을 잘 못할 뿐 사랑이 깊습니다.' : '유연하고 적응력 있어 보이지만, 자신만의 확고한 원칙이 있습니다. 쉽게 흔들리는 것처럼 보여도 핵심 가치는 지킵니다.'}

${person2.name}님(${el2})은 ${el2 === '목' ? '진취적으로 보이지만 실패에 대한 두려움이 있습니다. 용기를 북돋아 주세요.' : el2 === '화' ? '밝아 보이지만 혼자 있을 때 외로움을 느낍니다. 관심을 표현해 주세요.' : el2 === '토' ? '든든해 보이지만 때로는 누군가에게 기대고 싶어합니다. 의지해도 된다고 말해 주세요.' : el2 === '금' ? '차가워 보이지만 상처받기 쉽습니다. 부드럽게 대해 주세요.' : '차분해 보이지만 감정의 파도가 있습니다. 이야기를 들어주세요.'}

서로의 속마음을 알면 불필요한 갈등을 예방할 수 있습니다.`
            },
            { icon: '💝', color: 'text-rose-400', 
              title: `${person1.name}이 원하는 사랑 vs ${person2.name}이 원하는 사랑`,
              content: `사람마다 사랑을 표현하고 느끼는 방식이 다릅니다. 두 분의 오행으로 살펴보면:

${person1.name}님(${el1})이 원하는 사랑의 언어: ${el1 === '화' ? '직접적인 애정 표현입니다. "사랑해", "예뻐"라는 말을 자주 듣고 싶어합니다. 스킨십과 따뜻한 말이 힘이 됩니다.' : el1 === '목' ? '함께 성장하는 느낌입니다. 서로의 꿈을 응원하고, 배움을 공유하는 것이 사랑입니다.' : el1 === '토' ? '안정적인 일상입니다. 매일 밥을 함께 먹고, 편안하게 곁에 있는 것이 사랑입니다.' : el1 === '금' ? '실질적인 도움입니다. 말보다 행동으로 보여주는 것이 진심입니다.' : '정서적 교감입니다. 깊은 대화와 감정 공유가 사랑입니다.'}

${person2.name}님(${el2})이 원하는 사랑의 언어: ${el2 === '화' ? '열정적인 관심입니다. 눈에 보이는 관심과 칭찬이 필요합니다.' : el2 === '목' ? '자유와 응원입니다. 간섭보다 믿음이 사랑입니다.' : el2 === '토' ? '변치 않는 사랑입니다. 흔들리지 않는 신뢰가 필요합니다.' : el2 === '금' ? '약속 이행입니다. 한 번 한 말은 꼭 지키는 것이 사랑입니다.' : '감정 공유입니다. 함께 웃고 우는 것이 사랑입니다.'}

서로 원하는 방식으로 사랑을 표현해 주세요. 내가 주고 싶은 방식이 아니라, 상대방이 받고 싶은 방식으로요.`
            },
            { icon: '⏰', color: 'text-orange-400', 
              title: `${isSanggeuk || hasChung ? `${el1}과 ${el2}의 충돌 예방법` : `${el1} & ${el2} 커플의 권태기 극복 전략`}`,
              content: `모든 관계에는 위기가 옵니다. 두 분의 관계에서 주의해야 할 시기와 대처법을 알려드립니다.

${isSanggeuk || hasChung ? `상극/충 에너지가 있는 두 분은 스트레스 상황에서 갈등이 커질 수 있습니다. 직장 문제, 경제적 압박, 가족 갈등 등 외부 스트레스가 쌓이면 서로에게 화풀이할 위험이 있습니다.

대처법: 
1. 스트레스가 쌓이면 먼저 말하세요. "요즘 힘들어서 예민할 수 있어"라고 미리 알리면 오해가 줄어듭니다.
2. 함께 스트레스를 푸는 활동을 찾으세요. 운동, 여행, 취미 등 에너지를 발산할 출구가 필요합니다.
3. 큰 결정은 평온할 때 내리세요. 감정이 격해진 상태에서 한 결정은 후회하게 됩니다.` : `안정적인 관계지만 권태기가 올 수 있습니다. 처음의 설렘이 사라지고 일상이 반복되면 서로에게 무관심해질 수 있습니다.

대처법:
1. 새로운 경험을 함께 시도하세요. 안 가본 곳, 안 해본 것에 도전해보세요.
2. 의식적으로 스킨십과 대화 시간을 유지하세요. 바빠도 30분은 서로에게 집중하세요.
3. 각자의 성장을 멈추지 마세요. 변화하는 모습을 보여주면 새로운 매력이 생깁니다.`}

위기는 성장의 기회입니다. 함께 극복한 위기가 관계를 더 단단하게 만듭니다.`
            },
            { icon: '🌊', color: 'text-teal-400', title: '함께하면 좋은 장소와 활동',
              content: `두 분의 오행 에너지를 고려한 맞춤형 데이트 코스와 활동을 추천합니다.

${el1 === '목' || el2 === '목' ? '🌲 숲, 공원, 식물원: 목(木) 에너지가 있는 분에게 자연은 최고의 충전소입니다. 등산, 캠핑, 피크닉을 함께 즐겨보세요.\n' : ''}${el1 === '화' || el2 === '화' ? '🎭 콘서트, 축제, 스포츠: 화(火) 에너지가 있는 분에게 활동적인 데이트가 좋습니다. 함께 땀 흘리며 에너지를 발산하세요.\n' : ''}${el1 === '토' || el2 === '토' ? '🏡 홈카페, 쿠킹 클래스, 인테리어 쇼핑: 토(土) 에너지가 있는 분에게 집과 음식은 중요한 테마입니다. 함께 요리하고 집을 꾸며보세요.\n' : ''}${el1 === '금' || el2 === '금' ? '🏛️ 미술관, 클래식 공연, 파인다이닝: 금(金) 에너지가 있는 분에게 품격 있는 경험이 좋습니다. 고급스럽고 정제된 분위기를 즐겨보세요.\n' : ''}${el1 === '수' || el2 === '수' ? '🌊 바다, 호수, 온천: 수(水) 에너지가 있는 분에게 물은 힐링입니다. 해변 산책, 온천 여행, 수영을 함께 해보세요.' : ''}

공통 추천: 두 분의 용신 ${r1.fe.yongshin}과 ${r2.fe.yongshin}을 고려해서 ${r1.fe.yongshin === '화' || r2.fe.yongshin === '화' ? '따뜻하고 밝은 장소' : r1.fe.yongshin === '수' || r2.fe.yongshin === '수' ? '물가나 조용한 장소' : r1.fe.yongshin === '목' || r2.fe.yongshin === '목' ? '자연이 가까운 장소' : r1.fe.yongshin === '토' || r2.fe.yongshin === '토' ? '편안한 분위기의 장소' : '정돈된 분위기의 장소'}에서 시간을 보내면 둘 다 기분이 좋아집니다.`
            }
          ] : compatRelation === 'parent' ? [
            // 부모-자녀 섹션 (대폭 확장)
            { icon: '🌱', color: 'text-green-400', title: '타고난 부모-자녀의 인연',
              content: `${person1.name}님과 ${person2.name}님은 ${totalScore >= 70 ? '전생에서부터 깊은 인연으로 이어진 부모-자녀 관계입니다.' : '이번 생에서 서로 배워야 할 것이 많은 부모-자녀 관계입니다.'}

${el1}(${getElHanja(el1)}) 부모와 ${el2}(${getElHanja(el2)}) 자녀의 조합은 ${isSangsaeng ? '상생(相生) 관계로, 부모의 에너지가 자연스럽게 자녀에게 전해집니다. 부모가 물을 주면 자녀가 꽃을 피우는 것처럼 조화로운 관계입니다.' : isSanggeuk ? '상극(相剋) 관계로, 때로는 부딪히지만 그만큼 서로를 단련시키는 관계입니다. 대장간에서 쇠를 두드려 명검을 만드는 것처럼, 갈등을 통해 강해집니다.' : '비화(比和) 관계로, 서로를 깊이 이해할 수 있습니다. 같은 눈높이에서 공감하지만, 너무 비슷해서 부딪힐 때도 있습니다.'}

이 관계의 핵심 과제는 ${totalScore >= 70 ? '"조화 속의 독립"입니다. 좋은 관계이지만 적절한 거리를 유지해야 건강한 관계가 됩니다.' : '"이해를 통한 성장"입니다. 서로의 다름을 인정하고 배우는 것이 관계 발전의 열쇠입니다.'}`
            },
            { icon: '🎓', color: 'text-blue-400', title: hasStemHap ? '말 안 해도 통하는 교감' : '표현해야 전해지는 마음',
              content: hasStemHap
                ? `${STEMS.names[r1.dsi]}(${STEMS.korean[r1.dsi]})과 ${STEMS.names[r2.dsi]}(${STEMS.korean[r2.dsi]})의 천간합! 부모와 자녀 사이에 자연스러운 교감이 있습니다.

말하지 않아도 서로의 마음을 읽는 경우가 많습니다. 부모가 걱정되면 자녀도 덩달아 불안해지고, 자녀가 기쁘면 부모도 함께 행복해집니다. 이런 정서적 연결고리는 평생 이어집니다.

다만 이 강한 연결이 때로는 "간섭"으로 느껴질 수 있습니다. 자녀가 성인이 되면 적절한 경계가 필요합니다. 서로의 영역을 존중하면서도 깊은 유대를 유지하는 것이 과제입니다.`
                : `부모와 자녀 사이에 "당연히 알겠지"라는 생각은 금물입니다.

${person1.name}님과 ${person2.name}님은 서로의 마음을 적극적으로 표현해야 전해집니다. 부모의 사랑도, 자녀의 감사도 말로 표현하지 않으면 모릅니다. "말 안 해도 알지"라고 생각하면 서운함만 쌓입니다.

특히 중요한 것: 감정을 표현할 때는 "나 전달법"을 사용하세요. "넌 왜 그래"가 아니라 "나는 이럴 때 속상해"라고 말하면 갈등이 줄어듭니다. 정기적인 대화 시간을 정해두는 것도 좋습니다.`
            },
            { icon: '🧬', color: 'text-purple-400', title: '물려받은 기질, 다른 방식의 표현',
              content: `${person2.name}님은 ${person1.name}님의 ${el1}(${getElHanja(el1)}) 기운을 물려받았지만, ${el2}(${getElHanja(el2)})로 다르게 표현합니다.

${el1 === el2 ? `같은 오행을 가진 부모와 자녀는 서로를 거울처럼 비춥니다. ${person1.name}님이 ${person2.name}님에게서 자신의 모습을 발견하고, 때로는 그것이 불편할 수 있습니다. 하지만 이는 자신을 돌아보는 기회이기도 합니다.` : isSangsaeng ? `상생 관계로 부모의 뜻을 자연스럽게 이어받습니다. ${el1}이 ${el2}를 낳듯, ${person1.name}님의 가치관과 꿈이 ${person2.name}님에게 전해져 새로운 형태로 꽃핍니다.` : `다른 방식으로 발전시켜 나갑니다. ${person1.name}님이 A를 원해도 ${person2.name}님은 B를 선택할 수 있습니다. 이것은 반항이 아니라 자신만의 길을 찾는 과정입니다.`}

부모의 역할은 "내 뜻대로 키우는 것"이 아니라 "자녀가 자신만의 색깔을 찾도록 돕는 것"입니다. ${person2.name}님만의 방식을 존중해주세요.`
            },
            { icon: '📚', color: 'text-amber-400', title: '이 아이에게 맞는 교육 방식',
              content: `${person2.name}님(${el2} 오행)에게 가장 효과적인 교육 방식을 알려드립니다.

${el2 === '목' ? `🌳 목(木) 자녀: 자유롭게 탐구하고 성장할 수 있는 환경이 중요합니다.
- 호기심을 억누르지 말고 질문에 성의껏 답해주세요
- 다양한 경험을 시켜주되 강요하지 마세요
- 실패해도 다시 도전할 수 있다는 믿음을 주세요
- 창의성을 키우는 활동(미술, 음악, 코딩)이 좋습니다` : el2 === '화' ? `🔥 화(火) 자녀: 열정을 표현하고 인정받는 경험이 중요합니다.
- 작은 성취에도 칭찬을 아끼지 마세요
- 발표, 공연 등 표현할 기회를 많이 주세요
- 에너지가 넘치니 운동으로 발산시켜 주세요
- 부정적인 말보다 격려가 효과적입니다` : el2 === '토' ? `🏔️ 토(土) 자녀: 안정적이고 일관된 양육 방식이 중요합니다.
- 규칙적인 생활 리듬을 만들어주세요
- 약속은 반드시 지켜주세요 (신뢰가 핵심)
- 급격한 변화보다 점진적 적응을 도와주세요
- 실용적인 기술을 배우는 것을 좋아합니다` : el2 === '금' ? `⚔️ 금(金) 자녀: 명확한 규칙과 목표 제시가 중요합니다.
- 이유를 논리적으로 설명해주세요
- 공정한 대우를 받는다고 느끼게 해주세요
- 목표를 세우고 달성하는 경험을 쌓게 하세요
- 비판보다 건설적 피드백이 효과적입니다` : `💧 수(水) 자녀: 감정적 교감과 창의적 활동이 중요합니다.
- 감정을 표현하고 공감받는 경험을 주세요
- 예술, 음악, 글쓰기 등 창작 활동을 권장하세요
- 혼자만의 시간도 존중해주세요
- 직관을 무시하지 말고 들어주세요`}`
            },
            { icon: '💥', color: 'text-red-400', title: hasChung ? '피할 수 없는 세대 갈등' : '건강한 독립을 향한 여정',
              content: hasChung
                ? `${br1}와 ${br2}의 충(冲)! 부모와 자녀 사이에 갈등이 잦을 수 있습니다.

하지만 이것을 나쁘게만 볼 필요는 없습니다. 충(冲)은 "부딪힘"이지만, 이 충돌이 자녀의 독립심과 자기 주장을 키웁니다. 부모의 그늘에서 벗어나 자신만의 길을 개척하게 됩니다.

대처법:
1. 정면충돌을 피하세요. 감정이 격해지면 24시간 후에 대화하세요.
2. "너"가 아닌 "나" 중심으로 말하세요. "넌 왜 그래"가 아니라 "나는 이게 걱정돼"
3. 서로 다름을 인정하세요. 자녀가 부모와 다른 선택을 해도 존중하세요.
4. 갈등 후에는 반드시 화해의 시간을 가지세요.`
                : `큰 갈등 없이 자연스럽게 독립을 준비할 수 있는 관계입니다.

${person2.name}님은 ${person1.name}님의 울타리 안에서 안정감을 느끼며 자랍니다. 하지만 건강한 관계를 위해서는 적절한 "놓아줌"이 필요합니다.

${person2.name}님의 성장 단계에 맞춰:
- 유아기: 충분한 사랑과 안정감
- 아동기: 점차 자율성 부여
- 청소년기: 의견을 존중하고 결정권 부여
- 성인기: 친구 같은 관계로 전환

자녀가 실수해도 직접 해결하도록 기다려주세요. 그것이 진정한 사랑입니다.`
            },
            { icon: '🏠', color: 'text-cyan-400', title: '가정 내 역할과 위치',
              content: `${person2.name}님은 가정에서 ${el2 === '목' ? '새로운 아이디어와 활력을 불어넣는' : el2 === '화' ? '분위기를 밝게 만드는 무드메이커' : el2 === '토' ? '가족을 하나로 묶는 중심' : el2 === '금' ? '질서와 규율을 지키는' : '감정적 완충 역할을 하는'} 존재입니다.

${el2 === '목' ? `목(木) 자녀는 가정에 "성장"의 에너지를 가져옵니다. 새로운 것을 제안하고, 변화를 두려워하지 않습니다. 때로는 부모보다 앞서 나가려 해서 갈등이 생길 수 있지만, 이것이 가족 전체를 발전시킵니다.` : el2 === '화' ? `화(火) 자녀는 가정에 "열정"의 에너지를 가져옵니다. 이 아이가 있으면 집안이 활기찹니다. 웃음이 끊이지 않고, 가족 행사도 즐겁게 이끕니다. 다만 에너지가 넘쳐서 지칠 때도 있으니 쉬는 시간도 필요합니다.` : el2 === '토' ? `토(土) 자녀는 가정에 "안정"의 에너지를 가져옵니다. 가족 간의 갈등을 중재하고, 모두를 연결하는 역할을 합니다. 어른스럽고 책임감이 강해 부모가 의지하게 될 수도 있습니다.` : el2 === '금' ? `금(金) 자녀는 가정에 "질서"의 에너지를 가져옵니다. 규칙을 중요시하고, 불공정한 것에 민감합니다. 때로는 고집스럽게 보일 수 있지만, 원칙을 지키려는 올곧은 성격입니다.` : `수(水) 자녀는 가정에 "공감"의 에너지를 가져옵니다. 가족의 감정 변화를 민감하게 알아채고, 위로가 필요한 사람 곁에 있어줍니다. 조용하지만 가족의 정서적 안정에 큰 역할을 합니다.`}`
            },
            { icon: '💰', color: 'text-yellow-400', title: '경제관념과 용돈 교육',
              content: `${person2.name}님의 ${el2}(${getElHanja(el2)}) 성향에 맞는 경제 교육 방법입니다.

${el2 === '목' ? `🌳 목(木) 자녀의 금전 성향:
- 미래 투자에 관심이 많습니다
- 저축의 "목적"을 알려주면 동기부여가 됩니다
- "○○ 사려고 모으자"처럼 목표를 정해주세요
- 창업, 투자에 관심을 보일 수 있으니 기초 경제 개념을 알려주세요` : el2 === '화' ? `🔥 화(火) 자녀의 금전 성향:
- 충동적 소비 성향이 있습니다
- 계획적 소비를 가르쳐주세요
- 용돈기입장을 함께 쓰며 지출을 점검하세요
- "갖고 싶다"와 "필요하다"의 차이를 알려주세요` : el2 === '토' ? `🏔️ 토(土) 자녀의 금전 성향:
- 안정적 저축을 좋아합니다
- 장기 목표(1년, 5년)를 함께 세워주세요
- 저금통이나 적금을 만들어주면 꾸준히 모읍니다
- 땅, 부동산에 관심을 가질 수 있습니다` : el2 === '금' ? `⚔️ 금(金) 자녀의 금전 성향:
- 가치 있는 것에 투자하는 것을 좋아합니다
- 싼 것보다 좋은 것을 원합니다
- "가성비"보다 "품질"을 중시하도록 가르쳐주세요
- 돈의 가치와 노동의 대가를 연결시켜 주세요` : `💧 수(水) 자녀의 금전 성향:
- 감정에 따른 소비 경향이 있습니다
- 기분이 좋거나 나쁠 때 지출이 늘어납니다
- 감정과 소비를 분리하도록 도와주세요
- 경험(여행, 콘서트)에 쓰는 것은 괜찮습니다`}`
            },
            { icon: '🎯', color: 'text-indigo-400', title: '자녀의 숨은 재능과 진로',
              content: `${person2.name}님의 ${el2}(${getElHanja(el2)}) 오행에서 보이는 재능과 적성입니다.

${el2 === '목' ? `🌳 목(木) 자녀의 재능:
창의성, 기획력, 성장 마인드가 뛰어납니다.

추천 진로: 교육자, 컨설턴트, 스타트업, 기획자, 건축가, 환경 분야, 의류/패션, 출판/미디어

강점: 새로운 것을 만들어내는 능력, 변화에 대한 적응력
개발 포인트: 끈기와 지속력을 기르면 더 큰 성과를 냅니다` : el2 === '화' ? `🔥 화(火) 자녀의 재능:
표현력, 리더십, 사교성이 뛰어납니다.

추천 진로: 연예인, 마케터, 영업, 강사, 이벤트 기획, 스포츠, PR, 유튜버/인플루언서

강점: 사람들을 이끄는 카리스마, 밝은 에너지
개발 포인트: 꾸준함과 인내력을 기르면 정상에 설 수 있습니다` : el2 === '토' ? `🏔️ 토(土) 자녀의 재능:
신뢰성, 실용성, 중재 능력이 뛰어납니다.

추천 진로: 금융, 부동산, 공무원, 행정, 농업/식품, 중개업, 인사/총무, 사회복지

강점: 사람들에게 믿음을 주는 능력, 꾸준함
개발 포인트: 변화에 대한 유연성을 기르면 더 넓은 세상이 열립니다` : el2 === '금' ? `⚔️ 금(金) 자녀의 재능:
분석력, 결단력, 정밀함이 뛰어납니다.

추천 진로: 법률, 의료, 엔지니어링, 회계, 금융분석, 품질관리, 연구원, 프로그래머

강점: 정확하고 날카로운 판단력, 원칙을 지키는 성품
개발 포인트: 유연성과 공감 능력을 기르면 리더가 될 수 있습니다` : `💧 수(水) 자녀의 재능:
직관력, 감수성, 소통 능력이 뛰어납니다.

추천 진로: 상담사, 예술가, 작가, 심리학자, 서비스업, 의료(간호), 종교/철학, 해양 관련

강점: 사람의 마음을 읽는 능력, 창의적 영감
개발 포인트: 결단력과 실행력을 기르면 꿈을 현실로 만들 수 있습니다`}`
            },
            { icon: '🤝', color: 'text-pink-400', title: '사춘기/반항기 대처법',
              content: `${person2.name}님의 사춘기/반항기에 대비한 조언입니다.

${hasChung ? `⚡ 충(冲) 관계: 반항기가 격렬할 수 있습니다.

정면충돌은 피하세요. "왜 그래!"라고 다그치면 더 반항합니다.
시간을 두고 기다려주세요. 감정이 가라앉으면 대화가 됩니다.
자녀의 "반항"은 "독립의 신호"입니다. 자기 주장을 하는 것은 건강한 성장입니다.

이 시기를 잘 넘기면 오히려 더 깊은 신뢰가 쌓입니다.` : isSanggeuk ? `⚔️ 상극 관계: 의견 충돌이 잦을 수 있습니다.

감정적 대응을 피하세요. 부모가 먼저 차분해지면 자녀도 따라옵니다.
"너 때문에"가 아니라 "나는 이렇게 느껴"로 말하세요.
자녀의 선택을 비난하지 말고 결과를 경험하게 해주세요.

다름을 인정하면 갈등이 줄어듭니다.` : `🌟 조화로운 관계: 비교적 순탄하게 지나갈 수 있습니다.

그래도 대화 채널을 열어두세요. 자녀가 말할 때 끝까지 들어주세요.
"요즘 애들은~"이라는 말은 피하세요.
자녀의 친구, 관심사에 관심을 가지세요.

좋은 관계일수록 사춘기가 가볍게 지나갑니다.`}

공통 조언: 이 시기 자녀에게 가장 필요한 것은 "무조건적인 지지"입니다. 행동은 틀릴 수 있어도 존재 자체는 사랑받고 있다는 확신을 주세요.`
            },
            { icon: '👴', color: 'text-gray-400', title: '부모가 나이 들었을 때',
              content: `${person1.name}님이 나이 들었을 때 ${person2.name}님과의 관계는 어떨까요?

${el2 === '목' ? `🌳 목(木) 자녀: 부모의 독립성을 존중하며 돌봅니다.
- 부모가 스스로 할 수 있는 것은 지켜봅니다
- 새로운 취미나 활동을 권유합니다
- 물리적 거리가 있어도 정신적으로 연결되어 있습니다
- "간섭"보다 "응원"하는 스타일입니다` : el2 === '화' ? `🔥 화(火) 자녀: 적극적으로 케어하지만 지칠 수 있습니다.
- 부모 곁에 자주 찾아가 활력을 불어넣습니다
- 함께 외출하고 활동하는 것을 좋아합니다
- 다만 에너지 소모가 커서 번아웃에 주의해야 합니다
- 다른 가족과 역할 분담이 필요합니다` : el2 === '토' ? `🏔️ 토(土) 자녀: 헌신적으로 부모를 모시는 효자/효녀입니다.
- 부모의 일상을 꼼꼼히 챙깁니다
- 가까이에서 돌보려 합니다
- 때로는 자신을 희생하면서까지 돌봅니다
- 과한 책임감에 주의하고 도움을 요청하세요` : el2 === '금' ? `⚔️ 금(金) 자녀: 실질적인 도움에 강합니다.
- 재정 관리, 의료 결정 등을 담당합니다
- 감정적 표현은 서툴지만 행동으로 보여줍니다
- 효율적으로 돌봄 시스템을 구축합니다
- 부모의 감정적 필요도 살펴주세요` : `💧 수(水) 자녀: 정서적 교감으로 부모를 위로합니다.
- 부모의 외로움을 잘 알아챕니다
- 대화와 경청으로 마음을 돌봅니다
- 실질적인 도움보다 감정적 지지에 강합니다
- 다른 가족의 실질적 도움과 병행하면 좋습니다`}`
            },
            { icon: '🌟', color: 'text-amber-400', title: '이 아이가 부모에게 가르쳐주는 것',
              content: `${person2.name}님은 ${person1.name}님에게 소중한 가르침을 줍니다. 자녀는 부모의 스승이기도 합니다.

${el2 === '목' ? `🌳 목(木) 자녀가 가르쳐주는 것: "새로운 시각과 가능성"

이 아이는 부모에게 변화를 두려워하지 않는 법을 알려줍니다. "이렇게 해왔으니까"라는 관성에서 벗어나, 새로운 시도를 해볼 용기를 줍니다. 자녀의 도전을 보면서 부모도 다시 꿈꾸게 됩니다.` : el2 === '화' ? `🔥 화(火) 자녀가 가르쳐주는 것: "열정과 즐거움을 되찾는 법"

이 아이는 부모에게 삶의 즐거움을 상기시켜 줍니다. 어른이 되면서 잊었던 웃음, 신나는 감정, 순수한 기쁨을 자녀를 통해 다시 경험합니다. 함께 놀고 웃으면서 부모도 젊어집니다.` : el2 === '토' ? `🏔️ 토(土) 자녀가 가르쳐주는 것: "인내와 안정의 가치"

이 아이는 부모에게 조급함을 내려놓는 법을 알려줍니다. 빠른 성과보다 꾸준한 노력의 가치, 변하지 않는 것의 소중함을 보여줍니다. 이 아이와 함께하면 마음이 편안해집니다.` : el2 === '금' ? `⚔️ 금(金) 자녀가 가르쳐주는 것: "원칙과 절제의 중요성"

이 아이는 부모에게 기준을 지키는 것의 가치를 알려줍니다. 어른도 때로는 흔들리고 타협하고 싶을 때, 자녀의 곧은 성격을 보며 반성하게 됩니다. 이 아이는 부모를 올바르게 만듭니다.` : `💧 수(水) 자녀가 가르쳐주는 것: "감정을 표현하고 흘려보내는 법"

이 아이는 부모에게 감정에 솔직해지는 법을 알려줍니다. 어른들은 감정을 숨기고 참는 데 익숙하지만, 이 아이와 함께하면 울어도 괜찮다는 것, 약해도 괜찮다는 것을 배웁니다.`}`
            },
            { icon: '🔮', color: 'text-violet-400', title: '관계의 전환점이 되는 시기',
              content: `${person2.name}님이 성장하면서 부모-자녀 관계도 변화합니다. 중요한 전환점을 알려드립니다.

${el2 === '목' || el2 === '화' ? `⚡ 전환점: 20대 초반

${el2 === '목' ? '목(木)' : '화(火)'} 자녀는 일찍 독립을 원합니다. 20대 초반에 집을 떠나거나, 부모와 다른 길을 선택할 수 있습니다. 이때 부모가 붙잡으면 갈등이 커집니다.

조언: 놓아주세요. 멀리 가더라도 마음은 연결되어 있습니다.
이 시기를 잘 넘기면: 친구 같은 관계가 됩니다. 오히려 자주 연락하고 가까워집니다.` : el2 === '토' ? `⏰ 전환점: 20대 후반~30대

토(土) 자녀는 천천히 독립합니다. 부모 곁에 오래 있으려 하고, 급격한 변화를 피합니다. 결혼이나 취직 후에야 본격적으로 분리됩니다.

조언: 독립을 부추기기보다 자연스럽게 기다려주세요.
이 시기를 잘 넘기면: 평생 가장 든든한 지원군이 됩니다.` : `⏳ 전환점: 30대 이후

${el2 === '금' ? '금(金)' : '수(水)'} 자녀는 천천히 마음을 엽니다. 어릴 때는 속마음을 잘 드러내지 않다가, 성인이 되고 자신의 자녀를 키우면서 부모를 이해하게 됩니다.

조언: 서두르지 마세요. 시간이 지나면 저절로 가까워집니다.
이 시기를 잘 넘기면: 깊고 성숙한 관계로 발전합니다.`}`
            },
            { icon: '💕', color: 'text-rose-400', title: '부모-자녀 관계 개선을 위한 실천 조언',
              content: `${person1.name}님과 ${person2.name}님의 관계를 더 좋게 만드는 구체적인 조언입니다.

${isSanggeuk ? `⚔️ 상극 관계 개선법:
1. 서로 다른 점을 "틀림"이 아닌 "다름"으로 인정하세요
2. 변화시키려 하지 마세요. 있는 그대로 받아들이세요
3. 대화할 때 비난이 아닌 "나 전달법"을 사용하세요
4. 갈등 후에는 반드시 화해의 시간을 가지세요
5. 공통 관심사를 찾아 함께하는 시간을 만드세요` : hasChung ? `⚡ 충(冲) 관계 개선법:
1. 충돌 후에는 시간을 두고 대화하세요 (최소 24시간)
2. 감정적일 때 중요한 결정을 내리지 마세요
3. 서로의 영역을 존중하세요
4. "네가 틀렸어"가 아니라 "나는 이렇게 생각해"로 말하세요
5. 갈등을 피하지 말고, 건강하게 해결하는 법을 배우세요` : `🌟 좋은 관계 유지법:
1. 좋은 관계를 당연시하지 말고, 감사를 표현하세요
2. 적절한 거리감도 필요합니다. 너무 가까우면 질식합니다
3. 각자의 삶을 존중하세요
4. 정기적으로 대화 시간을 가지세요
5. 서로의 성장을 응원하세요`}

핵심 메시지: ${person1.name}님이 먼저 마음을 열면 ${person2.name}님도 따라옵니다. 부모가 변하면 자녀도 변합니다.`
            }
          ] : compatRelation === 'sibling' ? [
            // 형제/자매 섹션 (확장)
            { icon: '👫', color: 'text-blue-400', title: '타고난 형제/자매의 인연',
              content: `${person1.name}님과 ${person2.name}님은 같은 부모 아래 태어난 특별한 인연입니다.

${totalScore >= 70 ? `두 분은 서로에게 든든한 지원군이 되는 형제/자매입니다. ${el1}(${getElHanja(el1)})과 ${el2}(${getElHanja(el2)})의 조합은 ${isSangsaeng ? '상생 관계로, 서로에게 힘이 됩니다. 한 명이 기운이 없을 때 다른 한 명이 에너지를 불어넣어 줍니다.' : el1 === el2 ? '같은 오행으로 서로를 깊이 이해합니다. 말하지 않아도 통하는 부분이 많습니다.' : '서로 다른 강점을 가져 함께하면 완벽해집니다.'}` : `서로 다른 성향으로 때로는 부딪히지만, 그것이 서로를 단련시킵니다. ${isSanggeuk ? '상극 관계라 경쟁심이 생길 수 있지만, 이 경쟁이 두 사람 모두를 성장시킵니다.' : '다른 점이 많아 갈등이 있지만, 시간이 지나면 서로의 가치를 인정하게 됩니다.'}`}

형제/자매 관계의 특별한 점은 부모와 자녀와 달리 "수평적"이라는 것입니다. 이 수평적 관계에서 배우는 것들(협상, 양보, 경쟁, 협력)은 사회생활의 예행연습이 됩니다.`
            },
            { icon: '⚔️', color: 'text-red-400', title: hasChung ? '라이벌이자 평생의 동지' : '편안한 동반자 관계',
              content: hasChung
                ? `${br1}와 ${br2}의 충(冲)! 어릴 때 치열한 경쟁을 했을 수 있습니다.

부모의 관심을 두고 경쟁하고, 작은 일에도 승패를 가렸을 수 있습니다. "누가 더 공부를 잘하나", "누가 더 사랑받나"로 신경전을 벌였을 수도 있습니다.

하지만 이 경쟁이 두 사람을 강하게 만들었습니다. 성인이 되면 서로의 강점을 인정하는 최고의 파트너가 됩니다. 어릴 때 라이벌이었던 형제/자매가 나중에 가장 든든한 지원군이 되는 경우가 많습니다.

조언: 과거의 경쟁을 흘려보내세요. 지금은 서로 다른 영역에서 각자의 빛을 발하고 있습니다.`
                : `큰 갈등 없이 평화로운 관계를 유지합니다. 서로에게 편안한 존재입니다.

함께 있어도 부담이 없고, 오랜만에 만나도 어색하지 않습니다. 각자의 삶을 살면서도 필요할 때 연락하면 되는 관계입니다.

다만 너무 편해서 소홀해질 수 있습니다. 가까운 사이일수록 "당연하다"고 생각하지 말고 감사를 표현하세요. 명절에 연락 한 번, 생일에 축하 메시지 하나가 관계를 유지시킵니다.`
            },
            { icon: '🎭', color: 'text-purple-400', title: '가족 내 각자의 역할',
              content: `같은 부모 아래서도 형제/자매는 각자 다른 역할을 맡습니다.

${person1.name}님(${el1})은 가족 내에서 ${el1 === '목' ? '새로운 시도를 하는 개척자 역할입니다. 가족이 해보지 않은 것을 먼저 시도하고, 길을 열어줍니다.' : el1 === '화' ? '분위기 메이커 역할입니다. 가족 모임이 있으면 활기를 불어넣고, 웃음을 만들어냅니다.' : el1 === '토' ? '중재자 역할입니다. 가족 간 갈등이 있으면 사이에서 다리를 놓고, 화해를 이끌어냅니다.' : el1 === '금' ? '원칙을 세우는 사람 역할입니다. 가족의 규칙과 전통을 지키고, 옳고 그름을 판단합니다.' : '감정적 지지자 역할입니다. 가족 중 누군가 힘들면 가장 먼저 알아채고 위로합니다.'}

${person2.name}님(${el2})은 가족 내에서 ${el2 === '목' ? '성장을 이끄는 역할입니다. 새로운 가능성을 제시하고 변화를 추구합니다.' : el2 === '화' ? '활력을 주는 역할입니다. 가족에게 에너지와 열정을 전파합니다.' : el2 === '토' ? '안정을 주는 역할입니다. 가족의 든든한 버팀목이 됩니다.' : el2 === '금' ? '질서를 잡는 역할입니다. 체계와 효율을 중시합니다.' : '공감해주는 역할입니다. 가족의 감정적 필요를 채워줍니다.'}

두 역할이 조화를 이루면 가족 전체가 건강해집니다.`
            },
            { icon: '🏆', color: 'text-amber-400', title: '건강한 경쟁과 협력',
              content: `${isSanggeuk ? `상극 관계로 경쟁심이 강할 수 있습니다.

어릴 때부터 "누가 더 잘하나" 비교되었을 수 있습니다. 이 경쟁이 건강하면 서로를 성장시키지만, 지나치면 상처가 됩니다.

핵심은 "비교하지 않기"입니다. 각자의 장점이 다릅니다. ${person1.name}님은 ${el1 === '목' ? '창의성' : el1 === '화' ? '추진력' : el1 === '토' ? '안정감' : el1 === '금' ? '분석력' : '공감능력'}에서, ${person2.name}님은 ${el2 === '목' ? '성장마인드' : el2 === '화' ? '열정' : el2 === '토' ? '신뢰성' : el2 === '금' ? '체계성' : '적응력'}에서 빛납니다.

같은 분야에서 경쟁하기보다 각자의 영역을 인정하면 관계가 좋아집니다.` : isSangsaeng ? `상생 관계로 서로 밀어주고 당겨주는 좋은 팀워크를 발휘합니다.

${el1}이 ${el2}를 생(生)하는 관계로, ${person1.name}님이 ${person2.name}님에게 에너지와 영감을 주고, ${person2.name}님이 그것을 받아 성과로 만들어냅니다.

함께 무언가를 하면 시너지가 납니다. 가업을 잇거나 공동 프로젝트를 하면 좋은 결과를 얻을 수 있습니다.` : `비슷한 성향으로 협력하기 좋지만, 같은 분야에서는 경쟁이 될 수 있습니다.

같은 ${el1} 오행을 가진 형제/자매는 서로를 잘 이해하지만, 원하는 것도 비슷합니다. 같은 것을 두고 경쟁하면 갈등이 생길 수 있습니다.

해결책: 영역을 나누세요. 각자가 잘하는 분야를 정하고 그 영역에서 빛나게 해주세요.`}`
            },
            { icon: '🤫', color: 'text-pink-400', title: '비밀을 공유할 수 있는 사이',
              content: `${hasStemHap || hasYukhap ? `합(合)이 있어 서로의 비밀을 지켜주는 신뢰 관계입니다.

부모에게 말 못하는 이야기도 나눌 수 있습니다. 연애, 고민, 실수... 형제/자매에게만 털어놓는 비밀이 있습니다. 이런 비밀 공유가 두 사람을 더 가깝게 만듭니다.

조언: 이 신뢰를 지키세요. 형제/자매의 비밀을 부모에게 말하면 관계에 금이 갑니다.` : `비밀 공유에 신중해야 합니다.

모든 형제/자매가 비밀을 지켜주는 것은 아닙니다. 특히 ${el1 === '화' ? '화(火)는 열정적이라 비밀을 지키기 어려울 수 있습니다' : el2 === '금' ? '금(金)은 원칙적이라 잘못된 비밀은 부모에게 말할 수 있습니다' : '중요한 비밀은 타이밍과 상황을 잘 판단하세요'}.

조언: 정말 중요한 비밀은 먼저 "이건 비밀인데..."라고 명확히 말하고 공유하세요.`}`
            },
            { icon: '💰', color: 'text-yellow-400', title: '금전 관계와 상속',
              content: `${el1 === el2 ? `비슷한 금전관념으로 재산 문제에서 갈등이 적습니다.

같은 오행을 가진 형제/자매는 돈에 대한 생각이 비슷합니다. 저축을 중요시하거나, 투자를 좋아하거나, 소비 패턴이 유사합니다. 이 때문에 상속이나 재산 분배에서 의견 충돌이 적습니다.

조언: 그래도 미리 이야기하세요. 부모님 생전에 상속에 대해 대화하면 나중에 문제가 없습니다.` : isSanggeuk ? `금전관념이 달라 상속이나 공동 투자 시 명확한 규칙이 필요합니다.

${person1.name}님(${el1})과 ${person2.name}님(${el2})은 돈에 대한 생각이 다릅니다. 한 명은 저축을 중시하고, 다른 한 명은 투자를 좋아할 수 있습니다. 이 차이가 상속 문제에서 갈등이 될 수 있습니다.

조언: 
1. 돈 문제는 서면으로 명확히 하세요
2. 공동 투자보다 각자 관리하는 것이 안전합니다
3. 부모님 재산 문제는 미리 대화하세요` : `서로 보완적인 금전관념으로 함께 투자하면 좋은 결과를 얻을 수 있습니다.

${person1.name}님은 ${el1 === '목' ? '미래 가치를' : el1 === '화' ? '기회를' : el1 === '토' ? '안정성을' : el1 === '금' ? '가치를' : '유동성을'} 보고, ${person2.name}님은 ${el2 === '목' ? '성장 가능성을' : el2 === '화' ? '타이밍을' : el2 === '토' ? '리스크를' : el2 === '금' ? '수익률을' : '시장 흐름을'} 봅니다. 함께 결정하면 균형 잡힌 판단이 가능합니다.`}`
            },
            { icon: '👨‍👩‍👧‍👦', color: 'text-cyan-400', title: '부모님 사이에서의 역학',
              content: `형제/자매는 부모에게 각각 다른 것을 원합니다.

${person1.name}님은 부모님께 ${el1 === '화' ? '인정과 칭찬을 원합니다. "잘했다"는 말 한마디가 큰 힘이 됩니다.' : el1 === '목' ? '독립성을 인정받고 싶어합니다. 간섭보다 믿음을 원합니다.' : el1 === '토' ? '든든한 존재로 남고 싶어합니다. 가족에게 의지가 되고 싶습니다.' : el1 === '금' ? '능력으로 인정받고 싶어합니다. 성과와 실력을 인정해주길 바랍니다.' : '정서적 유대를 원합니다. 깊은 대화와 이해를 바랍니다.'}

${person2.name}님은 부모님께 ${el2 === '화' ? '관심과 사랑을 원합니다. 무관심이 가장 힘듭니다.' : el2 === '목' ? '자유와 신뢰를 원합니다. 자신의 선택을 존중해주길 바랍니다.' : el2 === '토' ? '안정적인 지지를 원합니다. 변함없는 사랑을 확인하고 싶어합니다.' : el2 === '금' ? '공정한 대우를 원합니다. 형제/자매와 비교되지 않길 바랍니다.' : '깊은 이해를 원합니다. 겉모습이 아닌 내면을 봐주길 바랍니다.'}

부모님도 이 차이를 알면 각자에게 맞는 사랑을 줄 수 있습니다.`
            },
            { icon: '🏠', color: 'text-green-400', title: '독립 후에도 이어지는 관계',
              content: `${totalScore >= 70 ? `각자 독립 후에도 자주 연락하고 만나는 가까운 사이가 됩니다.

결혼하고 자녀가 생겨도 형제/자매 관계는 변함없습니다. 오히려 자녀들(조카들)이 생기면서 새로운 유대가 생깁니다. 가족 모임이 더 풍성해지고, 어른이 되어서도 서로에게 의지합니다.

장점: 힘들 때 가장 먼저 연락하는 사람이 형제/자매입니다.` : `물리적 거리가 생기면 연락이 뜸해질 수 있습니다.

각자 바쁜 삶을 살다 보면 형제/자매와의 연락이 후순위로 밀릴 수 있습니다. 1년에 명절 두 번만 보는 사이가 될 수도 있습니다.

조언: 의식적으로 관계를 유지하세요.
- 가족 단톡방 활성화
- 명절 외에도 가끔 모임
- 서로의 생일, 기념일 챙기기
작은 노력이 관계를 유지시킵니다.`}`
            },
            { icon: '👶', color: 'text-pink-400', title: '조카/이모·삼촌 역할',
              content: `형제/자매에게 자녀가 생기면 새로운 역할이 시작됩니다.

${person1.name}님은 ${person2.name}님의 자녀에게 ${el1 === '화' ? '재미있고 활동적인 이모/삼촌이 됩니다. 조카와 함께 뛰어놀고, 새로운 경험을 시켜줍니다. 조카가 가장 좋아하는 어른이 될 수 있습니다.' : el1 === '목' ? '꿈을 키워주는 이모/삼촌이 됩니다. 조카의 가능성을 발견하고, 도전을 응원합니다. 진로 상담 역할을 하기도 합니다.' : el1 === '토' ? '든든하고 믿음직한 이모/삼촌이 됩니다. 조카에게 안정감을 주고, 필요할 때 도움을 줍니다. 부모가 바쁠 때 대신 돌봐주기도 합니다.' : el1 === '금' ? '원칙적이지만 공정한 이모/삼촌이 됩니다. 조카에게 옳고 그름을 가르치고, 규칙을 알려줍니다. 엄한 것 같지만 진심으로 걱정하는 사람입니다.' : '감성적이고 다정한 이모/삼촌이 됩니다. 조카의 감정을 잘 이해하고, 힘들 때 위로해줍니다. 조카가 마음을 터놓는 어른이 됩니다.'}

조카와의 관계도 형제/자매 관계를 강화시킵니다.`
            },
            { icon: '🆘', color: 'text-red-400', title: '위기 상황에서의 협력',
              content: `${isSangsaeng ? `상생 관계로 위기 시 서로 힘이 됩니다.

한 명이 어려우면 다른 한 명이 즉시 달려옵니다. 질병, 실직, 이혼 등 인생의 큰 위기에 가장 먼저 손 내미는 사람이 형제/자매입니다.

상생의 힘: ${el1}이 ${el2}를 생(生)하듯, 위기에 에너지를 나눠줍니다. 힘들 때 기대세요.` : hasChung ? `충(冲) 관계라 평소 갈등이 있어도 진짜 위기에는 누구보다 강하게 뭉칩니다.

평상시에는 티격태격해도, 가족 중 누군가 아프거나 큰일이 나면 모든 갈등을 잊고 함께합니다. "피는 물보다 진하다"는 말이 이럴 때 실감납니다.

충의 반전: 평소의 경쟁심이 위기 극복 에너지로 바뀝니다. "내가 해결하겠다"는 의지가 생깁니다.` : `각자의 방식으로 도움을 주려 합니다.

${person1.name}님은 ${el1 === '화' ? '즉각적인 행동으로' : el1 === '목' ? '새로운 해결책을 찾아서' : el1 === '토' ? '실질적인 도움으로' : el1 === '금' ? '체계적인 계획으로' : '정서적 지지로'} 돕고, ${person2.name}님은 ${el2 === '화' ? '에너지를 불어넣어' : el2 === '목' ? '희망을 제시해서' : el2 === '토' ? '든든한 버팀목이 되어' : el2 === '금' ? '현실적 조언으로' : '마음을 어루만져서'} 도웁니다.

조언: 필요한 도움이 무엇인지 명확히 말하면 더 효과적입니다.`}`
            },
            { icon: '🎉', color: 'text-violet-400', title: '함께하면 좋은 활동',
              content: `${el1 === '화' || el2 === '화' ? `🔥 화(火) 에너지가 있어 활동적인 것이 좋습니다!

추천: 해외여행, 파티, 콘서트, 스포츠 관람, 맛집 투어, 술자리
함께하면 에너지가 뿜뿜! 새로운 경험을 도전하세요.` : el1 === '목' || el2 === '목' ? `🌳 목(木) 에너지가 있어 성장하는 활동이 좋습니다!

추천: 등산, 트레킹, 운동, 자기계발 스터디, 새로운 취미 도전
함께 배우고 성장하는 경험이 관계를 깊게 만듭니다.` : el1 === '토' || el2 === '토' ? `🏔️ 토(土) 에너지가 있어 편안한 활동이 좋습니다!

추천: 가족 모임, 홈파티, 함께 요리하기, 가든 카페, 피크닉
익숙하고 편안한 활동에서 깊은 대화가 나옵니다.` : el1 === '금' || el2 === '금' ? `⚔️ 금(金) 에너지가 있어 품격 있는 활동이 좋습니다!

추천: 쇼핑, 미술관, 맛집 탐방, 공연 관람, 문화생활
취향이 맞는 활동을 함께하면 유대가 깊어집니다.` : `💧 수(水) 에너지가 있어 감성적인 활동이 좋습니다!

추천: 영화, 카페에서 수다, 드라이브, 힐링 여행, 온천
깊은 대화와 함께하는 시간이 관계를 단단하게 만듭니다.`}`
            },
            { icon: '👴', color: 'text-gray-400', title: '부모님 돌봄 역할 분담',
              content: `부모님이 나이 들면 형제/자매가 함께 돌봐야 합니다. 역할 분담이 중요합니다.

${el1 === '토' ? `${person1.name}님이 일상적 케어를 담당하면 좋습니다. 토(土)는 꾸준함과 인내가 있어 매일의 돌봄에 적합합니다.` : ''} 
${el2 === '토' ? `${person2.name}님이 일상적 케어를 담당하면 좋습니다.` : ''} 
${el1 === '금' ? `${person1.name}님이 재정/의료 관리를 담당하면 좋습니다. 금(金)은 체계적이고 논리적이라 복잡한 결정에 강합니다.` : ''} 
${el2 === '금' ? `${person2.name}님이 재정/의료 관리를 담당하면 좋습니다.` : ''}
${el1 === '화' || el2 === '화' ? `화(火)가 있는 분은 부모님께 활력을 불어넣는 역할을 하면 좋습니다. 자주 찾아뵙고 즐거운 시간을 만들어주세요.` : ''}
${el1 === '수' || el2 === '수' ? `수(水)가 있는 분은 부모님의 감정적 필요를 채워주세요. 대화하고 들어주는 것만으로도 큰 힘이 됩니다.` : ''}

핵심: 역할을 명확히 나누면 부담이 줄어들고 갈등도 예방됩니다. 정기적으로 형제/자매끼리 모여서 상황을 공유하세요.`
            },
            { icon: '💕', color: 'text-rose-400', title: '형제/자매 관계 개선 조언',
              content: `${hasChung ? `충(冲) 관계 개선법:

어릴 때 갈등은 흘려보내세요. 과거에 상처를 줬던 말과 행동을 붙잡고 있으면 관계가 발전하지 않습니다.

1. "그때 그랬잖아"는 금물입니다
2. 지금의 관계에 집중하세요
3. 새로운 추억을 만드세요
4. 부모님 앞에서 경쟁하지 마세요
5. 서로의 가정을 존중하세요` : isSanggeuk ? `상극 관계 개선법:

서로 다름을 인정하고, 비교하지 마세요.

1. "넌 왜 그래"가 아니라 "넌 그렇구나"로 말하세요
2. 부모님이 비교해도 신경 쓰지 마세요
3. 각자의 장점을 인정하세요
4. 경쟁보다 협력을 선택하세요
5. 명절에 얼굴 붉히지 마세요` : `좋은 관계 유지법:

좋은 관계를 당연시하지 말고, 감사를 표현하세요.

1. 바빠도 연락하세요. 안부 문자 하나면 됩니다
2. 생일, 기념일을 챙기세요
3. 어려울 때 먼저 손 내미세요
4. 형제/자매의 가족도 내 가족처럼 대하세요
5. 부모님 이야기를 자주 나누세요`}

명절마다 연락하는 것만으로도 관계가 유지됩니다. 형제/자매는 평생의 동반자입니다.`
            }
          ] : compatRelation === 'friend' ? [
            // 친구 섹션 (대폭 확장)
            { icon: '🤝', color: 'text-blue-400', title: '우연히 만난 필연적 인연',
              content: `${person1.name}님과 ${person2.name}님의 만남은 우연이 아닙니다.

${totalScore >= 70 ? `두 분은 만나자마자 통하는 천생 친구입니다. ${el1}(${getElHanja(el1)})과 ${el2}(${getElHanja(el2)})의 조합은 ${isSangsaeng ? '상생 관계로, 함께 있으면 서로에게 에너지를 주는 관계입니다. 한 명이 지치면 다른 한 명이 힘을 불어넣어 주고, 기쁜 일이 있으면 함께 기뻐해주는 최고의 친구입니다.' : el1 === el2 ? '같은 오행으로, 마치 오래 알고 지낸 것처럼 편안합니다. 취향, 생각, 웃음 포인트까지 비슷해서 "우리 전생에 친구였나?"라는 생각이 들 정도입니다.' : '서로 다른 에너지지만 절묘하게 맞아떨어지는 케미입니다.'}` : `처음에는 어색할 수 있지만, 알아갈수록 깊어지는 관계입니다. ${isSanggeuk ? '상극 관계라 처음엔 "저 사람 왜 저래?"라고 생각할 수 있습니다. 하지만 시간이 지나면 서로의 다른 점이 오히려 매력으로 느껴집니다.' : '서로를 이해하는 데 시간이 필요하지만, 한번 친해지면 오래가는 우정이 됩니다.'}`}

진정한 친구는 인생에 몇 명 없습니다. 이 인연을 소중히 여기세요.`
            },
            { icon: '💬', color: 'text-green-400', title: hasStemHap ? '말 안 해도 아는 사이' : '대화가 필요한 관계',
              content: hasStemHap
                ? `${STEMS.names[r1.dsi]}(${STEMS.korean[r1.dsi]})과 ${STEMS.names[r2.dsi]}(${STEMS.korean[r2.dsi]})의 천간합! 서로의 생각을 말하지 않아도 알아챕니다.

눈빛만 봐도 "야, 나가자" "응, 나도 그 생각" 하는 사이입니다. 카톡 읽씹해도 서운하지 않고, 오랜만에 만나도 어제 만난 것처럼 편합니다.

이런 친구의 특징:
- 연락 안 해도 서로 생각하고 있다는 걸 압니다
- 힘들 때 먼저 연락이 옵니다
- 말 안 해도 표정만 봐도 기분을 압니다
- 같이 있어도 침묵이 어색하지 않습니다

평생 함께할 베프입니다. 이 인연 놓치지 마세요.`
                : `오해를 피하려면 적극적으로 대화하세요.

${person1.name}님과 ${person2.name}님은 "당연히 알겠지"가 통하지 않는 사이입니다. 내가 서운한 걸 말 안 해도 알아줄 거라 기대하면 실망합니다.

소통 팁:
- 서운하면 바로 말하세요. 쌓아두면 폭발합니다
- "왜 그랬어?"보다 "나는 이렇게 느꼈어"로 말하세요
- 중요한 이야기는 카톡보다 만나서 하세요
- 가끔은 "우리 사이에 불편한 거 없어?"라고 체크하세요

대화만 잘하면 오래가는 우정이 됩니다.`
            },
            { icon: '🎯', color: 'text-purple-400', title: '서로에게 배우는 것들',
              content: `좋은 친구는 서로를 성장시킵니다. 두 분이 서로에게 주는 영향을 살펴볼게요.

${person1.name}님(${el1})이 ${person2.name}님에게 주는 것:
${el1 === '목' ? `🌳 도전정신과 성장 마인드를 심어줍니다. "해보지 뭐!", "넌 할 수 있어!"라며 용기를 북돋아 줍니다. ${person2.name}님이 새로운 시도를 두려워할 때 등을 밀어주는 친구입니다.` : el1 === '화' ? `🔥 열정과 추진력을 전염시킵니다. 함께 있으면 에너지가 솟고, 뭐든 할 수 있을 것 같은 기분이 듭니다. 우울할 때 기분을 확 바꿔주는 비타민 같은 친구입니다.` : el1 === '토' ? `🏔️ 신중함과 안정감을 줍니다. 흥분해서 달려나갈 때 "잠깐, 다시 생각해봐"라고 브레이크 역할을 합니다. 현실적인 조언으로 실수를 줄여주는 친구입니다.` : el1 === '금' ? `⚔️ 원칙과 절제를 가르쳐줍니다. 나쁜 습관을 고치거나, 목표를 향해 꾸준히 나아가도록 도와줍니다. 쓴소리도 할 수 있는 진정한 친구입니다.` : `💧 유연함과 공감능력을 보여줍니다. 힘들 때 말 없이 옆에 있어주고, 판단 없이 들어주는 친구입니다. 마음이 복잡할 때 정리해주는 상담사 같은 친구입니다.`}

${person2.name}님(${el2})이 ${person1.name}님에게 주는 것:
${el2 === '목' ? `🌳 성장 마인드와 새로운 관점을 줍니다. 고정관념을 깨고 다르게 생각하는 법을 알려줍니다.` : el2 === '화' ? `🔥 긍정적 에너지와 활력을 줍니다. 함께 있으면 웃을 일이 많아지고, 삶이 즐거워집니다.` : el2 === '토' ? `🏔️ 현실적 조언과 든든한 지지를 줍니다. 불안할 때 "괜찮아, 잘 될 거야"라고 안심시켜 줍니다.` : el2 === '금' ? `⚔️ 객관적 시각과 냉정한 분석을 줍니다. 감정에 휩쓸릴 때 팩트로 정신 차리게 해줍니다.` : `💧 감성적 위로와 깊은 공감을 줍니다. 세상 누구보다 내 마음을 잘 알아주는 친구입니다.`}`
            },
            { icon: '⚡', color: 'text-red-400', title: hasChung ? '싸우면서 친해지는 타입' : '평화로운 우정',
              content: hasChung
                ? `${br1}와 ${br2}의 충(冲)! 의견 충돌이 잦은 관계입니다.

"야, 그건 아니지!" "뭐? 네가 틀렸어!" 이런 대화가 자주 오갑니다. 주변에서 보면 "쟤네 싸우나?"라고 생각할 정도로 격한 토론을 벌이기도 합니다.

하지만 이게 두 분의 우정 방식입니다. 싸운 후 더 가까워지고, 서로에게 직언을 해주는 진정한 친구 사이입니다. 가짜 친구는 비위를 맞춰주지만, 진짜 친구는 틀린 것은 틀렸다고 말해줍니다.

충(冲) 친구와의 관계 팁:
- 싸워도 24시간 안에 연락하세요
- 감정이 격해지면 잠시 쉬고 다시 이야기하세요
- "네 말도 일리 있어"라고 인정해주세요
- 싸운 후에는 꼭 밥이나 술 한잔 하세요`
                : `큰 갈등 없이 오래 가는 편안한 우정입니다.

${person1.name}님과 ${person2.name}님은 크게 싸운 적이 거의 없을 거예요. 의견이 다르면 "그래, 네 생각도 그렇구나"하고 넘어가는 성숙한 관계입니다.

다만, 너무 편해서 "진짜 속마음"을 말 못하는 경우가 있을 수 있어요. 친구가 잘못된 선택을 해도 "니 인생이니까..."하고 넘어가면 진정한 우정이 아닙니다.

조언: 가끔은 불편해도 솔직한 피드백을 주고받으세요. "이건 좀 아닌 것 같아"라고 말할 수 있어야 진짜 친구입니다.`
            },
            { icon: '🍻', color: 'text-amber-400', title: '함께하면 좋은 활동',
              content: `${el1 === '화' || el2 === '화' ? `🔥 화(火) 에너지가 있는 두 분! 신나는 활동이 최고입니다.

추천 활동:
- 클럽, 파티, 페스티벌 함께 가기
- 스포츠 관람하며 열광하기
- 노래방에서 목 터지게 노래하기
- 해외여행에서 새로운 모험하기
- 맛집 탐방하며 먹방 찍기

함께 있으면 에너지가 폭발합니다. 가만히 앉아있기보다 움직이는 활동을 하세요!` : el1 === '목' || el2 === '목' ? `🌳 목(木) 에너지가 있는 두 분! 성장하는 활동이 좋습니다.

추천 활동:
- 등산, 트레킹, 캠핑
- 함께 운동하며 다이어트 도전
- 새로운 취미 같이 배우기
- 자기계발 스터디 그룹
- 해외여행으로 견문 넓히기

함께 성장하는 경험이 우정을 더 깊게 만듭니다.` : el1 === '토' || el2 === '토' ? `🏔️ 토(土) 에너지가 있는 두 분! 편안한 활동이 좋습니다.

추천 활동:
- 맛집 탐방하며 맛있는 거 먹기
- 홈파티에서 수다 떨기
- 함께 요리하며 시간 보내기
- 넷플릭스 보며 치맥하기
- 카페에서 오랜 시간 대화하기

특별한 걸 안 해도 같이 있는 것만으로 좋은 사이입니다.` : el1 === '금' || el2 === '금' ? `⚔️ 금(金) 에너지가 있는 두 분! 품격 있는 활동이 좋습니다.

추천 활동:
- 쇼핑하며 서로 스타일 조언
- 전시회, 미술관, 공연 관람
- 파인다이닝에서 특별한 식사
- 와인 테이스팅
- 골프, 테니스 등 함께 운동

취향이 맞는 활동을 함께하면 유대가 더 깊어집니다.` : `💧 수(水) 에너지가 있는 두 분! 감성적인 활동이 좋습니다.

추천 활동:
- 감성 카페에서 깊은 대화
- 영화 보고 감상 나누기
- 바다, 호수 등 물가로 힐링 여행
- 드라이브하며 음악 듣기
- 온천, 스파에서 피로 풀기

양보다 질! 깊이 있는 시간을 보내는 것이 두 분에게 맞습니다.`}`
            },
            { icon: '💰', color: 'text-yellow-400', title: '돈 문제와 우정',
              content: `"돈 때문에 친구를 잃는다"는 말이 있습니다. 두 분의 금전 궁합을 살펴볼게요.

${el1 === el2 ? `같은 ${el1} 오행이라 금전관념이 비슷합니다!

더치페이든 한턱이든 자연스럽게 흘러갑니다. "이번엔 내가 낼게" "아니야, 지난번에 네가 냈잖아" 하며 서로 배려합니다. 돈 문제로 불편해질 일이 거의 없습니다.

공동 지출(여행, 선물 등)도 의견이 잘 맞아서 "얼마짜리로 할까?"에서 크게 다투지 않습니다.` : isSanggeuk ? `상극 관계라 금전관념이 다릅니다. 주의가 필요해요.

${el1 === '화' || el2 === '화' ? '한쪽은 "YOLO! 인생은 한 번뿐"이고, 다른 한쪽은 "아껴야 잘 산다"일 수 있습니다.' : '소비 습관, 투자 관념 등이 달라서 의견 충돌이 있을 수 있습니다.'}

⚠️ 주의사항:
- 큰 금액을 빌려주지 마세요. 우정에 금이 갑니다
- 빌려줬으면 돌려받을 거라 기대하지 마세요
- 공동 지출은 미리 명확하게 정하세요
- 돈 문제로 불편하면 바로 이야기하세요

돈보다 우정이 중요합니다. 돈 때문에 소중한 친구를 잃지 마세요.` : `서로 다른 금전관념이지만 보완적입니다.

한 명이 "이거 사자!"하면 다른 한 명이 "잠깐, 이거 더 싼 데 있어"라고 균형을 맞춰줍니다. 함께 쇼핑하면 충동구매도 줄이고 좋은 것도 사게 됩니다.

공동 지출할 때는 각자 역할을 나누면 좋습니다:
- ${el1 === '금' || el2 === '금' ? '금(金)이 있는 분이 가격 비교와 예산 관리를' : '한 명이 정보 수집을'}
- ${el1 === '토' || el2 === '토' ? '토(土)가 있는 분이 실제 결제와 관리를' : '다른 한 명이 최종 결정을'}
이렇게 나누면 효율적입니다.`}`
            },
            { icon: '💔', color: 'text-pink-400', title: '연애 상담, 누가 더 잘할까?',
              content: `친구에게 연애 상담받을 때, 각자의 스타일이 있습니다.

${person1.name}님(${el1})의 연애 상담 스타일:
${el1 === '화' ? `🔥 "걔가 문제야! 네가 뭘 잘못했어!" 무조건 내 편을 들어주는 응원단장 스타일입니다. 기분은 좋아지지만 객관적 조언은 기대하기 어렵습니다.` : el1 === '목' ? `🌳 "이 기회에 더 좋은 사람 만나!" 미래지향적 조언을 합니다. 현재 감정보다 앞으로 어떻게 할지에 집중합니다.` : el1 === '토' ? `🏔️ "근데 현실적으로 생각해봐..." 감정을 추스르게 해주고, 실제로 어떻게 해야 할지 조언합니다. 든든한 상담사 스타일입니다.` : el1 === '금' ? `⚔️ "솔직히 말할게. 네가 이런 점은 고쳐야 해." 냉정한 팩트폭격을 합니다. 듣기 싫을 수 있지만 정곡을 찌릅니다.` : `💧 "힘들었겠다... 얼마나 속상했어..." 감정적 공감 위주입니다. 판단하지 않고 그냥 들어주는 스타일입니다.`}

${person2.name}님(${el2})의 연애 상담 스타일:
${el2 === '화' ? `🔥 열정적으로 응원하고, 직접 행동까지 도와주려 합니다. "내가 걔한테 대신 말해줄까?"` : el2 === '목' ? `🌳 긍정적 방향을 제시합니다. "이건 오히려 기회야!"라며 희망을 줍니다.` : el2 === '토' ? `🏔️ 든든하게 지지해줍니다. "뭘 하든 내가 옆에 있을게."` : el2 === '금' ? `⚔️ 객관적으로 분석해줍니다. "상대방 입장에서 생각해보면..."` : `💧 따뜻하게 위로해줍니다. "울고 싶으면 울어. 내가 있잖아."`}

두 가지 스타일 다 필요합니다. 상황에 따라 맞는 친구에게 상담하세요!`
            },
            { icon: '🤫', color: 'text-violet-400', title: '비밀을 지켜줄 수 있는 친구?',
              content: `${hasStemHap || hasYukhap ? `합(合)이 있어 비밀을 잘 지키는 사이입니다!

두 분 사이에는 무거운 비밀도 공유할 수 있습니다. 회사에서 있었던 일, 가족 문제, 연애 이야기... 다른 사람에게는 절대 말 못하는 것도 이 친구에게는 털어놓을 수 있습니다.

신뢰의 조건:
- 말 안 해도 비밀인 건 비밀로 지킵니다
- 다른 친구들 앞에서 언급하지 않습니다
- 나중에 "그때 그랬잖아"라고 들추지 않습니다
- 필요하면 무덤까지 가져갑니다

이런 친구 평생 몇 명 없습니다. 소중히 여기세요.` : el1 === '금' || el2 === '금' ? `금(金) 에너지가 있어 원칙적인 면이 있습니다.

비밀은 지키지만, "이건 네가 잘못한 거야"라고 지적할 수 있습니다. 또한 도덕적으로 문제가 있는 비밀은 지키기 어려워합니다.

예를 들어:
- 연애 비밀 → 잘 지킵니다
- 회사 뒷담화 → 지키지만 동조는 안 합니다
- 불법/비윤리적 일 → 말리고, 필요하면 다른 사람에게 말할 수 있습니다

진정한 친구는 비밀을 지켜주되, 잘못된 길로 가면 막아주는 친구입니다.` : `비밀 공유에 신중할 필요가 있습니다.

모든 친구에게 모든 비밀을 말할 필요는 없습니다. 특히:
- 다른 친구들과 공유하는 친구 → 비밀이 새어나갈 수 있습니다
- 술자리에서 말이 많아지는 친구 → 실수로 말할 수 있습니다
- SNS 활동이 활발한 친구 → 의도치 않게 노출될 수 있습니다

비밀을 말하기 전에 "이건 우리만 아는 거야"라고 명확히 말하세요. 그래도 불안하면 정말 중요한 비밀은 혼자 간직하는 것도 방법입니다.`}`
            },
            { icon: '🆘', color: 'text-red-400', title: '위기의 순간, 진정한 친구',
              content: `진정한 친구는 위기에 진가를 발휘합니다.

${isSangsaeng ? `상생 관계! 어려울 때 진가를 발휘하는 친구입니다.

${el1}이 ${el2}를 생(生)하듯, 한 명이 힘들면 다른 한 명이 에너지를 나눠줍니다. 말 안 해도 "요즘 좀 힘들어 보이는데, 뭐 있어?"라고 먼저 물어봐 주는 친구입니다.

이 친구가 해주는 것:
- 밤새 전화 받아줍니다
- 필요하면 달려옵니다
- 경제적으로 도울 수 있으면 돕습니다
- 해결책을 함께 고민합니다
- 그냥 옆에 있어줍니다

이런 친구가 있다는 것 자체가 축복입니다.` : hasChung ? `충(冲) 관계! 평소 티격태격해도 진짜 힘들 때는 달라집니다.

평상시에는 "야, 네가 그러니까 그렇지" 하던 친구가, 진짜 위기에는 "일단 내가 갈게. 어디야?"라고 합니다. 장난치고 싸우던 관계가 위기에는 가장 든든한 지원군이 됩니다.

충(冲) 친구의 특징:
- 위기에 가장 먼저 연락 옵니다
- 직접적으로 도우려 합니다
- "왜 나한테 말 안 했어!"라고 합니다
- 해결될 때까지 옆에 있습니다

싸우는 건 애정의 표현입니다. 이 친구가 없어지면 허전할 거예요.` : `도움이 필요하면 솔직하게 말하세요.

${person1.name}님과 ${person2.name}님은 서로 힘든 걸 티 안 내는 스타일일 수 있습니다. "괜찮아"라고 하면 진짜 괜찮은 줄 압니다.

조언:
- 힘들면 "나 지금 좀 힘들어"라고 먼저 말하세요
- 구체적으로 뭘 도와줬으면 좋겠는지 말하세요
- 도움받으면 나중에 꼭 갚으세요 (마음으로라도)
- 서로 힘든 티를 내도 되는 사이가 되세요

진정한 우정은 약한 모습도 보여줄 수 있는 관계입니다.`}`
            },
            { icon: '⏰', color: 'text-cyan-400', title: '오래가는 우정의 비결',
              content: `10년, 20년 가는 우정을 만들려면 어떻게 해야 할까요?

${el1 === '토' || el2 === '토' ? `🏔️ 토(土) 에너지가 있어 꾸준함이 비결입니다.

자주 못 만나도 괜찮습니다. 1년에 두세 번만 만나도, 그 사이에 안부 문자 몇 개만 있어도 우정은 유지됩니다. 중요한 건 "잊지 않았다"는 표시입니다.

실천 방법:
- 생일에 축하 메시지 보내기
- 명절에 안부 인사하기  
- SNS에 올라온 좋은 소식에 반응하기
- 가끔 "요즘 어때?"라고 먼저 연락하기

거창한 게 아니라 작은 연결고리를 유지하는 것이 비결입니다.` : el1 === '수' || el2 === '수' ? `💧 수(水) 에너지가 있어 깊은 대화가 비결입니다.

자주 만나는 것보다 깊이 있게 만나는 것이 중요합니다. 일 년에 한 번 만나도 밤새 이야기하면 그 친구와의 우정은 유지됩니다.

실천 방법:
- 만나면 근황 체크로 끝내지 말고 진짜 이야기를 나누세요
- "요즘 뭐 고민 있어?"라고 물어보세요
- 나도 솔직하게 속마음을 이야기하세요
- 시간이 없으면 전화라도 하세요

양보다 질! 깊이 있는 관계가 오래갑니다.` : `함께하는 추억을 계속 만드세요.

우정은 추억으로 유지됩니다. "그때 우리 그랬었지?"라고 웃으며 떠올릴 기억이 많을수록 우정이 단단해집니다.

실천 방법:
- 일 년에 한 번은 특별한 것을 함께하세요 (여행, 콘서트 등)
- 사진을 많이 찍어두세요
- 기념일을 만드세요 (우정 기념일, 첫 만남 기념일 등)
- 같이 새로운 것을 도전하세요

추억이 쌓일수록 우정도 깊어집니다.`}`
            },
            { icon: '👨‍👩‍👧', color: 'text-gray-400', title: '결혼 후 달라지는 관계',
              content: `${totalScore >= 70 ? `결혼 후에도 변함없이 이어지는 우정입니다!

두 분의 관계는 결혼한다고 달라지지 않습니다. 오히려 가족 단위로 만나며 더 풍성해질 수 있습니다.

변화 예상:
- 만남 빈도: 줄어들 수 있지만 질은 유지됩니다
- 대화 주제: 연애에서 결혼, 육아로 바뀝니다
- 만남 형태: 부부 동반, 가족 동반으로 확대됩니다
- 역할 변화: 서로의 결혼 생활 조언자가 됩니다

조언:
- 배우자에게 이 친구의 소중함을 이야기하세요
- 가끔은 둘만의 시간도 가지세요
- 배우자끼리도 친해지면 더 좋습니다` : `결혼 후 자연스럽게 연락이 뜸해질 수 있습니다.

현실입니다. 결혼하면 배우자, 시댁/처가, 아이 등 우선순위가 바뀝니다. 친구는 후순위로 밀릴 수밖에 없습니다.

하지만 포기하지 마세요:
- 결혼해도 "내 친구"는 필요합니다
- 배우자에게 말 못하는 이야기를 나눌 사람이 필요합니다
- 나만의 세계를 유지해야 건강합니다

실천 방법:
- 한 달에 한 번은 친구 만나는 시간을 확보하세요
- 배우자에게 양해를 구하세요
- 단톡방이라도 활발히 유지하세요
- 서로의 결혼 생활을 응원하세요`}`
            },
            { icon: '👥', color: 'text-blue-400', title: '그룹 내 역할',
              content: `친구 그룹에서 두 분은 각자 다른 역할을 합니다.

${person1.name}님(${el1})의 역할:
${el1 === '화' ? `🔥 분위기 메이커! 모임에 활기를 불어넣습니다. 이 친구가 없으면 모임이 심심합니다.` : el1 === '목' ? `🌳 새 활동 제안자! "이번엔 여기 가보자", "이거 해볼까?" 새로운 아이디어를 냅니다.` : el1 === '토' ? `🏔️ 모임 총무! 장소 예약, 회비 관리 등 실무를 맡습니다. 이 친구 덕에 모임이 돌아갑니다.` : el1 === '금' ? `⚔️ 일정 관리자! "이 날 되는 사람?" 스케줄을 조율하고 공지합니다.` : `💧 갈등 중재자! 그룹 내 갈등이 생기면 사이에서 조율합니다.`}

${person2.name}님(${el2})의 역할:
${el2 === '화' ? `🔥 에너지 뿜뿜! 모임의 텐션을 올리고 모두를 신나게 합니다.` : el2 === '목' ? `🌳 아이디어 뱅크! 재미있는 것들을 많이 알고 제안합니다.` : el2 === '토' ? `🏔️ 든든한 뒷배! 모임의 안정을 책임집니다.` : el2 === '금' ? `⚔️ 팩트체커! 잘못된 정보를 바로잡고 정확하게 합니다.` : `💧 분위기 리더! 모두가 편하게 이야기할 수 있는 분위기를 만듭니다.`}

두 역할이 합쳐지면 그룹이 더 재밌고 탄탄해집니다!`
            },
            { icon: '💕', color: 'text-rose-400', title: '우정을 더 깊게 하려면',
              content: `${person1.name}님과 ${person2.name}님의 우정을 더 깊게 만드는 조언입니다.

${hasChung ? `⚡ 충(冲) 관계 우정 깊이 팁:

1. 솔직한 대화를 두려워하지 마세요
   - 진정한 친구는 직언도 받아들입니다
   - "이건 좀 아닌 것 같아"라고 말할 수 있어야 합니다

2. 싸워도 관계 끊지 마세요
   - 충돌은 관계의 끝이 아니라 깊어지는 과정입니다
   - 화해하면 더 단단해집니다

3. 서로의 다름을 인정하세요
   - "넌 왜 그래?"가 아니라 "넌 그렇구나"
   - 바꾸려 하지 말고 이해하려 하세요` : isSanggeuk ? `⚔️ 상극 관계 우정 깊이 팁:

1. 서로 다른 점을 존중하세요
   - 다양성이 우정을 풍요롭게 합니다
   - 같은 점보다 다른 점에서 배울 게 많습니다

2. 비교하지 마세요
   - "넌 왜 나처럼 안 해?"는 금물입니다
   - 각자의 방식을 인정하세요

3. 갈등은 빨리 풀어요
   - 쌓아두면 폭발합니다
   - 불편하면 바로 이야기하세요` : `🌟 조화로운 관계 우정 깊이 팁:

1. 당연하게 생각하지 마세요
   - 좋은 관계일수록 소홀해지기 쉽습니다
   - 고마움을 자주 표현하세요

2. 새로운 경험을 함께하세요
   - 익숙함에 안주하면 관계가 정체됩니다
   - 함께 새로운 것을 도전하세요

3. 깊은 대화를 나누세요
   - 근황 체크만 하지 말고 속마음을 나누세요
   - 서로의 꿈, 고민, 두려움을 이야기하세요`}

좋은 친구는 인생의 보물입니다. 이 인연 소중히 여기세요!`
            }
          ] : compatRelation === 'business' ? [
            // 직장/비즈니스 섹션 (대폭 확장)
            { icon: '💼', color: 'text-blue-400', title: '비즈니스 파트너로서의 궁합',
              content: `${person1.name}님과 ${person2.name}님의 비즈니스 궁합을 분석합니다.

${totalScore >= 70 ? `두 분은 서로의 부족한 부분을 채워주는 최고의 비즈니스 파트너입니다! ${el1}(${getElHanja(el1)})과 ${el2}(${getElHanja(el2)})의 조합은 ${isSangsaeng ? '상생 관계로, 한 사람의 아이디어가 다른 사람의 실행력으로 이어집니다. 1+1=3의 시너지를 낼 수 있습니다.' : el1 === el2 ? '같은 오행으로 방향성이 일치합니다. 의사결정이 빠르고 실행력이 뛰어납니다.' : '서로 다른 강점을 가져 완벽한 팀을 이룹니다.'}` : `서로 다른 업무 스타일로 조율이 필요하지만, 다양성이 시너지가 될 수 있습니다. ${isSanggeuk ? '상극 관계라 의견 충돌이 있을 수 있지만, 이것이 오히려 위험을 줄이고 균형 잡힌 의사결정을 하게 합니다.' : '서로의 차이를 인정하고 역할을 명확히 나누면 좋은 팀이 됩니다.'}`}

비즈니스 파트너십의 핵심은 "신뢰"와 "역할 분담"입니다. 서로 잘하는 것을 하고, 못하는 것은 맡기세요.`
            },
            { icon: '🎯', color: 'text-green-400', title: '업무 스타일 비교',
              content: `두 분의 업무 스타일을 상세히 분석해드립니다.

${person1.name}님(${el1})의 업무 스타일:
${el1 === '목' ? `🌳 목(木) - 창의적이고 도전적
- 새로운 아이디어와 기획에 강합니다
- "이렇게 해보면 어떨까?"가 입버릇
- 변화와 혁신을 두려워하지 않습니다
- 장기적 비전을 설정하는 데 뛰어납니다
- 단점: 디테일한 실행에 약할 수 있음` : el1 === '화' ? `🔥 화(火) - 추진력 있고 열정적
- 일단 시작하고 보는 행동파
- 영업, 프레젠테이션, 협상에 강합니다
- 팀의 에너지와 분위기를 이끕니다
- 빠른 의사결정과 실행이 가능합니다
- 단점: 꼼꼼한 검토가 부족할 수 있음` : el1 === '토' ? `🏔️ 토(土) - 신중하고 안정적
- 실무와 운영에 강합니다
- 위험을 최소화하고 안정적으로 진행
- 팀원들에게 신뢰받는 스타일
- 꾸준하고 일관된 성과를 냅니다
- 단점: 변화에 대한 저항이 있을 수 있음` : el1 === '금' ? `⚔️ 금(金) - 체계적이고 원칙적
- 분석, 재무, 법무에 강합니다
- 정확하고 논리적인 의사결정
- 품질과 원칙을 중시합니다
- 문제점을 날카롭게 파악합니다
- 단점: 유연성이 부족할 수 있음` : `💧 수(水) - 유연하고 적응력 있음
- 협력, 조율, HR에 강합니다
- 상황에 따라 유연하게 대처
- 사람들의 마음을 잘 읽습니다
- 갈등 중재와 팀 화합에 뛰어남
- 단점: 결단력이 부족할 수 있음`}

${person2.name}님(${el2})의 업무 스타일:
${el2 === '목' ? `🌳 목(木) - 성장지향적, 전략적 사고` : el2 === '화' ? `🔥 화(火) - 행동파, 열정적 실행` : el2 === '토' ? `🏔️ 토(土) - 실무형, 안정적 운영` : el2 === '금' ? `⚔️ 금(金) - 분석형, 정밀한 검토` : `💧 수(水) - 협력형, 유연한 대처`}`
            },
            { icon: '⚔️', color: 'text-red-400', title: hasChung ? '의견 충돌과 건설적 갈등' : '원활한 협업',
              content: hasChung
                ? `${br1}와 ${br2}의 충(冲)! 비즈니스에서 의견 충돌이 잦을 수 있습니다.

하지만 이것이 나쁜 것만은 아닙니다!

비즈니스에서 충(冲)의 장점:
✅ 다양한 관점을 확보할 수 있습니다
✅ 위험 요소를 미리 발견합니다
✅ 결정 전에 충분한 검토가 이루어집니다
✅ 한쪽으로 치우친 결정을 방지합니다

충돌 관리법:
1. 감정을 배제하고 데이터로 대화하세요
2. "네가 틀렸어"가 아니라 "이 데이터는 이렇게 말하고 있어"
3. 의견 충돌이 있으면 제3자(고문, 멘토)의 의견을 참고하세요
4. 최종 결정권자를 미리 정해두세요
5. 한번 결정되면 반대했어도 협력하세요

충돌을 잘 관리하면 오히려 더 현명한 결정을 내릴 수 있습니다.`
                : `큰 갈등 없이 원활하게 협업할 수 있습니다.

${el1}과 ${el2}의 조합은 자연스럽게 조화를 이룹니다. 회의 시간이 짧고, 의사결정이 빠릅니다.

다만 주의할 점:
⚠️ 너무 잘 맞아서 "그래, 좋아"만 하면 위험합니다
⚠️ 아무도 반대하지 않으면 큰 실수를 놓칠 수 있습니다
⚠️ 가끔은 의도적으로 반대 의견을 내보세요

건설적인 비판도 필요합니다:
- 정기적으로 "이 방향이 맞나?" 점검하세요
- 외부 전문가의 검토를 받으세요
- 최악의 시나리오도 함께 고민하세요`
            },
            { icon: '📊', color: 'text-purple-400', title: '각자 강점을 살린 역할 분담',
              content: `성공적인 비즈니스 파트너십의 핵심은 역할 분담입니다.

${person1.name}님(${el1})에게 맡기면 좋은 업무:
${el1 === '목' ? `🌳 기획/전략/개발
- 신사업 기획
- 상품/서비스 개발
- 중장기 전략 수립
- 시장 트렌드 분석
- 혁신 프로젝트 리드` : el1 === '화' ? `🔥 마케팅/영업/대외
- 영업 및 거래처 관리
- 프레젠테이션/발표
- 마케팅 캠페인
- 네트워킹/인맥 관리
- 위기 대응/PR` : el1 === '토' ? `🏔️ 운영/관리/총무
- 일상 운영 관리
- 인력/자원 관리
- 프로세스 개선
- 안정적 성장 관리
- 리스크 관리` : el1 === '금' ? `⚔️ 재무/법무/품질
- 재무 관리/분석
- 계약서 검토
- 품질 관리
- 감사/컴플라이언스
- 원가 절감` : `💧 HR/협력/고객
- 인사/채용
- 팀 빌딩/조직 문화
- 고객 서비스
- 파트너십 관리
- 내부 갈등 조율`}

${person2.name}님(${el2})에게 맡기면 좋은 업무:
${el2 === '목' ? `전략/혁신/R&D` : el2 === '화' ? `홍보/대외활동/영업` : el2 === '토' ? `총무/지원/운영` : el2 === '금' ? `품질/감사/재무` : `협력/조율/CS`}

⚠️ 역할은 명확히 나누되, 최종 결정은 함께 하세요.`
            },
            { icon: '💰', color: 'text-yellow-400', title: '금전/투자 관련 의사결정',
              content: `비즈니스에서 돈 문제는 가장 민감합니다. 두 분의 금전 궁합을 살펴봅니다.

${isSanggeuk ? `⚠️ 상극 관계: 금전관에 차이가 있습니다.

${el1 === '화' || el2 === '화' ? '화(火)는 "투자해서 키우자!"' : ''} ${el1 === '금' || el2 === '금' ? '금(金)은 "리스크를 줄이자!"' : ''} ${el1 === '토' || el2 === '토' ? '토(土)는 "안정적으로 가자"' : ''} ${el1 === '수' || el2 === '수' ? '수(水)는 "상황 봐서 결정하자"' : ''} ${el1 === '목' || el2 === '목' ? '목(木)은 "성장에 투자하자!"' : ''}

의견이 다를 때:
1. 감정이 아닌 데이터로 대화하세요
2. ROI, 리스크 분석 등 객관적 자료를 준비하세요
3. 제3자(회계사, 재무 전문가)의 의견을 참고하세요
4. 큰 금액은 동의 없이 집행하지 마세요
5. 투자 한도를 미리 정해두세요` : isSangsaeng ? `✅ 상생 관계: 재정 관련 의사결정이 원활합니다.

${el1}이 ${el2}를 생(生)하듯, 한 사람이 아이디어를 내면 다른 사람이 현실화합니다. 자금 운용에서도 시너지가 납니다.

장점:
- 투자 결정이 빠릅니다
- 서로 보완적인 역할을 합니다
- 한 명이 공격적이면 다른 한 명이 방어적

다만 주의:
- 둘 다 찬성한다고 무조건 좋은 결정은 아닙니다
- 객관적 검토는 반드시 거치세요` : `같은 ${el1} 오행이라 금전관이 비슷합니다.

큰 이견 없이 결정할 수 있지만, 같은 방향으로 실수할 위험도 있습니다.

권장사항:
- 정기적으로 재무 상태를 점검하세요
- 외부 감사/자문을 활용하세요
- 큰 결정은 시간을 두고 하세요`}`
            },
            { icon: '🤝', color: 'text-cyan-400', title: '협상과 거래에서',
              content: `협상 테이블에서 두 분의 역할을 어떻게 나누면 좋을지 살펴봅니다.

${person1.name}님(${el1})의 협상 스타일:
${el1 === '화' ? `🔥 공격형 협상가
- 적극적으로 주도합니다
- 자신감 있게 요구사항을 전달
- 분위기를 장악하는 능력
- 역할: 협상 리드, 가격 제시, 클로징` : el1 === '목' ? `🌳 비전 제시형 협상가
- 큰 그림과 미래 가치를 설명
- 파트너십의 가능성을 어필
- 역할: 협력 관계 구축, 장기 계약` : el1 === '토' ? `🏔️ 신뢰 구축형 협상가
- 안정적이고 신뢰감을 줍니다
- 무리한 요구를 하지 않습니다
- 역할: 관계 유지, 후속 관리` : el1 === '금' ? `⚔️ 분석형 협상가
- 조건을 꼼꼼히 분석합니다
- 논리적으로 반박합니다
- 역할: 계약서 검토, 조건 협의` : `💧 공감형 협상가
- 상대방의 니즈를 파악합니다
- 유연하게 대안을 제시합니다
- 역할: 분위기 조율, 갈등 해소`}

${person2.name}님(${el2})과의 역할 분담:
- 협상 전: ${el2 === '금' || el2 === '토' ? person2.name : person1.name}님이 자료 준비
- 협상 중: ${el1 === '화' || el1 === '목' ? person1.name : person2.name}님이 리드
- 마무리: ${el2 === '토' || el2 === '금' ? person2.name : person1.name}님이 세부사항 확인

Good Cop / Bad Cop 전략도 효과적입니다!`
            },
            { icon: '📈', color: 'text-green-400', title: '위기 상황 대처',
              content: `비즈니스에서 위기는 반드시 옵니다. 두 분이 함께 위기를 어떻게 극복할지 살펴봅니다.

${el1 === '화' || el2 === '화' ? `🔥 화(火) 에너지가 있어 빠른 판단과 행동이 가능합니다.

위기 대응 특징:
- 즉각적으로 반응합니다
- 과감한 결정을 내릴 수 있습니다
- 팀에 에너지와 희망을 줍니다

주의: 너무 급하게 결정하면 실수할 수 있습니다. ${el1 !== '화' || el2 !== '화' ? `${el1 === '화' ? person2.name : person1.name}님이 브레이크 역할을 해주세요.` : '둘 다 화(火)라면 외부 조언을 반드시 구하세요.'}` : el1 === '토' || el2 === '토' ? `🏔️ 토(土) 에너지가 있어 차분하게 대응할 수 있습니다.

위기 대응 특징:
- 패닉하지 않고 상황을 분석합니다
- 안정적으로 직원들을 이끕니다
- 장기적 관점에서 판단합니다

주의: 너무 신중하면 타이밍을 놓칠 수 있습니다. 때로는 빠른 결정이 필요합니다.` : el1 === '금' || el2 === '금' ? `⚔️ 금(金) 에너지가 있어 원칙적으로 대응합니다.

위기 대응 특징:
- 체계적으로 문제를 분석합니다
- 법적/재무적 리스크를 점검합니다
- 명확한 기준으로 결정합니다

주의: 원칙만 고집하면 융통성이 부족할 수 있습니다. 상황에 따른 유연함도 필요합니다.` : `💧 수(水) 에너지가 있어 유연하게 대처합니다.

위기 대응 특징:
- 상황에 맞춰 전략을 바꿉니다
- 새로운 기회를 모색합니다
- 팀의 사기를 관리합니다

주의: 방향이 자주 바뀌면 혼란이 올 수 있습니다. 핵심 원칙은 지키세요.`}

위기 극복 팁: 역할을 나누세요. 한 명은 외부 대응(고객, 언론), 다른 한 명은 내부 관리(직원, 운영)를 맡으면 효과적입니다.`
            },
            { icon: '⏰', color: 'text-amber-400', title: '데드라인과 일정 관리',
              content: `프로젝트의 성패는 일정 관리에 달려 있습니다.

${el1 === '화' && el2 === '화' ? `🔥🔥 둘 다 화(火)! 마감 직전에 집중하는 타입입니다.

장점: 압박 속에서 폭발적인 성과를 냅니다
단점: 마감에 쫓기면 품질이 떨어질 수 있습니다

대책:
- 중간 체크포인트를 필수로 두세요
- 외부 일정 관리자를 두는 것도 방법입니다
- 실제 마감보다 1주일 앞당겨서 내부 마감을 정하세요` : el1 === '금' || el2 === '금' ? `⚔️ 금(金)이 있어 일정 관리가 잘 됩니다.

${el1 === '금' ? person1.name : person2.name}님이 일정 관리를 맡으면:
- 체계적인 스케줄 수립
- 마일스톤별 점검
- 지연 시 빠른 대응

나머지 분은 실행에 집중하면 됩니다.` : el1 === '토' || el2 === '토' ? `🏔️ 토(土)가 있어 안정적으로 진행됩니다.

${el1 === '토' ? person1.name : person2.name}님의 꾸준함이 빛을 발합니다:
- 매일 조금씩 진행
- 무리 없이 마감 준수
- 예상치 못한 변수에도 대응 가능

급한 상황에서는 화(火)나 목(木)의 추진력이 필요할 수 있습니다.` : `서로 리마인드해주면 효과적입니다.

공유 캘린더, 프로젝트 관리 툴(노션, 트렐로, 아사나)을 적극 활용하세요.

일정 관리 팁:
1. 주간 회의로 진행 상황 공유
2. 마감 3일 전 최종 점검
3. 예비 시간(버퍼) 확보
4. 우선순위 명확히 하기`}`
            },
            { icon: '🗣️', color: 'text-violet-400', title: '커뮤니케이션 방식',
              content: `업무에서 소통 방식이 맞지 않으면 오해와 갈등이 생깁니다.

${person1.name}님(${el1})이 선호하는 소통:
${el1 === '화' ? `🔥 직설적이고 빠른 소통
- "결론부터 말해줘"
- 긴 이메일보다 짧은 전화
- 즉각적인 피드백을 원함
- 회의는 짧고 핵심만` : el1 === '목' ? `🌳 비전 제시형 소통
- "큰 그림을 먼저 이야기하자"
- 아이디어 브레인스토밍을 좋아함
- 가능성과 기회를 먼저 봄
- 미래지향적 대화 선호` : el1 === '토' ? `🏔️ 신중하고 구체적인 소통
- "자세한 내용을 알려줘"
- 충분한 정보가 있어야 결정
- 문서화된 커뮤니케이션 선호
- 정리된 보고를 좋아함` : el1 === '금' ? `⚔️ 논리적이고 명확한 소통
- "데이터로 말해줘"
- 감정보다 팩트 중심
- 명확한 근거와 논리 필요
- 정확한 표현 선호` : `💧 공감적이고 유연한 소통
- "어떻게 생각해?"
- 상대방 의견을 먼저 들음
- 비공식적 대화도 중요시
- 분위기와 감정을 고려`}

${person2.name}님(${el2})이 선호하는 소통:
${el2 === '화' ? `즉각적 피드백, 핵심만 간결하게` : el2 === '목' ? `아이디어 교환, 가능성 논의` : el2 === '토' ? `정리된 보고, 충분한 정보` : el2 === '금' ? `데이터 기반 논의, 명확한 근거` : `비공식적 대화, 공감과 이해`}

💡 팁: 상대방이 선호하는 방식으로 소통하면 업무 효율이 2배!`
            },
            { icon: '🎭', color: 'text-pink-400', title: '공과 사의 구분',
              content: `${el1 === '금' || el2 === '금' ? `⚔️ 금(金)이 있어 공과 사를 철저히 구분합니다.

${el1 === '금' ? person1.name : person2.name}님은 업무와 개인을 명확히 분리합니다. 업무 중에는 친한 사이여도 프로페셔널하게 대합니다.

장점:
- 감정에 흔들리지 않는 의사결정
- 공정한 평가와 피드백
- 비즈니스 관계의 명확함

${el1 !== '금' && el2 !== '금' ? '' : (el1 === '금' && el2 === '금') ? '둘 다 금(金)이라 업무 관계가 매우 명확합니다.' : `${el1 === '금' ? person2.name : person1.name}님은 가끔 ${el1 === '금' ? person1.name : person2.name}님이 차갑게 느껴질 수 있습니다. 하지만 이것은 프로페셔널함입니다.`}` : el1 === '화' || el2 === '화' ? `🔥 화(火)가 있어 업무와 개인이 섞일 수 있습니다.

${el1 === '화' ? person1.name : person2.name}님은 열정적이라 업무도 개인적으로 받아들이는 경향이 있습니다.

주의:
- 업무 피드백을 개인 공격으로 받아들이지 않기
- 업무 성과와 개인 감정 분리하기
- 퇴근 후에는 업무 이야기 줄이기

경계가 필요합니다:
- "이건 업무 이야기야"라고 전제하기
- 어려운 피드백은 1:1로, 사적 자리가 아닌 업무 미팅에서
- 개인적 친분과 업무 평가는 별개임을 명확히` : `적절히 균형을 유지할 수 있습니다.

업무 중에는 프로페셔널하게, 업무 외에는 편하게 지내는 균형이 가능합니다.

권장사항:
- 업무 시간에는 업무에 집중
- 식사, 회식에서는 개인적 대화도 OK
- 어려운 피드백은 업무 미팅에서
- 좋은 관계가 좋은 성과로 이어지도록`}`
            },
            { icon: '🏆', color: 'text-amber-400', title: '성과 인정과 보상',
              content: `사람마다 동기부여 방식이 다릅니다. 서로에게 맞는 인정 방식을 알아보세요.

${person1.name}님(${el1})이 원하는 인정 방식:
${el1 === '화' ? `🔥 공개적 인정과 칭찬
- 전체 미팅에서 성과 언급
- "잘했어!"라는 직접적 칭찬
- 보너스, 인센티브 같은 가시적 보상
- 승진, 타이틀 상승` : el1 === '목' ? `🌳 성장 기회 제공
- 새로운 프로젝트 기회
- 교육, 컨퍼런스 참가 기회
- 더 큰 책임과 권한
- 비전 실현의 기회` : el1 === '토' ? `🏔️ 안정적 보상과 신뢰
- 꾸준한 급여 인상
- 고용 안정성
- 장기 근속에 대한 인정
- "믿고 맡길 수 있어"라는 신뢰` : el1 === '금' ? `⚔️ 공정한 평가와 정확한 보상
- 객관적 기준에 따른 평가
- 성과에 비례하는 보상
- 명확한 피드백
- 전문성 인정` : `💧 감정적 교감과 팀 기여 인정
- "덕분에 팀이 잘 돌아가"
- 협력과 조화에 대한 인정
- 팀 내 역할의 중요성 강조
- 개인적인 감사 표현`}

${person2.name}님(${el2})이 원하는 인정 방식:
${el2 === '화' ? `즉각적 피드백, 가시적 보상` : el2 === '목' ? `도전적 목표, 성장 기회` : el2 === '토' ? `장기적 신뢰, 안정적 보상` : el2 === '금' ? `정확한 분배, 공정한 평가` : `팀 기여 인정, 감사 표현`}

💡 서로가 원하는 방식으로 인정해주세요. 효과가 2배!`
            },
            { icon: '🚀', color: 'text-indigo-400', title: '함께 사업한다면',
              content: `${person1.name}님과 ${person2.name}님이 함께 창업하거나 사업을 한다면?

${isSangsaeng ? `✅ 상생 관계: 장기 파트너십에 최적!

${el1}이 ${el2}를 생(生)하는 관계로, 한 사람의 에너지가 다른 사람에게 전달됩니다.

추천 역할 분담:
- ${el1 === '목' ? person1.name + '님: 사업 기획, 전략' : el1 === '화' ? person1.name + '님: 영업, 마케팅' : el1 === '토' ? person1.name + '님: 운영, 관리' : el1 === '금' ? person1.name + '님: 재무, 품질' : person1.name + '님: HR, 파트너십'}
- ${el2 === '목' ? person2.name + '님: 제품 개발, 혁신' : el2 === '화' ? person2.name + '님: 대외 활동, PR' : el2 === '토' ? person2.name + '님: 실무, 지원' : el2 === '금' ? person2.name + '님: 법무, 감사' : person2.name + '님: 고객 관리, CS'}

시너지 포인트:
- 서로 다른 강점으로 완벽한 팀 구성
- 한 명이 지치면 다른 한 명이 지원
- 의사결정의 균형` : isSanggeuk ? `⚔️ 상극 관계: 견제와 균형이 있어 오히려 안정적!

의외로 상극 파트너십이 성공하는 경우가 많습니다. 한쪽이 치우치려 하면 다른 쪽이 잡아주기 때문입니다.

장점:
- 위험한 결정을 막아줍니다
- 다양한 관점을 확보합니다
- 서로 견제하며 균형을 유지합니다

주의:
- 감정적 충돌 관리가 핵심입니다
- 의사결정 방식을 미리 정해두세요
- 중재자(이사회, 고문)를 두는 것도 방법입니다

성공 조건: 서로에 대한 존중과 신뢰가 바탕이 되어야 합니다.` : `비슷한 성향으로 방향성은 맞지만, 다양성이 부족할 수 있습니다.

같은 ${el1} 오행이라 생각이 비슷합니다. 빠르게 의사결정하고 실행할 수 있지만, 같은 실수를 할 위험도 있습니다.

권장:
- 제3의 파트너나 핵심 직원으로 다른 오행을 영입하세요
- 외부 자문/멘토를 적극 활용하세요
- 정기적으로 외부 시각에서 검토받으세요

성공 조건: 내부의 동질성을 외부의 다양성으로 보완하세요.`}`
            },
            { icon: '💡', color: 'text-teal-400', title: '비즈니스 관계 개선 조언',
              content: `${person1.name}님과 ${person2.name}님의 비즈니스 관계를 더 발전시키는 조언입니다.

${hasChung ? `⚡ 충(冲) 관계 비즈니스 팁:

1. 감정을 배제하고 데이터로 대화하세요
   - "내 생각엔"보다 "데이터에 따르면"
   - 주관적 의견보다 객관적 사실

2. 회의 전에 어젠다를 공유하세요
   - 갑자기 논쟁이 커지는 것 방지
   - 준비된 상태에서 논의

3. 최종 결정권자를 미리 정하세요
   - 팽팽할 때 결론을 내릴 사람
   - 결정 후에는 협력

4. 쿨다운 타임을 가지세요
   - 격해지면 10분 휴식
   - 다음날 다시 논의해도 됩니다` : isSanggeuk ? `⚔️ 상극 관계 비즈니스 팁:

1. 서로 다른 관점을 장점으로 활용하세요
   - 반대 의견은 리스크 체크 기회
   - 다양한 관점 = 더 현명한 결정

2. 역할을 명확히 나누세요
   - 겹치면 충돌, 나누면 시너지
   - 각자 잘하는 것에 집중

3. 정기적으로 1:1 미팅하세요
   - 오해가 쌓이기 전에 해소
   - 솔직한 피드백 교환

4. 공동의 목표를 상기하세요
   - 방법은 달라도 목표는 같다
   - 큰 그림에서 협력` : `🌟 좋은 관계 유지 팁:

1. 좋은 관계에 안주하지 마세요
   - 편해서 소홀해지기 쉽습니다
   - 지속적인 발전이 필요합니다

2. 새로운 도전을 함께하세요
   - 익숙한 것만 하면 정체됩니다
   - 함께 성장하세요

3. 외부 관점을 수용하세요
   - 둘만의 세계에 갇히지 마세요
   - 다른 의견도 경청하세요

4. 서로에게 솔직한 피드백을 주세요
   - 편한 사이여도 비판은 필요
   - 발전을 위한 피드백`}

정기적인 미팅으로 방향을 맞춰가세요. 비즈니스는 혼자보다 둘이 낫습니다!`
            }
          ] : [
            // 기타 관계 (전면 확장)
            { icon: '🔗', color: 'text-blue-400', 
              title: `${isSangsaeng ? '서로를 살려주는 운명의 만남' : isSanggeuk ? '긴장감이 성장을 만드는 인연' : hasYukhap ? '자연스럽게 합이 맞는 인연' : '운명이 교차하는 독특한 인연'}`,
              content: `${person1.name}님(${STEMS.names[r1.dsi]}·${el1} ${getElHanja(el1)})과 ${person2.name}님(${STEMS.names[r2.dsi]}·${el2} ${getElHanja(el2)})의 인연을 사주의 관점에서 분석합니다.

두 분의 오행 관계는 ${isSangsaeng ? `상생(相生) 관계입니다. ${el1}(${getElHanja(el1)})과 ${el2}(${getElHanja(el2)}) 사이에 서로 살려주는 기운이 흐릅니다. 이 관계에서는 한 사람이 가진 에너지가 상대방에게 긍정적 자극이 되어, 함께할수록 서로가 더 발전하는 시너지를 만들어냅니다.` : isSanggeuk ? `상극(相剋) 관계입니다. ${el1}(${getElHanja(el1)})과 ${el2}(${getElHanja(el2)}) 사이에 자극과 긴장의 기운이 흐릅니다. 이 긴장감을 어떻게 다루느냐가 관계의 질을 결정합니다. 서로 다름을 이해하고 존중할 때 오히려 가장 강력한 조합이 됩니다.` : `비화(比和) 또는 중립 관계입니다. 큰 충돌도 없지만 강한 끌림도 약한 편입니다. 서로의 좋은 점을 의식적으로 발견하고 공통된 목표를 만들어갈 때 이 관계는 진가를 발휘합니다.`}

${hasStemHap ? `[천간합] 두 분의 천간이 합(合)을 이루어 자연스러운 끌림과 정(情)이 있습니다. 처음 만나도 오랜 친구 같은 편안함을 느끼는 이유가 여기에 있습니다.` : hasYukhap ? `[육합(六合)] 지지 사이에 합이 형성되어 일상적 교류에서 편안함과 안정감이 있습니다. 특별한 이유 없이 함께 있는 것이 편안한 관계입니다.` : hasChung ? `[충(冲) 관계] 지지 사이에 충돌의 기운이 있어 의견 대립이 있을 수 있습니다. 이는 서로에게 변화의 동기를 주는 자극이 될 수 있지만, 감정적 충돌로 번지지 않도록 주의가 필요합니다.` : `특별한 합충(合沖) 관계는 없습니다. 이는 관계가 두 사람의 노력과 선택에 의해 만들어진다는 의미이기도 합니다.`}`
            },
            { icon: '🎯', color: 'text-purple-400',
              title: `${person1.name}님이 ${person2.name}님에게 주는 기운`,
              content: `${person1.name}님(${el1} ${getElHanja(el1)}) 일간이 ${person2.name}님에게 미치는 영향을 분석합니다.

${el1}(${getElHanja(el1)}) 기운을 가진 ${person1.name}님은 ${el1 === '목' ? '성장, 도전, 새로운 아이디어로 상대방을 자극합니다. 항상 앞을 향해 나아가려는 에너지가 있어, 함께 있으면 막혀있던 일들이 풀리는 기분을 느낄 수 있습니다. 다만 때로는 너무 빠르게 달려나가서 상대방이 따라가기 벅찰 수 있습니다.' : el1 === '화' ? '열정, 표현력, 활기찬 에너지로 주변을 밝힙니다. 함께 있으면 기운이 생기고 즐거워지는 존재입니다. 단, 감정 기복이 크고 불꽃처럼 빨리 타오르고 식는 면이 있어, 일관성 있는 관계 유지가 중요합니다.' : el1 === '토' ? '안정감, 신뢰, 포용력으로 상대방에게 든든한 버팀목이 됩니다. 느리지만 확실하게 관계를 쌓아가며, 한번 신뢰가 형성되면 좀처럼 변하지 않습니다. 변화에 둔감한 면이 있으니 상대방의 새로운 시도를 응원해주세요.' : el1 === '금' ? '원칙, 결단력, 정직함으로 관계에 신뢰의 기반을 만들어줍니다. 약속을 지키고 말과 행동이 일치하는 사람입니다. 다만 융통성이 부족하거나 차갑게 느껴질 수 있으니, 따뜻함을 의식적으로 표현해주세요.' : '지혜, 유연성, 깊은 공감 능력으로 상대방의 마음을 잘 읽습니다. 관계의 흐름을 잘 파악하고 상황에 맞게 적응하는 능력이 있습니다. 다만 우유부단하게 보일 수 있으니 명확한 의사 표현이 필요합니다.'}

${person1.name}님의 신살 영향: ${allSinsal1.includes('도화살') ? '도화살이 있어 매력적인 존재감이 있습니다. 사람들이 자연스럽게 끌립니다.' : ''} ${allSinsal1.includes('백호살') ? '백호살의 기운이 있어 순간적 추진력과 결단력이 뛰어납니다.' : ''} ${allSinsal1.includes('학당귀인') ? '학당귀인이 있어 지식과 논리로 신뢰를 쌓는 타입입니다.' : ''}`
            },
            { icon: '💫', color: 'text-pink-400',
              title: `${person2.name}님이 ${person1.name}님에게 주는 기운`,
              content: `${person2.name}님(${el2} ${getElHanja(el2)}) 일간이 ${person1.name}님에게 미치는 영향을 분석합니다.

${el2}(${getElHanja(el2)}) 기운을 가진 ${person2.name}님은 ${el2 === '목' ? '진취적이고 창의적인 에너지로 ${person1.name}님에게 활력을 불어넣습니다. 새로운 관점과 가능성을 제시하는 역할을 하며, 함께 있으면 성장하는 느낌을 줍니다.' : el2 === '화' ? '밝고 따뜻한 기운으로 ${person1.name}님에게 위안과 활기를 줍니다. 표현력이 뛰어나 감정을 솔직하게 나누는 관계를 만들어갑니다.' : el2 === '토' ? '안정감과 현실적인 판단으로 ${person1.name}님에게 든든한 지지자가 됩니다. 무리한 계획에 브레이크를 걸어주는 실질적인 도움을 줍니다.' : el2 === '금' ? '냉철하고 논리적인 시각으로 ${person1.name}님에게 객관적 조언을 해줍니다. 감정에 휘쓸리지 않는 판단력이 관계에 균형을 잡아줍니다.' : '감성적이고 직관적인 통찰력으로 ${person1.name}님이 보지 못하는 것을 짚어줍니다. 공감 능력이 뛰어나 정서적 안정감을 주는 존재입니다.'}

${person2.name}님의 신살 영향: ${allSinsal2.includes('재고귀인') ? '재고귀인이 있어 재물복이 있고 경제적으로 안정된 기운을 지닙니다.' : ''} ${allSinsal2.includes('천을귀인') ? '천을귀인이 있어 귀인의 도움이 많고 인복이 넘칩니다.' : ''} ${allSinsal2.includes('현침살') ? '현침살의 기운으로 분석적이고 논리적인 소통을 선호합니다.' : ''}`
            },
            { icon: '⚡', color: 'text-red-400', 
              title: hasChung ? `충(冲)이 만드는 갈등과 성장의 포인트` : isSanggeuk ? `상극 에너지가 만드는 긴장의 지점` : `두 사람 사이의 마찰 포인트`,
              content: `${hasChung 
                ? `두 분 사이에 지지 충(冲) 관계가 있습니다. 이는 마치 북극과 남극처럼 서로 다른 방향을 향하는 에너지입니다.

충 관계에서 자주 발생하는 갈등 유형:
· 의사결정 방식의 차이 — 한 사람이 빠르게 결정할 때 다른 사람은 신중하게 고민합니다.
· 생활 리듬의 충돌 — 에너지가 넘치는 시간대가 달라 함께 하는 타이밍을 맞추기 어렵습니다.
· 표현 방식의 간극 — 감정을 드러내는 방식이 달라 오해가 생길 수 있습니다.

그러나 충(冲)은 단순한 갈등이 아닙니다. 이 에너지는 서로에게 변화의 자극을 주어, 정체되지 않고 계속 성장하게 만드는 힘입니다. 충 관계의 두 사람이 서로를 이해하고 나면, 가장 강력한 파트너가 될 수 있습니다.`
                : isSanggeuk 
                ? `두 분은 상극(相剋) 오행 관계입니다. 이 긴장감을 어떻게 다루는지가 핵심입니다.

상극 관계에서 주의할 점:
· ${el1}(${getElHanja(el1)})과 ${el2}(${getElHanja(el2)})의 기운이 부딪힐 때, 자신의 방식이 옳다는 고집이 갈등을 키웁니다.
· 상대방의 다른 방식을 "틀린 것"이 아닌 "다른 것"으로 인식하세요.
· 의사 결정 시 서로의 강점을 인정하고 역할을 분배하면 이 관계가 가장 강력해집니다.

상극이 길(吉)로 바뀌는 순간: 서로 "나와 다른 상대방이 있어서 내가 더 완전해진다"는 생각으로 전환할 때, 이 관계는 어떤 합(合) 관계보다 강한 시너지를 냅니다.`
                : `큰 충돌 요소는 없지만, 관계가 장기간 이어지면서 생기는 일상적 갈등을 짚어드립니다.

· 기대치의 차이 — 명확하게 말하지 않아도 상대방이 알아줄 것이라는 기대가 실망을 만들 수 있습니다.
· 관심의 방향 차이 — 두 분이 중시하는 가치가 다를 때 우선순위 충돌이 생길 수 있습니다.
· 표현 빈도 차이 — 한 사람은 자주 확인하고 싶고, 다른 사람은 믿고 맡기는 스타일일 수 있습니다.

이러한 갈등은 사주 차이보다 소통의 부재에서 비롯되는 경우가 많습니다. 서로의 기대와 방식을 솔직하게 이야기하는 대화가 필요합니다.`
              }`
            },
            { icon: '🤝', color: 'text-cyan-400',
              title: `두 사람의 강점 조합 — ${isSangsaeng ? '시너지가 폭발하는 영역' : '보완이 이루어지는 영역'}`,
              content: `${person1.name}님의 ${el1}(${getElHanja(el1)}) 기운과 ${person2.name}님의 ${el2}(${getElHanja(el2)}) 기운이 합쳐질 때 빛나는 영역을 찾아드립니다.

${isSangsaeng 
                ? `상생 관계인 두 분은 함께할 때 1+1이 3이 되는 조합입니다.

🌟 함께 강해지는 영역:
· ${el1 === '목' && el2 === '화' || el1 === '화' && el2 === '목' ? '창의적 아이디어(목)를 표현력과 열정(화)으로 실현하는 힘' : el1 === '화' && el2 === '토' || el1 === '토' && el2 === '화' ? '열정적 추진력(화)을 안정적으로 현실화하는 힘(토)' : el1 === '토' && el2 === '금' || el1 === '금' && el2 === '토' ? '신뢰(토) 위에 원칙과 결단력(금)을 더한 탄탄한 기반' : el1 === '금' && el2 === '수' || el1 === '수' && el2 === '금' ? '결단력(금)과 지혜(수)가 합쳐진 냉철한 판단력' : '성장 에너지(수)와 진취적 도전(목)이 만드는 발전의 힘'}
· 서로의 용신(用神)이 ${r1.fe.yongshin === r2.fe.yongshin ? '같아 함께 있으면 에너지 충전이 됩니다' : r1.fe.yongshin === el2 ? `${person1.name}님에게 ${person2.name}님이 용신의 기운을 채워주는 관계입니다` : r2.fe.yongshin === el1 ? `${person2.name}님에게 ${person1.name}님이 용신의 기운을 채워주는 관계입니다` : '다르지만 서로의 부족함을 채워주는 관계입니다'}.`
                : `상극 혹은 중립 관계이지만, 각자의 강점을 살리면 강력한 조합이 됩니다.

🌟 각자의 역할을 분명히 할 때 빛나는 영역:
· ${person1.name}님(${el1} 기운)은 ${el1 === '목' ? '새로운 시작과 방향 제시' : el1 === '화' ? '동기부여와 활기찬 추진' : el1 === '토' ? '안정적 관리와 중재' : el1 === '금' ? '냉철한 판단과 원칙 수립' : '유연한 조율과 심층 분석'} 역할에 탁월합니다.
· ${person2.name}님(${el2} 기운)은 ${el2 === '목' ? '창의적 발상과 도전' : el2 === '화' ? '열정적 실행과 표현' : el2 === '토' ? '현실적 실행과 지속성' : el2 === '금' ? '정확한 실행과 마무리' : '공감과 유연한 소통'} 역할에서 빛납니다.
· 이 두 역할이 합쳐질 때 한 사람만으로는 이루기 어려운 일을 함께 해낼 수 있습니다.`
              }`
            },
            { icon: '💬', color: 'text-green-400',
              title: `두 사람만의 소통 언어`,
              content: (() => {
                const s1 = el1 === '목' ? '직접적·목적지향적 대화를 선호합니다. "왜?"와 "어떻게?"를 자주 묻고 빠른 결론을 원합니다.' : el1 === '화' ? '감정을 솔직하게 표현하고 즉각적 반응을 원합니다. 칭찬과 인정에 크게 반응합니다.' : el1 === '토' ? '천천히 신중하게 생각하고 결론보다 과정을 중시합니다. 충분히 듣고 싶어합니다.' : el1 === '금' ? '논리적·사실 중심의 대화를 선호합니다. 약속과 말의 일관성을 매우 중시합니다.' : '상대방 감정을 먼저 파악하고 대화를 맞춰갑니다. 경청이 뛰어나지만 자기 의견을 명확히 말하는 것을 어려워합니다.';
                const s2 = el2 === '목' ? '새로운 아이디어와 가능성을 이야기할 때 생기가 넘칩니다. 비판보다 격려와 지지를 원합니다.' : el2 === '화' ? '활발하고 표현력이 풍부합니다. 칭찬에 즉각 반응하며 분위기를 살립니다.' : el2 === '토' ? '구체적·실용적 내용에 집중합니다. 이야기를 끝까지 들어주는 능력이 있습니다.' : el2 === '금' ? '정확하고 구체적 정보를 중시합니다. 감정보다 해결책 중심 대화를 선호합니다.' : '유연하게 맞춰가며 상대방 중심으로 대화합니다. 감성적 교감을 선호합니다.';
                const tip = el1 === el2 ? '같은 오행이라 소통 방식이 비슷해 편안하지만, 같은 단점도 공유합니다. 의식적으로 다른 관점을 추가해보세요.' : isSangsaeng ? '두 분의 소통 방식은 서로를 보완합니다. 한 사람이 서툰 부분을 다른 사람이 채워줄 수 있습니다.' : '차이를 인정하고 상대방의 언어로 이야기하려는 노력이 관계를 깊게 합니다.';
                return `두 분의 일간과 오행에 따라 선호하는 소통 방식이 다릅니다. 이 차이를 이해하면 관계가 훨씬 수월해집니다.\n\n${person1.name}님의 소통 스타일 (${el1} ${getElHanja(el1)}):\n${s1}\n\n${person2.name}님의 소통 스타일 (${el2} ${getElHanja(el2)}):\n${s2}\n\n💡 소통 팁: ${tip}`;
              })()
            },
            { icon: '🔮', color: 'text-amber-400',
              title: `두 사람의 관계가 빛나는 타이밍`,
              content: (() => {
                const goodSeason = (el1 === '목' || el2 === '목') ? '봄(3~5월)' : (el1 === '화' || el2 === '화') ? '여름(6~8월)' : (el1 === '금' || el2 === '금') ? '가을(9~11월)' : (el1 === '수' || el2 === '수') ? '겨울(12~2월)' : '환절기';
                const timingGood = isSangsaeng ? `상생 기운이 강화되는 ${goodSeason}에 두 분의 관계가 더욱 좋아집니다.` : `${el1}과 ${el2}를 모두 생해주는 기운이 오는 해나 달에 관계가 개선됩니다.`;
                const hapTiming = hasStemHap ? '천간합이 있어 새로운 만남이나 결정적 순간에 강한 연결감을 느낍니다.' : hasYukhap ? '육합의 기운으로 일상적 교류에서 편안함이 쌓입니다.' : '공통된 목표나 프로젝트를 함께할 때 관계가 강화됩니다.';
                const cautionNote = hasChung ? '충(冲)의 에너지가 자극될 때 중요한 결정 앞에서 의견 충돌이 격해질 수 있습니다.' : isSanggeuk ? '상극의 기운이 강해지는 계절에 불필요한 긴장이 생길 수 있습니다.' : '각자의 기신(忌神) 기운이 강해지는 시기에 예민해질 수 있습니다.';
                const adviceFinal = totalScore >= 70 ? (isSangsaeng ? '이 상생의 기운을 잘 살려 함께 성장하는 일을 찾으세요.' : '현재의 좋은 기운을 지속하려면 꾸준한 소통이 핵심입니다.') : (hasChung ? '충돌이 생겼을 때 즉각 반응하지 말고 하루 이틀 기다린 뒤 대화하세요.' : isSanggeuk ? '내 방식이 맞다는 고집을 잠시 내려놓고 상대방의 논리를 들어보세요.' : '소통을 늘리세요. 안다고 생각해도 물어보는 습관을 들이세요.');
                return `사주에는 관계가 더 좋아지거나 어려워지는 시기가 있습니다. 미리 알면 지혜롭게 대비할 수 있습니다.\n\n🌟 두 사람의 관계가 좋아지는 조건:\n· ${timingGood}\n· ${hapTiming}\n· 두 분 모두의 용신이 충족되는 환경에서 에너지가 높아집니다.\n\n⚠️ 관계에 주의가 필요한 상황:\n· ${cautionNote}\n· 스트레스 상황에서 각자의 부정적 특성이 강화됩니다.\n\n💡 관계 강화 조언: ${adviceFinal}`;
              })()
            },
            { icon: '💡', color: 'text-yellow-400',
              title: `두 사람을 위한 사주 맞춤 조언`,
              content: (() => {
                const advice1 = el1 === '목' ? '성장하고 싶은 욕구를 앞세우기 전에 상대방의 페이스를 먼저 확인하세요. 빠른 결정이 때로는 상대방을 소외감 들게 할 수 있습니다.' : el1 === '화' ? '열정이 넘칠 때 상대방도 같은 온도인지 확인하세요. 감정을 직접 표현하는 장점을 살리되 상대방이 표현하는 방식도 존중해주세요.' : el1 === '토' ? '변화를 두려워하지 마세요. 상대방의 새로운 아이디어에 "일단 해보자"는 태도가 관계를 더 풍성하게 합니다.' : el1 === '금' ? '논리로 이기려 하지 말고 때로는 감정으로 이야기하세요. 상대방이 원하는 것은 정답이 아니라 공감일 수 있습니다.' : '내 생각을 더 명확하게 표현해보세요. 상대방이 속마음을 읽어주기를 기대하기보다 솔직하게 말하는 것이 더 효과적입니다.';
                const advice2 = el2 === '목' ? '즉흥적인 제안을 할 때 상대방이 준비할 시간을 주세요. 새로운 것에 대한 흥분을 나누되 상대방의 실용적인 시각도 존중하세요.' : el2 === '화' ? '기분이 좋을 때와 나쁠 때의 온도 차이가 상대방을 혼란스럽게 할 수 있습니다. 감정의 기복을 스스로 인식하고 관리하세요.' : el2 === '토' ? '결정을 너무 미루지 마세요. 때로는 불완전하더라도 빠른 결정이 관계를 활기차게 합니다.' : el2 === '금' ? '원칙과 기준을 잠시 낮추는 연습을 해보세요. 완벽하지 않아도 충분히 좋을 수 있다는 것을 인정하면 관계가 편안해집니다.' : '당신의 의견도 중요합니다. 상대방에게 맞추기보다 자신의 생각을 더 자주 표현하세요.';
                const sharedAdvice = hapCount > 0 ? '합의 기운이 있어 자연스럽게 통하는 부분이 있습니다. 이 강점을 공통 관심사와 활동으로 발전시키세요.' : chungCount > 0 ? '충의 기운이 있어 자극과 성장의 잠재력이 큽니다. 갈등을 성장의 기회로 전환하는 연습을 함께 해보세요.' : '두 분의 관계는 노력에 비례해서 깊어집니다. 꾸준히 시간을 투자하고 소통하는 것이 가장 중요합니다.';
                return `두 분의 사주를 종합 분석한 실천적 조언을 드립니다.\n\n[${person1.name}님에게]\n${advice1}\n\n[${person2.name}님에게]\n${advice2}\n\n[두 분 모두에게]\n${sharedAdvice}`;
              })()
            }
                    ]).map((section, idx) => 
            React.createElement(AccordionItem, { key: idx, icon: section.icon, color: section.color, title: section.title, content: section.content })
          )
        )
      )
    );
  };

  const YearlyScreen = () => React.createElement('div', { className: 'min-h-screen p-4 pb-28' },
    React.createElement('header', { className: 'flex items-center gap-4 py-4' },
      React.createElement('button', { onClick: () => setScreen('home'), className: 'text-2xl' }, '←'),
      React.createElement('h1', { className: 'text-xl font-bold' }, '🎊 2026 신년운세')
    ),
    React.createElement('div', { className: 'text-center py-8' },
      React.createElement('div', { className: 'text-6xl mb-4' }, '🐴'),
      React.createElement('h2', { className: 'text-2xl font-bold' }, '2026 병오년'),
      React.createElement('p', { className: 'text-gray-400 mt-2' }, '붉은 말의 해')
    ),
    !isLoggedIn && React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4 text-center' },
      React.createElement('p', { className: 'text-gray-400 mb-3' }, '신년운세를 보려면 로그인이 필요합니다'),
      React.createElement('button', { onClick: () => setShowLogin(true), className: 'px-6 py-2 gradient-primary rounded-xl font-bold' }, '로그인하기')
    ),
    isLoggedIn && savedSaju.length === 0 && React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4 text-center' },
      React.createElement('p', { className: 'text-gray-400 mb-3' }, '신년운세를 볼 사주를 먼저 등록해주세요'),
      React.createElement('button', { onClick: () => { setForm({ name:'', gender:'여성', calendar:'양력', year:'', month:'', day:'', hour:'', minute:'' }); setScreen('input'); window.scrollTo(0,0); }, className: 'px-6 py-2 gradient-primary rounded-xl font-bold' }, '사주 등록하기')
    ),
    isLoggedIn && savedSaju.length > 0 && React.createElement(React.Fragment, null,
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('div', { className: 'flex items-center justify-between mb-3' },
          React.createElement('label', { className: 'text-sm text-gray-400' }, '분석할 사주 선택'),
          React.createElement('button', {
            onClick: () => { setForm({ name:'', gender:'여성', calendar:'양력', year:'', month:'', day:'', hour:'', minute:'' }); setReturnScreen('yearly'); setScreen('input'); window.scrollTo(0,0); },
            className: 'flex items-center gap-1.5 px-3 py-1.5 bg-purple-500/20 border border-purple-500/40 text-purple-300 text-xs rounded-xl hover:bg-purple-500/30 transition-all'
          },
            React.createElement('span', null, '+'),
            React.createElement('span', null, '새 사주 추가')
          )
        ),
        React.createElement('div', { className: 'space-y-2' },
          savedSaju.map((s, i) => {
            const isSelected = String(yearlyPerson) === String(s.id);
            const isYearllyPaid = savedYearly.some(y => y.personId === s.id);
            return React.createElement('div', {
              key: i,
              onClick: () => setYearlyPerson(s.id),
              className: `flex items-center justify-between p-3 rounded-xl cursor-pointer transition-all border ${isSelected ? 'bg-amber-500/20 border-amber-500/50' : 'bg-white/5 border-white/10 hover:bg-white/10'}`
            },
              React.createElement('div', { className: 'flex items-center gap-3' },
                React.createElement('div', { className: `w-8 h-8 rounded-full flex items-center justify-center text-sm ${isSelected ? 'bg-amber-500' : 'bg-white/10'}` }, isSelected ? '✓' : (s.gender === '여성' ? '👩' : '👨')),
                React.createElement('div', null,
                  React.createElement('p', { className: 'font-medium text-sm' }, s.name),
                  React.createElement('p', { className: 'text-xs text-gray-400' }, `${s.year}.${s.month}.${s.day}`)
                )
              ),
              isYearllyPaid
                ? React.createElement('span', { className: 'px-2 py-0.5 bg-amber-500/20 border border-amber-500/40 text-amber-300 text-xs rounded-full' }, '🎊 구매완료')
                : React.createElement('span', { className: 'px-2 py-0.5 bg-white/10 text-gray-500 text-xs rounded-full' }, '미구매')
            );
          })
        )
      ),
      React.createElement('button', { 
        onClick: () => {
          if (!yearlyPerson) {
            alert('사주를 선택해주세요.');
            return;
          }
          // 이미 구매한 운세인지 확인
          if (!isLoggedIn) { setShowLogin(true); return; }
          const alreadyYearlyPaid = savedYearly.some(y => String(y.personId) === String(yearlyPerson));
          if (alreadyYearlyPaid) {
            setScreen('yearly-result');
          } else {
            openPayment({ name: '2026 신년운세', price: 4900 });
          }
        }, 
        className: (() => {
          const alreadyBought = savedYearly.some(y => String(y.personId) === String(yearlyPerson));
          return `w-full mt-4 py-4 ${alreadyBought ? 'bg-gradient-to-r from-purple-600 to-purple-800' : 'bg-amber-500'} rounded-2xl font-bold text-lg transition-all`;
        })()
      }, (() => {
        const alreadyBought = savedYearly.some(y => String(y.personId) === String(yearlyPerson));
        return alreadyBought ? '🎊 구매한 운세 다시보기' : '신년운세 보기 ₩4,900';
      })())
    ),
    // 이전 신년운세 결과
    isLoggedIn && savedYearly.length > 0 && React.createElement('div', { className: 'glass rounded-2xl p-5 mt-6' },
      React.createElement('h3', { className: 'font-bold mb-4 flex items-center gap-2' }, 
        React.createElement('span', null, '📋'),
        '이전 신년운세 결과'
      ),
      React.createElement('div', { className: 'space-y-2' },
        savedYearly.map((yearly, i) => 
          React.createElement('div', { 
            key: i, 
            onClick: () => {
              setYearlyPerson(yearly.personId);
              setScreen('yearly-result');
            },
            className: 'flex items-center justify-between p-3 bg-white/5 rounded-xl cursor-pointer hover:bg-white/10 transition-all' 
          },
            React.createElement('div', { className: 'flex items-center gap-3' },
              React.createElement('span', { className: 'text-amber-400 text-lg' }, '🎊'),
              React.createElement('div', null,
                React.createElement('p', { className: 'font-medium' }, `${yearly.personName}님의 2026년 운세`),
                React.createElement('p', { className: 'text-xs text-gray-500' }, yearly.date)
              )
            ),
            React.createElement('span', { className: 'text-gray-400 text-sm' }, '다시보기 →')
          )
        )
      )
    )
  );

  // 신년운세 결과 화면
  const YearlyResultScreen = () => {
    const person = savedSaju.find(s => String(s.id) === String(yearlyPerson));
    if (!person) return React.createElement('div', { className: 'p-4 text-center text-gray-400' }, '데이터 없음');
    
    const r = person.result || analyzeSaju(person.year, person.month, person.day, person.hour, person.minute, person.isLunar, false);
    const dayEl = STEMS.elements[r.dsi];
    
    // 운세 해설 생성
    const yearlyData = generateYearlyInterpretation(r, person, 2026);
    
    return React.createElement('div', { className: 'min-h-screen p-4 pb-28' },
      React.createElement('header', { className: 'flex items-center gap-4 py-4' },
        React.createElement('button', { onClick: () => setScreen('yearly'), className: 'text-2xl' }, '←'),
        React.createElement('h1', { className: 'text-xl font-bold' }, '🎊 2026 신년운세'),
        React.createElement('span', { className: 'ml-auto px-3 py-1 bg-amber-500 rounded-full text-xs' }, 'PREMIUM')
      ),
      // 사용자 정보
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('div', { className: 'flex items-center gap-4' },
          React.createElement('div', { className: 'w-16 h-16 gradient-primary rounded-full flex items-center justify-center text-3xl' }, person.gender === '여성' ? '👩' : '👨'),
          React.createElement('div', null,
            React.createElement('h2', { className: 'text-xl font-bold' }, `${person.name}님의 2026년`),
            React.createElement('p', { className: 'text-gray-400' }, `${STEMS.names[r.dsi]}(${STEMS.korean[r.dsi]}) 일간 · ${dayEl}(${getElHanja(dayEl)}) 오행`)
          )
        )
      ),
      // 총운 점수
      React.createElement('div', { className: 'glass rounded-2xl p-6 mt-4 text-center' },
        React.createElement('div', { className: 'text-4xl mb-2' }, '🐴'),
        React.createElement('h3', { className: 'text-gray-400 mb-2' }, '2026년 병오년(丙午年) 총운'),
        React.createElement('div', { className: 'text-5xl font-bold text-gradient' }, `${yearlyData.totalScore}점`),
        React.createElement('p', { className: 'text-lg mt-2 font-medium' }, 
          yearlyData.totalScore >= 80 ? '🎉 대길(大吉)! 모든 일이 순조로운 한 해' :
          yearlyData.totalScore >= 65 ? '✨ 길(吉)! 노력한 만큼 성과가 있는 해' :
          yearlyData.totalScore >= 50 ? '🌱 평(平)! 차분하게 내실을 다지는 해' :
          '⚠️ 신중함이 필요한 해'
        )
      ),
      // 총운 해설
      React.createElement('div', { className: 'glass rounded-2xl overflow-hidden mt-4' },
        React.createElement('div', { className: 'p-3 bg-gradient-to-r from-amber-500 to-orange-500 text-white text-center font-bold' }, '📜 총운 해설'),
        React.createElement('div', { className: 'p-5' },
          yearlyData.yearSummary.split('\n\n').map((para, i) => 
            para.startsWith('[') 
              ? React.createElement('div', { key: i, className: 'mt-4 p-3 bg-amber-500/10 rounded-xl' },
                  React.createElement('p', { className: 'text-sm text-amber-200 font-medium' }, para.split(']')[0] + ']'),
                  React.createElement('p', { className: 'text-sm text-gray-300 mt-1' }, para.split(']')[1])
                )
              : React.createElement('p', { key: i, className: 'text-sm text-gray-300 leading-relaxed mb-3' }, para)
          )
        )
      ),
      // 월별 운세 상세
      React.createElement('div', { className: 'glass rounded-2xl overflow-hidden mt-4' },
        React.createElement('div', { className: 'p-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white text-center font-bold' }, '📅 월별 운세'),
        React.createElement('p', { className: 'text-xs text-gray-400 text-center py-3 border-b border-white/10' }, '💡 각 월을 클릭하면 상세 운세를 확인할 수 있습니다'),
        // 월별 상세 해설 아코디언
        React.createElement('div', { className: 'divide-y divide-white/10' },
          yearlyData.monthlyFortunes.map((m, i) => 
            React.createElement(AccordionItem, { 
              key: i, 
              icon: m.score >= 70 ? '🌟' : m.score >= 50 ? '💪' : '🛡️',
              color: m.score >= 70 ? 'text-green-400' : m.score >= 50 ? 'text-yellow-400' : 'text-red-400',
              title: `${m.month} — ${m.monthTitle || m.keyword}`,
              content: m.fullDetail || m.advice
            })
          )
        )
      ),
      // 분야별 운세 상세
      React.createElement('div', { className: 'glass rounded-2xl overflow-hidden mt-4' },
        React.createElement('div', { className: 'p-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-center font-bold' }, '🎯 분야별 상세 운세'),
        ['wealth', 'love', 'career', 'health'].map(key => {
          const cat = yearlyData.categoryFortunes[key];
          return React.createElement(AccordionItem, { 
            key: key, 
            icon: cat.title.split(' ')[0], 
            color: key === 'wealth' ? 'text-emerald-400' : key === 'love' ? 'text-pink-400' : key === 'career' ? 'text-blue-400' : 'text-red-400',
            title: cat.title.split(' ')[1],
            content: `${cat.summary}\n\n${cat.detail}`
          });
        })
      ),
      // 행운 정보
      React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
        React.createElement('h3', { className: 'font-bold mb-4' }, '🍀 2026년 행운의 키워드'),
        React.createElement('div', { className: 'grid grid-cols-3 gap-3 text-center' },
          React.createElement('div', { className: 'p-4 bg-red-500/20 rounded-xl' },
            React.createElement('p', { className: 'text-xs text-gray-400' }, '행운의 색'),
            React.createElement('p', { className: 'font-bold text-red-400 text-lg' }, yearlyData.luckyInfo.color)
          ),
          React.createElement('div', { className: 'p-4 bg-purple-500/20 rounded-xl' },
            React.createElement('p', { className: 'text-xs text-gray-400' }, '행운의 숫자'),
            React.createElement('p', { className: 'font-bold text-purple-400 text-lg' }, yearlyData.luckyInfo.number)
          ),
          React.createElement('div', { className: 'p-4 bg-blue-500/20 rounded-xl' },
            React.createElement('p', { className: 'text-xs text-gray-400' }, '행운의 방향'),
            React.createElement('p', { className: 'font-bold text-blue-400 text-lg' }, yearlyData.luckyInfo.direction)
          )
        ),
        React.createElement('p', { className: 'text-xs text-gray-500 text-center mt-4' }, 
          `💡 용신(用神)인 ${r.fe.yongshin}(${getElHanja(r.fe.yongshin)}) 기운을 보충하면 운이 좋아집니다`
        )
      )
    );
  };

  const MyPageScreen = () => React.createElement('div', { className: 'min-h-screen p-4 pb-28' },
    React.createElement('header', { className: 'py-4' },
      React.createElement('h1', { className: 'text-xl font-bold' }, '마이페이지')
    ),
    React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
      React.createElement('div', { className: 'flex items-center gap-4' },
        React.createElement('div', { className: 'w-16 h-16 bg-purple-500/30 rounded-full flex items-center justify-center text-3xl' }, '👤'),
        React.createElement('div', null,
          React.createElement('h2', { className: 'font-bold text-lg' }, userEmail),
          React.createElement('p', { className: 'text-gray-400 text-sm' }, `${loginMethod} 로그인`)
        )
      )
    ),
    // 포인트 섹션
    React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
      React.createElement('div', { className: 'flex justify-between items-center mb-4' },
        React.createElement('div', { className: 'flex items-center gap-3' },
          React.createElement('span', { className: 'text-2xl' }, '⭐'),
          React.createElement('div', null,
            React.createElement('p', { className: 'font-bold text-lg' }, `${stars}별`),
            React.createElement('p', { className: 'text-xs text-gray-500' }, '유료 포인트')
          )
        ),
        React.createElement('div', { className: 'flex items-center gap-3' },
          React.createElement('span', { className: 'text-2xl' }, '🌙'),
          React.createElement('div', { className: 'text-right' },
            React.createElement('p', { className: 'font-bold text-lg' }, `${moons}달`),
            React.createElement('p', { className: 'text-xs text-gray-500' }, '보너스 포인트')
          )
        )
      ),
      React.createElement('button', { 
        onClick: () => setShowChargeModal(true),
        className: 'w-full py-3 bg-gradient-to-r from-yellow-400 to-amber-500 text-black font-bold rounded-xl'
      }, '⭐ 별 충전하기')
    ),
    // 저장된 사주는 사주 페이지에서 관리
    // 구매한 상세 사주 분석 결과
    savedPaidSaju.length > 0 && React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
      React.createElement('h3', { className: 'font-bold mb-4' }, '🔮 구매한 사주 분석'),
      savedPaidSaju.map((saju, i) => 
        React.createElement('div', { 
          key: i, 
          onClick: () => {
            // 저장된 사주 분석 결과 복원
            setCurrentInput({
              name: saju.name,
              gender: saju.gender,
              year: saju.year,
              month: saju.month,
              day: saju.day,
              hour: saju.hour,
              minute: saju.minute,
              calendar: saju.calendar
            });
            setCurrentResult(saju.result);
            setScreen('paid-result');
          },
          className: 'flex items-center justify-between p-3 bg-white/5 rounded-xl mb-2 cursor-pointer hover:bg-white/10' 
        },
          React.createElement('div', { className: 'flex items-center gap-3' },
            React.createElement('span', null, saju.gender === '여성' ? '👩' : '👨'),
            React.createElement('div', null,
              React.createElement('p', { className: 'font-medium' }, `${saju.name}님의 상세 분석`),
              React.createElement('p', { className: 'text-xs text-gray-500' }, `${saju.year}.${saju.month}.${saju.day} · ${saju.date}`)
            )
          ),
          React.createElement('span', { className: 'text-purple-400 text-xs' }, 'PREMIUM →')
        )
      )
    ),
    // 구매한 궁합 결과
    savedCompatibility.length > 0 && React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
      React.createElement('h3', { className: 'font-bold mb-4' }, '💕 구매한 궁합'),
      savedCompatibility.map((compat, i) => {
        const relationLabels = { couple: '연인', parent: '부모-자녀', sibling: '형제', friend: '친구', business: '직장', etc: '기타' };
        const relationIcons = { couple: '💑', parent: '👨‍👧', sibling: '👫', friend: '🤝', business: '💼', etc: '👥' };
        return React.createElement('div', { 
          key: i, 
          onClick: () => {
            setCompatPerson1(compat.person1Id);
            setCompatPerson2(compat.person2Id);
            setCompatRelation(compat.relation || 'couple');
            setScreen('compatibility-result');
          },
          className: 'flex items-center justify-between p-3 bg-white/5 rounded-xl mb-2 cursor-pointer hover:bg-white/10' 
        },
          React.createElement('div', { className: 'flex items-center gap-3' },
            React.createElement('span', null, relationIcons[compat.relation] || '💕'),
            React.createElement('div', null,
              React.createElement('p', { className: 'font-medium' }, `${compat.person1Name} & ${compat.person2Name}`),
              React.createElement('p', { className: 'text-xs text-gray-500' }, `${relationLabels[compat.relation] || '관계'} · ${compat.date}`)
            )
          ),
          React.createElement('span', { className: 'text-gray-400 text-xs' }, '보기 →')
        );
      })
    ),
    // 구매한 신년운세 결과
    savedYearly.length > 0 && React.createElement('div', { className: 'glass rounded-2xl p-5 mt-4' },
      React.createElement('h3', { className: 'font-bold mb-4' }, '🎊 구매한 신년운세'),
      savedYearly.map((yearly, i) => 
        React.createElement('div', { 
          key: i, 
          onClick: () => {
            setYearlyPerson(yearly.personId);
            setScreen('yearly-result');
          },
          className: 'flex items-center justify-between p-3 bg-white/5 rounded-xl mb-2 cursor-pointer hover:bg-white/10' 
        },
          React.createElement('div', { className: 'flex items-center gap-3' },
            React.createElement('span', { className: 'text-amber-400' }, '🎊'),
            React.createElement('div', null,
              React.createElement('p', { className: 'font-medium' }, `${yearly.personName}님의 2026년`),
              React.createElement('p', { className: 'text-xs text-gray-500' }, yearly.date)
            )
          ),
          React.createElement('span', { className: 'text-gray-400 text-xs' }, '보기 →')
        )
      )
    ),
    // 메뉴 버튼들
    React.createElement('div', { className: 'space-y-2 mt-4' },
      React.createElement('button', { 
        onClick: () => setScreen('history'),
        className: 'w-full glass rounded-xl p-4 flex items-center gap-3 hover:bg-white/10 transition-all'
      },
        React.createElement('span', { className: 'text-green-400' }, '📋'),
        React.createElement('span', { className: 'font-medium' }, '사용내역')
      ),
      React.createElement('button', { 
        onClick: () => setScreen('inquiry'),
        className: 'w-full glass rounded-xl p-4 flex items-center gap-3 hover:bg-white/10 transition-all'
      },
        React.createElement('span', { className: 'text-blue-400' }, '💬'),
        React.createElement('span', { className: 'font-medium' }, '문의하기')
      ),
      React.createElement('button', { 
        onClick: () => setScreen('about'),
        className: 'w-full glass rounded-xl p-4 flex items-center gap-3 hover:bg-white/10 transition-all'
      },
        React.createElement('span', { className: 'text-purple-400' }, '🏢'),
        React.createElement('span', { className: 'font-medium' }, '회사소개')
      ),
      React.createElement('button', { 
        onClick: () => setScreen('terms'),
        className: 'w-full glass rounded-xl p-4 flex items-center gap-3 hover:bg-white/10 transition-all'
      },
        React.createElement('span', { className: 'text-gray-400' }, '📄'),
        React.createElement('span', { className: 'font-medium' }, '서비스 이용약관')
      ),
      React.createElement('button', { 
        onClick: () => setScreen('privacy'),
        className: 'w-full glass rounded-xl p-4 flex items-center gap-3 hover:bg-white/10 transition-all'
      },
        React.createElement('span', { className: 'text-gray-400' }, '🔒'),
        React.createElement('span', { className: 'font-medium' }, '개인정보 처리방침')
      )
    ),
    React.createElement('button', { onClick: handleLogout, className: 'w-full mt-4 py-3 glass rounded-xl text-red-400' }, '로그아웃')
  );

  const LoginModal = () => {
    return React.createElement('div', { className: 'fixed inset-0 z-[200] flex flex-col bg-[#1a1a2e]' },
      // 헤더
      React.createElement('div', { className: 'flex items-center justify-between px-5 py-4 border-b border-white/10' },
        React.createElement('button', {
          onClick: () => setShowLogin(false),
          className: 'p-2 hover:bg-white/10 rounded-lg transition-all'
        }, React.createElement('span', { className: 'text-gray-300 text-xl' }, '←')),
        React.createElement('span', { className: 'font-bold text-white' }, '로그인 / 회원가입'),
        React.createElement('div', { className: 'w-10' })
      ),
      // 본문
      React.createElement('div', { className: 'flex-1 flex flex-col items-center justify-center px-6 pb-10' },
        // 로고 & 소개
        React.createElement('div', { className: 'text-center mb-10' },
          React.createElement('div', { className: 'text-5xl mb-4' }, '🔮'),
          React.createElement('h1', { className: 'text-2xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent mb-2' }, '사주ON'),
          React.createElement('p', { className: 'text-sm text-gray-400 leading-relaxed' }, 'AI가 읽어주는 나의 사주', React.createElement('br'), '로그인하고 무료로 시작하세요')
        ),
        // 소셜 로그인 버튼들
        React.createElement('div', { className: 'w-full max-w-sm space-y-3' },
          // 카카오 (실제 SDK 연동)
          React.createElement('button', {
            onClick: () => {
              if (!window.Kakao || !window.Kakao.isInitialized()) {
                alert('카카오 SDK 로딩 중입니다. 잠시 후 다시 시도해주세요.');
                return;
              }
              window.Kakao.Auth.login({
                success: () => {
                  window.Kakao.API.request({
                    url: '/v2/user/me',
                    success: (res) => {
                      const email = res.kakao_account?.email || `kakao_${res.id}@kakao.user`;
                      handleLogin('kakao', email);
                    },
                    fail: () => handleLogin('kakao')
                  });
                },
                fail: (err) => {
                  console.error('카카오 로그인 실패:', err);
                  alert('카카오 로그인에 실패했습니다. 다시 시도해주세요.');
                }
              });
            },
            className: 'w-full flex items-center justify-between px-5 py-4 bg-[#FEE500] text-black rounded-2xl font-semibold hover:brightness-95 transition-all active:scale-[0.98]'
          },
            React.createElement('div', { className: 'flex items-center gap-3' },
              React.createElement('svg', { width: '22', height: '22', viewBox: '0 0 24 24', fill: 'currentColor' },
                React.createElement('path', { d: 'M12 3C7.03 3 3 6.36 3 10.5c0 2.64 1.7 4.96 4.27 6.26-.19.7-.7 2.56-.8 2.96 0 0-.01.09.04.13.05.04.11.02.11.02.14-.02 1.66-1.1 2.33-1.57.67.1 1.36.15 2.05.15 4.97 0 9-3.36 9-7.5S16.97 3 12 3z' })
              ),
              React.createElement('span', { className: 'text-base' }, '카카오로 시작하기')
            ),
            React.createElement('span', { className: 'text-black/40 text-sm' }, '→')
          ),
          // 네이버 (백엔드 필요 - 준비 중 안내)
          React.createElement('button', {
            onClick: () => alert('네이버 로그인은 서버 연동 후 제공됩니다.\n현재 카카오 로그인을 이용해주세요.'),
            className: 'w-full flex items-center justify-between px-5 py-4 bg-[#03A94D]/50 text-white/60 rounded-2xl font-semibold cursor-not-allowed transition-all'
          },
            React.createElement('div', { className: 'flex items-center gap-3' },
              React.createElement('span', { className: 'text-lg font-black w-[22px] text-center' }, 'N'),
              React.createElement('span', { className: 'text-base' }, '네이버로 시작하기')
            ),
            React.createElement('span', { className: 'text-xs text-white/40 bg-white/10 px-2 py-0.5 rounded-full' }, '준비 중')
          ),
          // 구글 (준비 중)
          React.createElement('button', {
            onClick: () => alert('구글 로그인은 Firebase 연동 후 제공됩니다.\n현재 카카오 로그인을 이용해주세요.'),
            className: 'w-full flex items-center justify-between px-5 py-4 bg-white/30 text-white/50 rounded-2xl font-semibold cursor-not-allowed transition-all'
          },
            React.createElement('div', { className: 'flex items-center gap-3' },
              React.createElement('svg', { width: '22', height: '22', viewBox: '0 0 48 48', opacity: '0.5' },
                React.createElement('path', { fill: '#FFC107', d: 'M43.6 20H24v8h11.3c-1.6 4.7-6 8-11.3 8-6.6 0-12-5.4-12-12s5.4-12 12-12c3 0 5.8 1.1 8 3l5.7-5.7C34 6.1 29.3 4 24 4 12.9 4 4 12.9 4 24s8.9 20 20 20 20-8.9 20-20c0-1.3-.1-2.7-.4-4z' }),
                React.createElement('path', { fill: '#FF3D00', d: 'M6.3 14.7l6.6 4.8C14.7 15.1 19 12 24 12c3 0 5.8 1.1 8 3l5.7-5.7C34 6.1 29.3 4 24 4 16.3 4 9.7 8.3 6.3 14.7z' }),
                React.createElement('path', { fill: '#4CAF50', d: 'M24 44c5.2 0 9.9-2 13.4-5.2l-6.2-5.2C29.2 35.1 26.7 36 24 36c-5.2 0-9.6-3.3-11.3-8l-6.5 5C9.5 39.6 16.2 44 24 44z' }),
                React.createElement('path', { fill: '#1976D2', d: 'M43.6 20H24v8h11.3c-.8 2.2-2.2 4.2-4.1 5.6l6.2 5.2C41 35.2 44 30 44 24c0-1.3-.1-2.7-.4-4z' })
              ),
              React.createElement('span', { className: 'text-base' }, '구글로 시작하기')
            ),
            React.createElement('span', { className: 'text-xs text-white/30 bg-white/10 px-2 py-0.5 rounded-full' }, '준비 중')
          )
        ),
        // 안내 문구
        React.createElement('p', { className: 'text-xs text-gray-600 text-center mt-8 leading-relaxed' },
          '로그인 시 서비스 이용약관 및 개인정보 처리방침에', React.createElement('br'), '동의하는 것으로 간주됩니다'
        )
      )
    );
  };

  const PaymentModal = () => {
    const requiredStars = Math.ceil(paymentProduct?.price / 100); // 1별 = 100원
    const canPayWithStars = stars >= requiredStars;
    
    const handleStarPayment = () => {
      if (canPayWithStars) {
        setStars(prev => prev - requiredStars);
        handlePaymentComplete();
      }
    };
    
    return React.createElement('div', { className: 'fixed inset-0 bg-black/70 flex items-end justify-center z-50' },
      React.createElement('div', { className: 'bg-[#1a1a2e] rounded-t-3xl p-6 w-full max-w-lg' },
        React.createElement('div', { className: 'flex justify-between items-center mb-6' },
          React.createElement('h2', { className: 'text-xl font-bold' }, '결제하기'),
          React.createElement('button', { onClick: () => setShowPayment(false), className: 'text-2xl text-gray-400' }, '×')
        ),
        React.createElement('div', { className: 'glass rounded-xl p-4 mb-4' },
          React.createElement('div', { className: 'flex justify-between items-center' },
            React.createElement('span', { className: 'font-bold' }, paymentProduct?.name),
            React.createElement('div', { className: 'text-right' },
              React.createElement('span', { className: 'text-xl font-bold text-purple-400' }, `₩${paymentProduct?.price?.toLocaleString()}`),
              React.createElement('p', { className: 'text-xs text-gray-400' }, `= ⭐ ${requiredStars}별`)
            )
          )
        ),
        // 별로 결제 섹션
        isLoggedIn && React.createElement('div', { className: 'mb-4' },
          React.createElement('div', { className: 'flex items-center justify-between mb-2' },
            React.createElement('span', { className: 'text-sm text-gray-400' }, '보유 별'),
            React.createElement('span', { className: 'font-bold' }, `⭐ ${stars}별`)
          ),
          canPayWithStars 
            ? React.createElement('button', { 
                onClick: handleStarPayment, 
                className: 'w-full py-4 bg-gradient-to-r from-yellow-400 to-amber-500 text-black rounded-xl font-bold mb-2'
              }, `⭐ ${requiredStars}별로 결제하기`)
            : React.createElement('button', { 
                onClick: () => { setShowPayment(false); setShowChargeModal(true); }, 
                className: 'w-full py-4 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-xl font-bold mb-2'
              }, `별이 부족해요 (${requiredStars - stars}별 더 필요) → 충전하기`)
        ),
        // 구분선
        React.createElement('div', { className: 'flex items-center gap-4 my-4' },
          React.createElement('div', { className: 'flex-1 h-px bg-white/20' }),
          React.createElement('span', { className: 'text-gray-500 text-xs' }, '또는 바로 결제'),
          React.createElement('div', { className: 'flex-1 h-px bg-white/20' })
        ),
        React.createElement('div', { className: 'space-y-3' },
          // 카카오페이 (토스페이먼츠 통해 처리)
          React.createElement('button', {
            onClick: () => requestTossPayment('카카오페이'),
            className: 'w-full py-4 bg-[#FEE500] text-black rounded-xl font-bold flex items-center justify-center gap-2'
          },
            React.createElement('svg', { width: '20', height: '20', viewBox: '0 0 24 24', fill: 'currentColor' },
              React.createElement('path', { d: 'M12 3C7.03 3 3 6.36 3 10.5c0 2.64 1.7 4.96 4.27 6.26-.19.7-.7 2.56-.8 2.96 0 0-.01.09.04.13.05.04.11.02.11.02.14-.02 1.66-1.1 2.33-1.57.67.1 1.36.15 2.05.15 4.97 0 9-3.36 9-7.5S16.97 3 12 3z' })
            ),
            '카카오페이로 결제'
          ),
          // 카드 / 계좌이체 (토스페이먼츠)
          React.createElement('button', {
            onClick: () => requestTossPayment('카드'),
            className: 'w-full py-4 bg-[#0064FF] text-white rounded-xl font-bold'
          }, '💳 카드 / 계좌이체')
        )
      )
    );
  };

  // 별 충전 모달
  const ChargeModal = () => {
    const packages = [
      { stars: 10, moons: 0, price: 1000, label: '기본' },
      { stars: 50, moons: 5, price: 5000, label: '' },
      { stars: 100, moons: 15, price: 9900, label: '추천', highlight: true },
      { stars: 200, moons: 40, price: 19000, label: '최고 가성비' }
    ];
    
    const handleCharge = (pkg) => {
      setStars(prev => prev + pkg.stars);
      setMoons(prev => prev + pkg.moons);
      setShowChargeModal(false);
      alert(`⭐ ${pkg.stars}별${pkg.moons > 0 ? ` + 🌙 ${pkg.moons}달` : ''} 충전 완료!`);
    };
    
    return React.createElement('div', { className: 'fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4' },
      React.createElement('div', { className: 'bg-[#1a1a2e] rounded-2xl p-6 w-full max-w-sm' },
        React.createElement('div', { className: 'flex justify-between items-center mb-6' },
          React.createElement('h2', { className: 'text-xl font-bold' }, '⭐ 별 충전하기'),
          React.createElement('button', { onClick: () => setShowChargeModal(false), className: 'text-2xl text-gray-400' }, '×')
        ),
        // 현재 보유량
        React.createElement('div', { className: 'glass rounded-xl p-4 mb-4 flex justify-around' },
          React.createElement('div', { className: 'text-center' },
            React.createElement('span', { className: 'text-2xl' }, '⭐'),
            React.createElement('p', { className: 'font-bold text-lg' }, stars),
            React.createElement('p', { className: 'text-xs text-gray-500' }, '내 별')
          ),
          React.createElement('div', { className: 'text-center' },
            React.createElement('span', { className: 'text-2xl' }, '🌙'),
            React.createElement('p', { className: 'font-bold text-lg' }, moons),
            React.createElement('p', { className: 'text-xs text-gray-500' }, '내 달')
          )
        ),
        // 안내 메시지
        React.createElement('p', { className: 'text-xs text-gray-400 text-center mb-4' }, 
          '🌙 달은 충전 시 보너스로 지급되며, 프리미엄 기능에 사용됩니다.'
        ),
        // 충전 패키지
        React.createElement('div', { className: 'space-y-2' },
          packages.map((pkg, i) => 
            React.createElement('button', { 
              key: i, 
              onClick: () => handleCharge(pkg),
              className: `w-full p-4 rounded-xl flex items-center justify-between transition-all ${pkg.highlight ? 'bg-gradient-to-r from-purple-500/30 to-pink-500/30 border-2 border-purple-400' : 'glass hover:bg-white/10'}`
            },
              React.createElement('div', { className: 'flex items-center gap-2' },
                React.createElement('span', { className: 'text-lg' }, '⭐'),
                React.createElement('span', { className: 'font-bold' }, `${pkg.stars}별`),
                pkg.moons > 0 && React.createElement('span', { className: 'text-sm text-blue-300' }, `+ 🌙${pkg.moons}`),
                pkg.label && React.createElement('span', { 
                  className: `text-xs px-2 py-0.5 rounded-full ${pkg.highlight ? 'bg-purple-500 text-white' : 'bg-amber-500/20 text-amber-400'}`
                }, pkg.label)
              ),
              React.createElement('span', { className: 'font-bold text-purple-400' }, `₩${pkg.price.toLocaleString()}`)
            )
          )
        )
      )
    );
  };

  // 문의하기 화면
  const InquiryScreen = () => React.createElement('div', { className: 'min-h-screen p-4 pb-28' },
    React.createElement('header', { className: 'flex items-center gap-4 py-4' },
      React.createElement('button', { onClick: () => setScreen('mypage'), className: 'text-2xl' }, '←'),
      React.createElement('h1', { className: 'text-xl font-bold' }, '문의하기')
    ),
    React.createElement('div', { className: 'bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl p-4 text-center mb-4' },
      React.createElement('p', { className: 'text-white font-medium' }, '문의 유형을 선택해주세요')
    ),
    React.createElement('div', { className: 'space-y-2' },
      [
        { icon: '⚠️', title: '오류 문의', desc: '해설이 나오지 않나요?', color: 'text-amber-400', screen: 'error-inquiry' },
        { icon: '💬', title: '피드백 보내기', desc: '서비스 개선 의견이 있으신가요?', color: 'text-blue-400', screen: 'feedback' },
        { icon: '⭐', title: '리뷰 남기기', desc: '소중한 후기를 남겨주세요', color: 'text-yellow-400', screen: 'review' },
        { icon: '🔄', title: '환불 요청', desc: '결제 환불을 원하시나요?', color: 'text-red-400', screen: 'refund' },
        { icon: '❓', title: '기타 문의', desc: '그 외 궁금한 점이 있으신가요?', color: 'text-gray-400', screen: 'other-inquiry' }
      ].map((item, i) => 
        React.createElement('button', { 
          key: i, 
          onClick: () => setScreen(item.screen),
          className: 'w-full glass rounded-xl p-4 flex items-center justify-between hover:bg-white/10 transition-all'
        },
          React.createElement('div', { className: 'flex items-center gap-3' },
            React.createElement('span', { className: `text-xl ${item.color}` }, item.icon),
            React.createElement('div', { className: 'text-left' },
              React.createElement('p', { className: 'font-medium' }, item.title),
              React.createElement('p', { className: 'text-xs text-gray-500' }, item.desc)
            )
          ),
          React.createElement('span', { className: 'text-gray-500' }, '→')
        )
      )
    ),
    React.createElement('div', { className: 'mt-6' },
      React.createElement('div', { className: 'bg-pink-500 text-white text-center py-3 rounded-t-xl font-bold' }, '내 문의 내역'),
      React.createElement('div', { className: 'glass rounded-b-xl p-6 text-center text-gray-500' },
        '아직 문의하신 내용이 없습니다.'
      )
    )
  );

  // 사용내역 화면
  const HistoryScreen = () => {
    const totalPurchases = savedPaidSaju.length + savedCompatibility.length + savedYearly.length;
    
    return React.createElement('div', { className: 'min-h-screen p-4 pb-28' },
      React.createElement('header', { className: 'flex items-center gap-4 py-4' },
        React.createElement('button', { onClick: () => setScreen('mypage'), className: 'text-2xl' }, '←'),
        React.createElement('h1', { className: 'text-xl font-bold' }, '이용내역')
      ),
      // 요약 정보
      React.createElement('div', { className: 'glass rounded-2xl p-5 mb-4' },
        React.createElement('div', { className: 'grid grid-cols-3 gap-4 text-center' },
          React.createElement('div', null,
            React.createElement('p', { className: 'text-2xl font-bold text-purple-400' }, savedPaidSaju.length),
            React.createElement('p', { className: 'text-xs text-gray-500' }, '사주 분석')
          ),
          React.createElement('div', null,
            React.createElement('p', { className: 'text-2xl font-bold text-pink-400' }, savedCompatibility.length),
            React.createElement('p', { className: 'text-xs text-gray-500' }, '궁합')
          ),
          React.createElement('div', null,
            React.createElement('p', { className: 'text-2xl font-bold text-amber-400' }, savedYearly.length),
            React.createElement('p', { className: 'text-xs text-gray-500' }, '운세')
          )
        )
      ),
      totalPurchases === 0
        ? React.createElement('div', { className: 'glass rounded-xl p-10 text-center text-gray-500' },
            React.createElement('span', { className: 'text-4xl block mb-3' }, '📋'),
            '이용내역이 없습니다.'
          )
        : React.createElement('div', { className: 'space-y-4' },
            // 구매한 상세 사주 분석
            savedPaidSaju.length > 0 && React.createElement('div', { className: 'glass rounded-2xl overflow-hidden' },
              React.createElement('div', { className: 'p-4 bg-purple-500/20 border-b border-white/10' },
                React.createElement('h3', { className: 'font-bold flex items-center gap-2' },
                  React.createElement('span', null, '🔮'),
                  '상세 사주 분석'
                )
              ),
              React.createElement('div', { className: 'p-3 space-y-2' },
                savedPaidSaju.map((saju, i) => 
                  React.createElement('div', { 
                    key: i, 
                    onClick: () => {
                      setCurrentInput({
                        name: saju.name,
                        gender: saju.gender,
                        year: saju.year,
                        month: saju.month,
                        day: saju.day,
                        hour: saju.hour,
                        minute: saju.minute,
                        calendar: saju.calendar
                      });
                      setCurrentResult(saju.result);
                      setScreen('paid-result');
                    },
                    className: 'flex items-center justify-between p-3 bg-white/5 rounded-xl cursor-pointer hover:bg-white/10 transition-all' 
                  },
                    React.createElement('div', { className: 'flex items-center gap-3' },
                      React.createElement('span', { className: 'text-2xl' }, saju.gender === '여성' ? '👩' : '👨'),
                      React.createElement('div', null,
                        React.createElement('p', { className: 'font-medium' }, saju.name),
                        React.createElement('p', { className: 'text-xs text-gray-500' }, `${saju.year}.${saju.month}.${saju.day} · ${saju.date}`)
                      )
                    ),
                    React.createElement('span', { className: 'text-purple-400 text-sm font-bold' }, '보기 →')
                  )
                )
              )
            ),
            // 구매한 궁합
            savedCompatibility.length > 0 && React.createElement('div', { className: 'glass rounded-2xl overflow-hidden' },
              React.createElement('div', { className: 'p-4 bg-pink-500/20 border-b border-white/10' },
                React.createElement('h3', { className: 'font-bold flex items-center gap-2' },
                  React.createElement('span', null, '💕'),
                  '궁합 분석'
                )
              ),
              React.createElement('div', { className: 'p-3 space-y-2' },
                savedCompatibility.map((compat, i) => {
                  const relationLabels = { couple: '연인', parent: '부모-자녀', sibling: '형제', friend: '친구', business: '직장', etc: '기타' };
                  const relationIcons = { couple: '💑', parent: '👨‍👧', sibling: '👫', friend: '🤝', business: '💼', etc: '👥' };
                  return React.createElement('div', { 
                    key: i, 
                    onClick: () => {
                      setCompatPerson1(compat.person1Id);
                      setCompatPerson2(compat.person2Id);
                      setCompatRelation(compat.relation || 'couple');
                      setScreen('compatibility-result');
                    },
                    className: 'flex items-center justify-between p-3 bg-white/5 rounded-xl cursor-pointer hover:bg-white/10 transition-all' 
                  },
                    React.createElement('div', { className: 'flex items-center gap-3' },
                      React.createElement('span', { className: 'text-2xl' }, relationIcons[compat.relation] || '💕'),
                      React.createElement('div', null,
                        React.createElement('p', { className: 'font-medium' }, `${compat.person1Name} & ${compat.person2Name}`),
                        React.createElement('p', { className: 'text-xs text-gray-500' }, `${relationLabels[compat.relation] || '관계'} · ${compat.date}`)
                      )
                    ),
                    React.createElement('span', { className: 'text-pink-400 text-sm font-bold' }, '보기 →')
                  );
                })
              )
            ),
            // 구매한 신년운세
            savedYearly.length > 0 && React.createElement('div', { className: 'glass rounded-2xl overflow-hidden' },
              React.createElement('div', { className: 'p-4 bg-amber-500/20 border-b border-white/10' },
                React.createElement('h3', { className: 'font-bold flex items-center gap-2' },
                  React.createElement('span', null, '🎊'),
                  '2026 신년운세'
                )
              ),
              React.createElement('div', { className: 'p-3 space-y-2' },
                savedYearly.map((yearly, i) => 
                  React.createElement('div', { 
                    key: i, 
                    onClick: () => {
                      setYearlyPerson(yearly.personId);
                      setScreen('yearly-result');
                    },
                    className: 'flex items-center justify-between p-3 bg-white/5 rounded-xl cursor-pointer hover:bg-white/10 transition-all' 
                  },
                    React.createElement('div', { className: 'flex items-center gap-3' },
                      React.createElement('span', { className: 'text-2xl text-amber-400' }, '🎊'),
                      React.createElement('div', null,
                        React.createElement('p', { className: 'font-medium' }, `${yearly.personName}님의 2026년`),
                        React.createElement('p', { className: 'text-xs text-gray-500' }, yearly.date)
                      )
                    ),
                    React.createElement('span', { className: 'text-amber-400 text-sm font-bold' }, '보기 →')
                  )
                )
              )
            )
          )
    );
  };

  // 고정 헤더
  const Header = () => React.createElement('header', { 
    className: 'fixed top-0 left-0 right-0 bg-[#1a1a2e] border-b border-white/10 z-50'
  },
    React.createElement('div', { className: 'max-w-lg mx-auto flex items-center justify-between px-4 py-3' },
      React.createElement('h1', { 
        onClick: () => setScreen('home'),
        className: 'text-xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent cursor-pointer'
      }, '사주ON'),
      React.createElement('div', { className: 'flex items-center gap-2' },
        !isLoggedIn 
          ? React.createElement('button', { 
              onClick: () => setShowLogin(true),
              className: 'px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg text-sm font-bold'
            }, '로그인')
          : React.createElement(React.Fragment, null,
              // 포인트 표시
              React.createElement('button', { 
                onClick: () => setShowChargeModal(true),
                className: 'flex items-center gap-3 px-3 py-1.5 bg-white/5 rounded-lg hover:bg-white/10 transition-all'
              },
                React.createElement('div', { className: 'flex items-center gap-1' },
                  React.createElement('span', { className: 'text-yellow-400' }, '⭐'),
                  React.createElement('span', { className: 'text-sm font-semibold' }, stars)
                ),
                React.createElement('div', { className: 'flex items-center gap-1' },
                  React.createElement('span', { className: 'text-blue-300' }, '🌙'),
                  React.createElement('span', { className: 'text-sm font-semibold' }, moons)
                )
              ),
              // 햄버거 메뉴
              React.createElement('button', { 
                onClick: () => setShowSideMenu(true),
                className: 'p-2 hover:bg-white/10 rounded-lg transition-all'
              },
                React.createElement('span', { className: 'text-xl' }, '☰')
              )
            )
      )
    )
  );

  // 사이드 메뉴
  const SideMenu = () => React.createElement('div', { 
    className: 'fixed inset-0 z-[100]',
    onClick: () => setShowSideMenu(false)
  },
    React.createElement('div', { className: 'absolute inset-0 bg-black/60' }),
    React.createElement('div', { 
      className: 'absolute top-0 right-0 w-72 h-full bg-[#1a1a2e] shadow-xl',
      onClick: e => e.stopPropagation()
    },
      // 헤더
      React.createElement('div', { className: 'bg-gradient-to-r from-purple-500 to-pink-500 p-4 flex items-center justify-between' },
        React.createElement('h2', { className: 'font-bold text-white' }, '마이페이지'),
        React.createElement('button', { onClick: () => setShowSideMenu(false), className: 'text-white text-xl' }, '✕')
      ),
      // 유저 정보
      React.createElement('div', { className: 'p-4 border-b border-white/10' },
        React.createElement('div', { className: 'flex items-center gap-3' },
          React.createElement('span', { className: 'text-2xl' }, '👤'),
          React.createElement('div', null,
            React.createElement('p', { className: 'font-medium text-sm' }, `${loginMethod}로 로그인했습니다`),
            React.createElement('p', { className: 'text-xs text-gray-500 truncate max-w-[180px]' }, userEmail)
          )
        )
      ),
      // 포인트 섹션
      React.createElement('div', { className: 'p-4 border-b border-white/10' },
        React.createElement('div', { className: 'flex items-center justify-between mb-3' },
          React.createElement('div', { className: 'flex items-center gap-2' },
            React.createElement('span', { className: 'text-yellow-400 text-lg' }, '⭐'),
            React.createElement('span', { className: 'font-medium' }, '내 별')
          ),
          React.createElement('span', { className: 'font-bold text-lg' }, stars)
        ),
        React.createElement('div', { className: 'flex items-center justify-between mb-4' },
          React.createElement('div', { className: 'flex items-center gap-2' },
            React.createElement('span', { className: 'text-blue-300 text-lg' }, '🌙'),
            React.createElement('span', { className: 'font-medium' }, '내 달')
          ),
          React.createElement('span', { className: 'font-bold text-lg' }, moons)
        ),
        React.createElement('button', { 
          onClick: () => { setShowChargeModal(true); setShowSideMenu(false); },
          className: 'w-full py-3 bg-gradient-to-r from-yellow-400 to-amber-500 text-black font-bold rounded-xl hover:opacity-90 transition-all'
        }, '⭐ 별 충전하기')
      ),
      // 메뉴 목록
      React.createElement('div', { className: 'py-2' },
        [
          { icon: '📋', label: '사용내역', screen: 'history', color: 'text-green-400' },
          { icon: '💬', label: '문의하기', screen: 'inquiry', color: 'text-blue-400' },
          { icon: '🏢', label: '회사소개', screen: 'about', color: 'text-purple-400' }
        ].map((item, i) => 
          React.createElement('button', { 
            key: i, 
            onClick: () => { setScreen(item.screen); setShowSideMenu(false); },
            className: 'w-full flex items-center gap-3 px-4 py-4 hover:bg-white/5 transition-all border-b border-white/5'
          },
            React.createElement('span', { className: item.color }, item.icon),
            React.createElement('span', { className: 'font-medium' }, item.label)
          )
        ),
        React.createElement('button', { 
          onClick: () => { handleLogout(); setShowSideMenu(false); },
          className: 'w-full flex items-center gap-3 px-4 py-4 hover:bg-red-500/10 transition-all text-red-400'
        },
          React.createElement('span', null, '🚪'),
          React.createElement('span', { className: 'font-medium' }, '로그아웃')
        )
      ),
      // 하단 링크
      React.createElement('div', { className: 'absolute bottom-0 left-0 right-0 p-4 border-t border-white/10 flex justify-center gap-4 text-xs text-gray-500' },
        React.createElement('span', { onClick: () => { setScreen('about'); setShowSideMenu(false); }, className: 'cursor-pointer hover:text-gray-300' }, '회사소개'),
        React.createElement('span', null, '|'),
        React.createElement('span', { className: 'cursor-pointer hover:text-gray-300', onClick: () => setScreen('terms') }, '이용약관'),
        React.createElement('span', null, '|'),
        React.createElement('span', { className: 'cursor-pointer hover:text-gray-300', onClick: () => setScreen('privacy') }, '개인정보처리방침')
      )
    )
  );

  // 회사 소개 화면
  const AboutScreen = () => React.createElement('div', { className: 'min-h-screen p-4 pb-28' },
    React.createElement('header', { className: 'flex items-center gap-4 py-4' },
      React.createElement('button', { onClick: () => setScreen('home'), className: 'text-2xl' }, '←'),
      React.createElement('h1', { className: 'text-xl font-bold' }, '회사소개')
    ),
    // 브랜드 헤더
    React.createElement('div', { className: 'text-center py-8' },
      React.createElement('div', { className: 'w-20 h-20 bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center text-3xl mx-auto mb-4 shadow-lg shadow-purple-500/30' }, '🔮'),
      React.createElement('h2', { className: 'text-2xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent' }, '사주ON'),
      React.createElement('p', { className: 'text-gray-400 mt-2 text-sm' }, '전통 명리학을 현대적으로 재해석하다')
    ),
    // 소개 글
    React.createElement('div', { className: 'glass rounded-2xl p-6 mb-4' },
      React.createElement('h3', { className: 'font-bold text-lg mb-3 flex items-center gap-2' },
        React.createElement('span', null, '✨'),
        '사주ON 소개'
      ),
      React.createElement('p', { className: 'text-gray-300 text-sm leading-relaxed' },
        '사주ON은 수천 년의 역사를 가진 한국 전통 명리학을 과학적으로 분석하여, 누구나 쉽고 정확하게 자신의 사주를 알아볼 수 있는 서비스입니다.'
      ),
      React.createElement('p', { className: 'text-gray-300 text-sm leading-relaxed mt-3' },
        '정확한 만세력 데이터와 심층 AI 해설을 결합하여, 단순한 운세를 넘어 자신의 본질적 특성과 인생 방향을 발견하는 도구를 제공합니다.'
      )
    ),
    // 서비스 특징
    React.createElement('div', { className: 'glass rounded-2xl p-6 mb-4' },
      React.createElement('h3', { className: 'font-bold text-lg mb-4 flex items-center gap-2' },
        React.createElement('span', null, '🎯'),
        '서비스 특징'
      ),
      React.createElement('div', { className: 'space-y-3' },
        [
          { icon: '📐', title: '정확한 만세력', desc: '국내 최고 수준의 절기 정밀 계산으로 정확한 사주를 산출합니다' },
          { icon: '🧠', title: '심층 AI 해설', desc: '단순 운세가 아닌 천간·지지·오행·신살을 종합한 깊이 있는 분석' },
          { icon: '🔒', title: '개인정보 보호', desc: '입력하신 정보는 분석 목적으로만 사용되며 철저히 보호됩니다' },
          { icon: '💡', title: '언제든 재확인', desc: '구매한 결과는 언제든 다시 확인할 수 있습니다' }
        ].map((item, i) => 
          React.createElement('div', { key: i, className: 'flex items-start gap-3 p-3 bg-white/5 rounded-xl' },
            React.createElement('span', { className: 'text-xl' }, item.icon),
            React.createElement('div', null,
              React.createElement('p', { className: 'font-medium text-sm' }, item.title),
              React.createElement('p', { className: 'text-xs text-gray-400 mt-0.5' }, item.desc)
            )
          )
        )
      )
    ),
    // 사업자 정보
    React.createElement('div', { className: 'glass rounded-2xl p-6 mb-4' },
      React.createElement('h3', { className: 'font-bold text-lg mb-4 flex items-center gap-2' },
        React.createElement('span', null, '🏢'),
        '사업자 정보'
      ),
      React.createElement('div', { className: 'space-y-3 text-sm' },
        [
          { label: '상호', value: '사주ON' },
          { label: '대표', value: '고승우' },
          { label: '사업자등록번호', value: '294-18-02476' },
          { label: '주소', value: '경상남도 진주시 도동천로 48 104-1504' },
          { label: '전화번호', value: '050-6522-1519' },
          { label: '이메일', value: 'godwk15@naver.com' }
        ].map((info, i) => 
          React.createElement('div', { key: i, className: 'flex justify-between items-start gap-3 py-2 border-b border-white/5 last:border-b-0' },
            React.createElement('span', { className: 'text-gray-400 whitespace-nowrap' }, info.label),
            React.createElement('span', { className: 'text-gray-200 text-right' }, info.value)
          )
        )
      )
    ),
    // 고객센터
    React.createElement('div', { className: 'glass rounded-2xl p-6 mb-4' },
      React.createElement('h3', { className: 'font-bold text-lg mb-4 flex items-center gap-2' },
        React.createElement('span', null, '📞'),
        '고객센터'
      ),
      React.createElement('div', { className: 'space-y-3' },
        React.createElement('div', { className: 'flex items-center gap-3 p-3 bg-white/5 rounded-xl' },
          React.createElement('span', { className: 'text-blue-400 text-xl' }, '📧'),
          React.createElement('div', null,
            React.createElement('p', { className: 'text-xs text-gray-400' }, '이메일 문의'),
            React.createElement('p', { className: 'text-sm font-medium' }, 'godwk15@naver.com')
          )
        ),
        React.createElement('div', { className: 'flex items-center gap-3 p-3 bg-white/5 rounded-xl' },
          React.createElement('span', { className: 'text-green-400 text-xl' }, '📱'),
          React.createElement('div', null,
            React.createElement('p', { className: 'text-xs text-gray-400' }, '전화 문의'),
            React.createElement('p', { className: 'text-sm font-medium' }, '050-6522-1519')
          )
        ),
        React.createElement('p', { className: 'text-xs text-gray-500 text-center mt-2' }, '문의 답변은 영업일 기준 1~2일 내에 드립니다')
      )
    )
  );

  // ===== 공통: 문의 화면 래퍼 =====
  const InquiryWrapper = ({ title, icon, children }) =>
    React.createElement('div', { className: 'min-h-screen pb-28' },
      React.createElement('header', { className: 'flex items-center gap-3 p-4 border-b border-white/10' },
        React.createElement('button', {
          onClick: () => setScreen('inquiry'),
          className: 'w-9 h-9 flex items-center justify-center hover:bg-white/10 rounded-lg transition-all text-xl'
        }, '←'),
        React.createElement('span', { className: 'text-xl' }, icon),
        React.createElement('h1', { className: 'font-bold text-base ml-1' }, title)
      ),
      React.createElement('div', { className: 'p-4 space-y-3' }, children)
    );

  const SubmitSuccess = ({ message, sub }) =>
    React.createElement('div', { className: 'glass rounded-2xl p-10 text-center mt-10' },
      React.createElement('div', { className: 'text-5xl mb-4' }, '✅'),
      React.createElement('h2', { className: 'text-lg font-bold mb-2' }, message),
      React.createElement('p', { className: 'text-gray-400 text-sm leading-relaxed' }, sub),
      React.createElement('button', {
        onClick: () => setScreen('inquiry'),
        className: 'mt-6 px-6 py-3 gradient-primary rounded-xl font-bold text-sm'
      }, '문의하기로 돌아가기')
    );

  // ===== 오류 문의 =====
  const ErrorInquiryScreen = () => {
    const [category, setCategory] = React.useState('');
    const [text, setText] = React.useState('');
    const [submitted, setSubmitted] = React.useState(false);
    const cats = ['결제 오류', '결과 화면 오류', '로그인 오류', '앱 실행 오류', '속도·로딩 오류', '기타 오류'];
    if (submitted) return React.createElement(InquiryWrapper, { title: '오류 문의', icon: '🔧' },
      React.createElement(SubmitSuccess, { message: '오류 문의가 접수되었습니다', sub: '영업일 기준 1~2일 내로 이메일로 답변드리겠습니다.\n빠른 해결을 위해 최선을 다하겠습니다.' })
    );
    return React.createElement(InquiryWrapper, { title: '오류 문의', icon: '🔧' },
      React.createElement('div', { className: 'glass rounded-2xl p-4' },
        React.createElement('p', { className: 'text-xs text-gray-400 mb-3 font-medium' }, '오류 유형'),
        React.createElement('div', { className: 'grid grid-cols-2 gap-2' },
          cats.map(c => React.createElement('button', {
            key: c, onClick: () => setCategory(c),
            className: `py-2.5 px-3 rounded-xl text-sm border transition-all ${category === c ? 'bg-purple-500/30 border-purple-500/50 text-purple-300 font-medium' : 'bg-white/5 border-white/10 text-gray-400 hover:bg-white/10'}`
          }, c))
        )
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-4' },
        React.createElement('p', { className: 'text-xs text-gray-400 mb-2 font-medium' },
          '상세 내용 ', React.createElement('span', { className: 'text-red-400' }, '(필수)')
        ),
        React.createElement('textarea', {
          className: 'w-full bg-white/5 border border-white/10 rounded-xl p-3 text-sm text-white placeholder-gray-500 outline-none focus:border-purple-500/50 resize-none',
          rows: 5, maxLength: 500, value: text, onChange: e => setText(e.target.value),
          placeholder: '어떤 오류가 발생했는지 상황을 자세히 알려주세요.\n예) 결제 후 결과 화면이 나타나지 않고 흰 화면이 표시됩니다.'
        }),
        React.createElement('p', { className: 'text-xs text-gray-500 text-right mt-1' }, `${text.length}/500`)
      ),
      React.createElement('button', {
        onClick: () => {
          if (!category) { alert('오류 유형을 선택해주세요.'); return; }
          if (text.trim().length < 10) { alert('오류 내용을 10자 이상 입력해주세요.'); return; }
          setSubmitted(true);
        },
        className: 'w-full py-4 gradient-primary rounded-2xl font-bold'
      }, '문의 접수하기')
    );
  };

  // ===== 피드백 보내기 =====
  const FeedbackScreen = () => {
    const [type, setType] = React.useState('');
    const [text, setText] = React.useState('');
    const [submitted, setSubmitted] = React.useState(false);
    const types = [{ id: 'feature', label: '기능 추가 요청', icon: '✨' }, { id: 'improve', label: '개선 의견', icon: '🔧' }, { id: 'content', label: '콘텐츠 의견', icon: '📖' }, { id: 'other', label: '기타 의견', icon: '💬' }];
    if (submitted) return React.createElement(InquiryWrapper, { title: '피드백 보내기', icon: '💬' },
      React.createElement(SubmitSuccess, { message: '소중한 의견 감사합니다', sub: '여러분의 피드백이 사주ON을\n더 좋은 서비스로 만들어갑니다 🙏' })
    );
    return React.createElement(InquiryWrapper, { title: '피드백 보내기', icon: '💬' },
      React.createElement('div', { className: 'glass rounded-2xl p-5' },
        React.createElement('p', { className: 'font-medium text-sm mb-0.5' }, '사주ON을 더 좋게 만들어주세요 🙌'),
        React.createElement('p', { className: 'text-xs text-gray-500' }, '소중한 의견을 서비스 개선에 반영합니다')
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-4' },
        React.createElement('p', { className: 'text-xs text-gray-400 mb-3 font-medium' }, '의견 유형'),
        React.createElement('div', { className: 'grid grid-cols-2 gap-2' },
          types.map(t => React.createElement('button', {
            key: t.id, onClick: () => setType(t.id),
            className: `py-3 px-3 rounded-xl text-sm border transition-all flex items-center gap-2 ${type === t.id ? 'bg-purple-500/30 border-purple-500/50 text-purple-300 font-medium' : 'bg-white/5 border-white/10 text-gray-400 hover:bg-white/10'}`
          }, React.createElement('span', null, t.icon), t.label))
        )
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-4' },
        React.createElement('p', { className: 'text-xs text-gray-400 mb-2 font-medium' }, '의견 내용'),
        React.createElement('textarea', {
          className: 'w-full bg-white/5 border border-white/10 rounded-xl p-3 text-sm text-white placeholder-gray-500 outline-none focus:border-purple-500/50 resize-none',
          rows: 5, value: text, onChange: e => setText(e.target.value),
          placeholder: '예) 타로 운세 기능을 추가해주세요!\n예) 결과 화면에서 공유 기능이 있으면 좋겠어요.\n어떤 의견이든 소중하게 반영하겠습니다.'
        })
      ),
      React.createElement('button', {
        onClick: () => {
          if (!type) { alert('의견 유형을 선택해주세요.'); return; }
          if (!text.trim()) { alert('의견 내용을 입력해주세요.'); return; }
          setSubmitted(true);
        },
        className: 'w-full py-4 gradient-primary rounded-2xl font-bold'
      }, '피드백 보내기')
    );
  };

  // ===== 리뷰 남기기 =====
  const ReviewScreen = () => {
    const [rating, setRating] = React.useState(0);
    const [text, setText] = React.useState('');
    const [agree, setAgree] = React.useState(false);
    const [submitted, setSubmitted] = React.useState(false);
    const labels = ['', '별로예요', '아쉬워요', '보통이에요', '좋아요', '최고예요!'];
    if (submitted) return React.createElement(InquiryWrapper, { title: '리뷰 남기기', icon: '⭐' },
      React.createElement(SubmitSuccess, { message: '리뷰 등록 완료!', sub: '소중한 후기가 사주ON의 큰 힘이 됩니다 ⭐' })
    );
    return React.createElement(InquiryWrapper, { title: '리뷰 남기기', icon: '⭐' },
      React.createElement('div', { className: 'glass rounded-2xl p-6 text-center' },
        React.createElement('p', { className: 'text-sm text-gray-300 mb-4' }, '사주ON 이용 경험은 어떠셨나요?'),
        React.createElement('div', { className: 'flex justify-center gap-2 mb-2' },
          [1,2,3,4,5].map(star => React.createElement('button', {
            key: star, onClick: () => setRating(star),
            className: 'text-4xl transition-all active:scale-110',
            style: { color: star <= rating ? '#f59e0b' : '#374151' }
          }, '★'))
        ),
        rating > 0 && React.createElement('p', { className: 'text-purple-300 font-bold text-sm mt-1 animate-pulse' }, labels[rating])
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-4' },
        React.createElement('p', { className: 'text-xs text-gray-400 mb-2 font-medium' }, '상세 후기'),
        React.createElement('textarea', {
          className: 'w-full bg-white/5 border border-white/10 rounded-xl p-3 text-sm text-white placeholder-gray-500 outline-none focus:border-purple-500/50 resize-none',
          rows: 5, value: text, onChange: e => setText(e.target.value),
          placeholder: '사주ON을 이용하신 느낌을 자유롭게 남겨주세요.\n다른 분들께 소중한 참고가 됩니다.'
        })
      ),
      React.createElement('div', {
        onClick: () => setAgree(!agree),
        className: 'glass rounded-xl p-3 flex items-start gap-3 cursor-pointer hover:bg-white/5 transition-all'
      },
        React.createElement('div', { className: `mt-0.5 w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 transition-all ${agree ? 'bg-purple-500 border-purple-500' : 'border-white/30'}` },
          agree && React.createElement('span', { className: 'text-white text-xs font-bold' }, '✓')
        ),
        React.createElement('p', { className: 'text-xs text-gray-400 leading-relaxed' },
          '작성한 리뷰는 서비스 소개 및 홍보 목적으로 활용될 수 있으며, 이에 동의합니다.'
        )
      ),
      React.createElement('button', {
        onClick: () => {
          if (rating === 0) { alert('별점을 선택해주세요.'); return; }
          if (!text.trim()) { alert('후기 내용을 입력해주세요.'); return; }
          if (!agree) { alert('리뷰 활용 동의가 필요합니다.'); return; }
          setSubmitted(true);
        },
        className: 'w-full py-4 gradient-primary rounded-2xl font-bold'
      }, '리뷰 등록하기')
    );
  };

  // ===== 환불 문의 =====
  const RefundScreen = () => {
    const [orderId, setOrderId] = React.useState('');
    const [reason, setReason] = React.useState('');
    const [text, setText] = React.useState('');
    const [submitted, setSubmitted] = React.useState(false);
    const reasons = ['콘텐츠 미열람 + 7일 이내', '단순 변심 (미이용)', '중복 결제', '결제 오류', '서비스 장애로 미이용'];
    if (submitted) return React.createElement(InquiryWrapper, { title: '환불 문의', icon: '💰' },
      React.createElement(SubmitSuccess, { message: '환불 문의가 접수되었습니다', sub: '영업일 기준 3일 이내 검토 후 이메일로 안내드립니다.\n환불 가능 여부 확인 후 신속히 처리해드리겠습니다.' })
    );
    return React.createElement(InquiryWrapper, { title: '환불 문의', icon: '💰' },
      // 환불 정책 안내박스
      React.createElement('div', { className: 'glass rounded-2xl p-4 border border-amber-500/25 bg-amber-500/5' },
        React.createElement('p', { className: 'text-xs font-bold text-amber-400 mb-3 flex items-center gap-1.5' },
          React.createElement('span', null, '📋'), '환불 규정 안내 (전자상거래법 제17조)'
        ),
        [
          { color: 'text-green-400', text: '✅ 전액 환불: 콘텐츠 미열람 상태에서 결제일로부터 7일 이내' },
          { color: 'text-green-400', text: '✅ 전액 환불: 결제 오류 또는 중복 결제가 발생한 경우' },
          { color: 'text-green-400', text: '✅ 전액 환불: 회사 귀책 사유로 서비스를 정상 이용하지 못한 경우' },
          { color: 'text-red-400', text: '❌ 환불 불가: AI 사주·궁합·운세 콘텐츠를 이미 열람한 경우 (즉시 생성·제공 콘텐츠, 동법 제17조 제2항)' },
          { color: 'text-red-400', text: '❌ 환불 불가: 결제일로부터 7일 초과한 경우' },
        ].map((item, i) => React.createElement('p', { key: i, className: `text-xs leading-relaxed mb-1.5 ${item.color}` }, item.text))
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-4' },
        React.createElement('p', { className: 'text-xs text-gray-400 mb-2 font-medium' }, '결제 정보 (주문번호 또는 결제 일시)'),
        React.createElement('input', {
          className: 'w-full bg-white/5 border border-white/10 rounded-xl px-3 py-3 text-sm text-white placeholder-gray-500 outline-none focus:border-purple-500/50',
          placeholder: '예) 2025-01-01 / 카카오페이 결제 ₩1,900',
          value: orderId, onChange: e => setOrderId(e.target.value)
        })
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-4' },
        React.createElement('p', { className: 'text-xs text-gray-400 mb-3 font-medium' }, '환불 사유'),
        React.createElement('div', { className: 'space-y-2' },
          reasons.map(r => React.createElement('button', {
            key: r, onClick: () => setReason(r),
            className: `w-full py-2.5 px-4 rounded-xl text-sm border transition-all text-left ${reason === r ? 'bg-purple-500/30 border-purple-500/50 text-purple-300 font-medium' : 'bg-white/5 border-white/10 text-gray-400 hover:bg-white/10'}`
          }, r))
        )
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-4' },
        React.createElement('p', { className: 'text-xs text-gray-400 mb-2 font-medium' }, '상세 내용'),
        React.createElement('textarea', {
          className: 'w-full bg-white/5 border border-white/10 rounded-xl p-3 text-sm text-white placeholder-gray-500 outline-none focus:border-purple-500/50 resize-none',
          rows: 4, value: text, onChange: e => setText(e.target.value),
          placeholder: '환불 요청 상황을 상세히 적어주세요.'
        })
      ),
      React.createElement('button', {
        onClick: () => {
          if (!orderId.trim()) { alert('결제 정보를 입력해주세요.'); return; }
          if (!reason) { alert('환불 사유를 선택해주세요.'); return; }
          setSubmitted(true);
        },
        className: 'w-full py-4 gradient-primary rounded-2xl font-bold'
      }, '환불 문의 접수하기')
    );
  };

  // ===== 기타 문의 =====
  const OtherInquiryScreen = () => {
    const [subject, setSubject] = React.useState('');
    const [text, setText] = React.useState('');
    const [submitted, setSubmitted] = React.useState(false);
    if (submitted) return React.createElement(InquiryWrapper, { title: '기타 문의', icon: '📮' },
      React.createElement(SubmitSuccess, { message: '문의가 접수되었습니다', sub: '영업일 기준 1~2일 내로 이메일로 답변드리겠습니다.' })
    );
    return React.createElement(InquiryWrapper, { title: '기타 문의', icon: '📮' },
      React.createElement('div', { className: 'glass rounded-2xl p-4' },
        React.createElement('p', { className: 'text-xs text-gray-400 mb-2 font-medium' }, '문의 제목'),
        React.createElement('input', {
          className: 'w-full bg-white/5 border border-white/10 rounded-xl px-3 py-3 text-sm text-white placeholder-gray-500 outline-none focus:border-purple-500/50',
          placeholder: '문의 제목을 간략히 입력해주세요',
          value: subject, onChange: e => setSubject(e.target.value)
        })
      ),
      React.createElement('div', { className: 'glass rounded-2xl p-4' },
        React.createElement('p', { className: 'text-xs text-gray-400 mb-2 font-medium' }, '문의 내용'),
        React.createElement('textarea', {
          className: 'w-full bg-white/5 border border-white/10 rounded-xl p-3 text-sm text-white placeholder-gray-500 outline-none focus:border-purple-500/50 resize-none',
          rows: 7, maxLength: 1000, value: text, onChange: e => setText(e.target.value),
          placeholder: '궁금하신 내용을 자유롭게 작성해주세요.\n최대한 빠르게 답변드리겠습니다.'
        }),
        React.createElement('p', { className: 'text-xs text-gray-500 text-right mt-1' }, `${text.length}/1000`)
      ),
      React.createElement('div', { className: 'glass rounded-xl p-3 flex items-center gap-2' },
        React.createElement('span', { className: 'text-lg' }, '📧'),
        React.createElement('p', { className: 'text-xs text-gray-400' }, '답변은 가입하신 이메일로 발송됩니다.')
      ),
      React.createElement('button', {
        onClick: () => {
          if (!subject.trim()) { alert('문의 제목을 입력해주세요.'); return; }
          if (text.trim().length < 10) { alert('문의 내용을 10자 이상 입력해주세요.'); return; }
          setSubmitted(true);
        },
        className: 'w-full py-4 gradient-primary rounded-2xl font-bold'
      }, '문의 접수하기')
    );
  };

  // ===== 서비스 이용약관 (전자상거래법 기준) =====
  const TermsScreen = () => {
    const [openIdx, setOpenIdx] = React.useState(null);
    const articles = [
      { title: '제1조 목적', content: '이 약관은 사주ON(이하 "회사")이 운영하는 웹·앱 서비스(이하 "서비스")의 이용에 관하여 회사와 이용자 간의 권리·의무 및 책임사항, 기타 필요한 사항을 규정함을 목적으로 합니다.\n\n회사는 전통 명리학 기반의 사주·궁합·운세 콘텐츠를 AI를 통해 제공하며, 본 약관은 이에 관한 모든 사항에 적용됩니다.' },
      { title: '제2조 용어의 정의', content: '① "서비스"란 사주ON 플랫폼(웹/앱)에서 이용자가 이용하는 모든 콘텐츠와 기능을 말합니다.\n② "이용자"란 본 약관에 따라 회사가 제공하는 서비스를 이용하는 자를 말합니다.\n③ "회원"이란 소셜 계정으로 가입하여 이용자 ID를 부여받은 자를 말합니다.\n④ "콘텐츠"란 회사가 AI를 통해 즉시 생성·제공하는 사주·궁합·신년운세 등의 분석 결과물을 말합니다.\n⑤ "결제"란 서비스 이용을 위해 이용자가 카드, 간편결제 등 수단으로 대금을 지불하는 행위를 말합니다.' },
      { title: '제3조 회사 정보 고지', content: '회사는 전자상거래 등에서의 소비자보호에 관한 법률 제13조에 따라 다음 사항을 서비스 내에 공개합니다.\n\n· 상호 및 대표자 성명\n· 사업장 소재지 주소\n· 전화번호 및 전자우편주소\n· 사업자 등록번호\n· 통신판매업 신고번호\n· 개인정보 처리방침 및 이용약관 (서비스 내 상시 열람 가능)' },
      { title: '제4조 약관의 효력 및 개정', content: '① 본 약관은 서비스 화면에 공지함으로써 효력이 발생합니다.\n② 약관 개정 시 적용 일자와 변경 사유를 명시하여 시행일 7일 이전부터 공지합니다.\n단, 이용자에게 불리한 내용을 변경할 경우에는 30일 이전에 공지하며, 이메일 등으로 개별 고지합니다.\n③ 공지 후 이용자가 이의를 제기하지 않으면 개정 약관에 동의한 것으로 봅니다.\n④ 이용자는 개정 약관에 동의하지 않을 경우 회원 탈퇴를 요청할 수 있습니다.' },
      { title: '제5조 이용계약 체결 및 제한', content: '① 이용계약은 이용자가 약관에 동의하고 소셜 로그인(카카오/네이버/구글)으로 회원가입을 완료한 시점에 성립합니다.\n② 다음에 해당하는 경우 가입 신청을 거부하거나 사후 이용계약을 해지할 수 있습니다.\n· 타인의 명의 또는 정보를 도용한 경우\n· 허위 정보를 기재하거나 부정한 방법으로 가입한 경우\n· 서비스 운영을 방해하는 행위를 한 경우\n③ 만 14세 미만의 이용자는 서비스 가입 및 유료 결제가 제한됩니다. 만 14세 이상 만 19세 미만의 미성년자가 유료 서비스를 이용할 경우 법정대리인의 동의가 필요합니다.' },
      { title: '제6조 서비스의 내용 및 변경', content: '① 회사는 다음 서비스를 제공합니다.\n· 기본 만세력 분석 (무료)\n· AI 기반 상세 사주 분석 (유료)\n· AI 기반 궁합 분석 (유료)\n· AI 기반 신년운세 분석 (유료)\n② 서비스 내용은 AI 모델 업데이트, 기술 변경, 운영 정책 등의 이유로 변경될 수 있으며, 중요 변경 시 사전에 공지합니다.\n③ 회사는 서비스 품질 향상을 위해 기능을 추가하거나 일부를 수정할 수 있습니다.' },
      { title: '제7조 서비스의 중단 및 종료', content: '① 다음의 경우 서비스를 일시 중단할 수 있습니다.\n· 서버 점검, 설비 보수, AI 모델 교체 등 기술적 사유\n· 사이버 공격, 해킹, 천재지변 등 불가항력적 사유\n② 정기 점검은 사전에, 긴급 점검은 사후에 공지합니다.\n③ 경영상 이유로 서비스를 종료할 경우 서비스 내에 30일 이전 공지하며, 미사용 결제 금액은 관련 법령에 따라 환급합니다.\n④ 불가항력적 사유로 인한 서비스 중단에 대해 회사는 고의 또는 중대한 과실이 없는 한 책임지지 않습니다.' },
      { title: '제8조 이용자의 의무', content: '이용자는 다음 행위를 하여서는 안 됩니다.\n\n① 타인의 정보를 도용하거나 허위 정보를 제공하는 행위\n② 서비스 내 콘텐츠를 무단 복제·배포·판매·재가공하는 행위\n③ 회사 또는 제3자의 지식재산권을 침해하는 행위\n④ 서버에 과부하를 주거나 크롤링·자동화 도구로 콘텐츠를 수집하는 행위\n⑤ 음란·불법·혐오 정보를 게시하거나 전파하는 행위\n⑥ 기타 관련 법령에 위반되거나 공서양속에 반하는 행위\n⑦ 위반 시 서비스 이용이 제한되거나 법적 조치를 받을 수 있습니다.' },
      { title: '제9조 유료 콘텐츠 구매', content: '① 이용자는 서비스 내 유료 콘텐츠를 선택하고 결제할 수 있습니다.\n② 결제 가능 수단: 카카오페이, 토스페이먼츠(신용카드·체크카드·계좌이체) 등 회사가 지정하는 수단\n③ AI 콘텐츠(사주·궁합·운세 분석)는 결제 즉시 생성·제공됩니다. 이용자는 결제 전 이 사실에 동의합니다.\n④ 미성년자가 법정대리인의 동의 없이 결제한 경우, 법정대리인은 청약철회를 요청할 수 있습니다.\n⑤ 콘텐츠는 재미·참고 목적이며, 실제 미래를 예측하거나 보장하지 않습니다.' },
      { title: '제10조 청약철회 및 환불 정책', content: '① 이용자는 전자상거래 등에서의 소비자보호에 관한 법률 제17조에 따라 결제일로부터 7일 이내에 청약철회를 요청할 수 있습니다.\n\n② 다음의 경우 청약철회가 제한됩니다 (동법 제17조 제2항).\n· 이용자 주문에 따라 즉시 생성되는 AI 콘텐츠를 이미 열람한 경우\n  (회사는 결제 전 이 사실을 명시하고 이용자 확인을 받습니다)\n\n③ 다음의 경우 전액 환불합니다.\n· 결제 오류 또는 중복 결제가 발생한 경우\n· 회사의 귀책 사유로 콘텐츠를 정상 이용하지 못한 경우\n· 콘텐츠를 전혀 이용하지 않은 상태에서 결제일로부터 7일 이내 요청한 경우\n\n④ 환불 신청 방법: 서비스 내 [문의하기 → 환불 문의] 또는 고객센터 이메일\n⑤ 환불 처리 기간: 접수 확인 후 영업일 기준 3~5일 이내\n⑥ 환불 금액은 결제 수단에 따라 카드 취소 또는 계좌 이체로 처리됩니다.' },
      { title: '제11조 지식재산권 보호', content: '① 서비스에서 제공하는 모든 콘텐츠(AI 생성 결과물, 디자인, 텍스트, 이미지 등)의 저작권 및 지식재산권은 회사에 귀속됩니다.\n② 이용자는 서비스 이용 중 취득한 정보를 회사의 사전 서면 동의 없이 복제·전송·출판·배포·방송하거나 제3자에게 제공하는 행위를 할 수 없습니다.\n③ 이용자의 무단 이용에 대해 회사는 민·형사상 법적 조치를 취할 수 있습니다.' },
      { title: '제12조 면책 조항', content: '① 사주ON의 사주·궁합·운세 콘텐츠는 전통 명리학 및 AI를 기반으로 한 참고·오락 목적이며, 실제 미래 예측이나 중요한 인생 결정의 근거로 사용되어서는 안 됩니다. 이로 인한 결과에 대해 회사는 책임지지 않습니다.\n② 천재지변, 전쟁, 인터넷 장애 등 불가항력적 사유로 인한 서비스 중단에 대해 회사는 책임지지 않습니다.\n③ 이용자의 귀책 사유로 발생한 손해에 대해 회사는 책임지지 않습니다.\n④ 서비스를 통해 연결된 외부 링크 또는 제3자 서비스에서 발생한 문제에 대해 회사는 책임지지 않습니다.' },
      { title: '제13조 분쟁 해결 및 준거법', content: '① 분쟁 발생 시 회사와 이용자는 상호 성실한 협의를 통해 해결을 우선합니다.\n② 협의가 이루어지지 않는 경우 소비자분쟁조정위원회(www.cckorea.or.kr) 또는 한국소비자원(www.kca.go.kr)에 분쟁 조정을 신청할 수 있습니다.\n③ 본 약관은 대한민국 법률에 따라 규율됩니다.\n④ 소송이 필요한 경우 민사소송법에 따른 관할법원에 제기합니다.' }
    ];
    return React.createElement('div', { className: 'min-h-screen bg-[#1a1a2e] text-white pb-28' },
      React.createElement('div', { className: 'sticky top-0 z-20 flex items-center p-4 bg-[#1a1a2e] border-b border-white/10' },
        React.createElement('button', { onClick: () => history.back(), className: 'mr-3 p-2 hover:bg-white/10 rounded-lg transition-all text-gray-300' }, '←'),
        React.createElement('span', { className: 'font-bold text-lg' }, '서비스 이용약관')
      ),
      React.createElement('div', { className: 'px-4 py-5' },
        React.createElement('div', { className: 'glass rounded-2xl p-5 mb-4 text-center' },
          React.createElement('div', { className: 'text-3xl mb-2' }, '📜'),
          React.createElement('h1', { className: 'text-base font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent mb-1' }, '사주ON 서비스 이용약관'),
          React.createElement('p', { className: 'text-xs text-gray-500' }, '전자상거래 등에서의 소비자보호에 관한 법률 기준')
        ),
        React.createElement('div', { className: 'space-y-2' },
          articles.map((a, i) =>
            React.createElement('div', { key: i, className: `glass rounded-xl overflow-hidden transition-all ${openIdx === i ? 'ring-1 ring-purple-500/40' : ''}` },
              React.createElement('button', {
                className: 'w-full flex items-center justify-between p-4 text-left hover:bg-white/5 transition-all',
                onClick: () => setOpenIdx(openIdx === i ? null : i)
              },
                React.createElement('div', { className: 'flex items-center gap-3' },
                  React.createElement('span', { className: `text-xs font-bold px-2 py-0.5 rounded-full ${openIdx === i ? 'bg-purple-500/30 text-purple-300' : 'bg-white/10 text-gray-400'}` }, String(i+1).padStart(2,'0')),
                  React.createElement('span', { className: `font-medium text-sm ${openIdx === i ? 'text-purple-300' : 'text-gray-200'}` }, a.title)
                ),
                React.createElement('span', { className: `text-gray-400 text-xs transition-transform duration-300 ${openIdx === i ? 'rotate-180' : ''}`, style: { display:'inline-block' } }, '▼')
              ),
              openIdx === i && React.createElement('div', { className: 'px-4 pb-4 pt-1 border-t border-white/5' },
                React.createElement('div', { className: 'bg-white/5 rounded-xl p-4' },
                  a.content.split('\n').map((line, li) =>
                    React.createElement('p', { key: li, className: 'text-sm text-gray-300 leading-7' }, line || '\u00A0')
                  )
                )
              )
            )
          )
        ),
        React.createElement('div', { className: 'glass rounded-xl p-4 mt-4 space-y-1.5' },
          React.createElement('p', { className: 'text-xs text-gray-500' }, '📅 시행일: 서비스 출시일 기준 적용'),
          React.createElement('p', { className: 'text-xs text-gray-500' }, '📧 문의: 앱 내 [문의하기] 또는 고객센터 이메일'),
          React.createElement('p', { className: 'text-xs text-gray-500' }, '🏛 소비자상담: 한국소비자원 1372 / 공정거래위원회 1800-0182')
        )
      )
    );
  };

  // ===== 개인정보 처리방침 (개인정보보호법 기준) =====
  const PrivacyScreen = () => {
    const [openIdx, setOpenIdx] = React.useState(null);
    const articles = [
      { title: '제1조 개인정보 수집 및 이용 목적', content: '사주ON(이하 "회사")은 개인정보보호법 제15조에 따라 다음 목적으로만 개인정보를 수집·이용합니다.\n\n① 회원 가입 및 관리: 본인 식별·인증, 부정가입 방지, 회원 자격 유지, 서비스 관련 고지\n② 서비스 제공: 사주·궁합·운세 콘텐츠 생성·제공, 결제 및 환불 처리, 고객지원\n③ 마케팅·광고: 신규 서비스 안내, 맞춤형 광고 (이용자가 별도로 동의한 경우에 한함)\n④ 서비스 개선: 이용 통계 분석, 오류 추적, 서비스 품질 향상\n\n수집 목적과 다른 목적으로는 이용하지 않으며, 목적이 변경될 경우 별도 동의를 받겠습니다.' },
      { title: '제2조 수집하는 개인정보 항목 및 수집 방법', content: '[필수 수집 항목]\n· 소셜 로그인 정보\n  - 카카오: 닉네임, 이메일, 프로필 사진\n  - 네이버: 이메일\n  - 구글: 이메일, 이름\n· 서비스 이용 기록, 접속 로그, 접속 IP, 쿠키\n\n[선택 수집 항목]\n· 생년월일시 (사주 분석 이용 시 이용자가 직접 입력)\n· 성별\n· 마케팅 수신 동의 여부\n\n[결제 관련]\n· 결제 수단 정보는 PG사(카카오페이·토스페이먼츠)가 직접 처리하며, 회사는 카드번호 등 민감한 결제 정보를 저장하지 않습니다.\n\n[수집 방법]\n· 이용자가 서비스 가입·이용 시 직접 입력\n· 서비스 이용 과정에서 자동 생성·수집 (쿠키, 로그 등)' },
      { title: '제3조 개인정보 보유 및 이용 기간', content: '회사는 개인정보 수집·이용 목적이 달성된 후 지체 없이 파기합니다.\n단, 관련 법령에 따라 아래 기간 동안 보존합니다.\n\n[회사 내부 방침]\n· 회원 정보: 회원 탈퇴 시까지\n· 부정이용 방지 기록: 탈퇴 후 1년\n\n[법령에 의한 의무 보존]\n· 계약 또는 청약철회에 관한 기록: 5년\n  (전자상거래 등에서의 소비자보호에 관한 법률)\n· 대금결제 및 재화 공급에 관한 기록: 5년\n  (전자상거래 등에서의 소비자보호에 관한 법률)\n· 소비자 불만 또는 분쟁 처리에 관한 기록: 3년\n  (전자상거래 등에서의 소비자보호에 관한 법률)\n· 전기통신 사실 확인자료 (로그): 3개월\n  (통신비밀보호법)\n· 세법이 규정하는 모든 거래에 관한 장부 및 증빙서류: 5년\n  (국세기본법)' },
      { title: '제4조 개인정보의 제3자 제공', content: '회사는 이용자의 개인정보를 원칙적으로 제3자에게 제공하지 않습니다.\n\n단, 다음의 경우에는 예외적으로 제공될 수 있습니다.\n\n① 이용자가 사전에 동의한 경우\n② 법령의 규정에 의거하거나, 적법한 절차에 따른 수사기관의 요청이 있는 경우\n③ 결제 처리를 위해 PG사에 최소한의 정보를 전달하는 경우\n\n제3자 제공 시에는 제공 목적·항목·보유기간·제공 받는 자를 이용자에게 고지하고 동의를 받습니다.' },
      { title: '제5조 개인정보 처리 위탁 및 국외 이전', content: '회사는 원활한 서비스 제공을 위해 아래 업체에 개인정보 처리 업무를 위탁합니다.\n\n[Google LLC (Firebase / Google Cloud Platform)]\n· 위탁 국가: 미국\n· 위탁 업무: 회원 인증 정보 저장, 데이터베이스 운영, 서비스 인프라\n· 보유 기간: 회원 탈퇴 또는 서비스 종료 시까지\n· 개인정보처리방침: https://policies.google.com/privacy\n\n[카카오 (주) / 네이버 (주)]\n· 위탁 업무: 소셜 로그인 인증 처리\n· 보유 기간: 인증 완료 즉시 파기\n\n위탁 업체는 위탁받은 업무 목적 외 개인정보를 이용하지 않으며, 개인정보보호 관련 법령을 준수합니다.' },
      { title: '제6조 개인정보의 파기', content: '개인정보 보유 기간이 경과하거나 처리 목적이 달성된 경우 지체 없이 파기합니다.\n\n[파기 절차]\n파기 대상 개인정보를 선정하고, 개인정보 보호책임자의 승인을 받아 파기합니다.\n\n[파기 방법]\n· 전자적 파일: 복구 불가능한 기술적 방법으로 영구 삭제\n  (예: 덮어쓰기, 데이터 와이핑 등)\n· 종이 문서: 분쇄기로 분쇄하거나 소각 처리' },
      { title: '제7조 이용자의 권리 및 행사 방법', content: '이용자(정보주체)는 언제든지 다음 권리를 행사할 수 있습니다.\n\n· 개인정보 열람 요청 (개인정보보호법 제35조)\n· 오류 정정 요청 (제36조)\n· 처리 정지 요청 (제37조)\n· 삭제 요청·동의 철회 (회원 탈퇴)\n\n[행사 방법]\n· 앱 내 [설정 → 계정 관리] 메뉴에서 직접 처리\n· 아래 개인정보 보호책임자에게 이메일로 요청\n\n회사는 요청 접수 후 10일 이내 처리하며, 거부 사유가 있을 경우 사유를 알려드립니다.\n\n만 14세 미만 아동의 법정대리인은 아동의 개인정보에 대해 위 권리를 대신 행사할 수 있습니다.' },
      { title: '제8조 쿠키(Cookie) 운영', content: '회사는 맞춤형 서비스 제공 및 이용 통계 분석을 위해 쿠키를 사용합니다.\n\n[쿠키 사용 목적]\n· 로그인 상태 유지\n· 서비스 이용 패턴 분석 및 통계\n· 이용자 맞춤형 서비스 제공\n\n[쿠키 거부 방법]\n이용자는 브라우저 설정을 통해 쿠키 저장을 거부할 수 있습니다.\n예) Chrome: 설정 → 개인정보 및 보안 → 쿠키 및 사이트 데이터\n\n※ 쿠키 거부 시 로그인 유지 등 일부 서비스 기능이 제한될 수 있습니다.' },
      { title: '제9조 개인정보의 안전성 확보 조치', content: '회사는 개인정보보호법 제29조에 따라 다음과 같은 기술적·관리적·물리적 조치를 시행합니다.\n\n[기술적 조치]\n· 전송 구간 암호화 (SSL/TLS 적용)\n· 개인정보 접근 권한 최소화 및 관리\n· 해킹·악성코드 방지를 위한 보안 프로그램 운영\n· 개인정보처리시스템 접속 기록 보관 및 위변조 방지\n\n[관리적 조치]\n· 개인정보 취급 직원 최소화 및 정기 교육\n· 개인정보보호 내부 관리계획 수립 및 이행 점검\n\n[물리적 조치]\n· 개인정보 보관 서버실 출입 통제 및 접근 권한 관리' },
      { title: '제10조 개인정보 보호책임자 및 문의처', content: '개인정보보호법 제31조에 따라 개인정보 처리에 관한 업무를 총괄하는 개인정보 보호책임자를 지정합니다.\n\n[개인정보 보호책임자]\n· 성명: 고승우\n· 직책: 대표\n· 이메일: godwk15@naver.com\n· 전화: 050-6522-1519\n\n개인정보 침해 관련 신고·상담은 아래 기관에 문의하실 수 있습니다.\n\n· 개인정보보호위원회: www.pipc.go.kr / ☎ 국번없이 182\n· 개인정보 침해신고센터: privacy.kisa.or.kr / ☎ 국번없이 118\n· 대검찰청 사이버범죄수사단: www.spo.go.kr / ☎ 02-3480-3571\n· 경찰청 사이버안전국: cyberbureau.police.go.kr / ☎ 국번없이 182' },
      { title: '제11조 개인정보 처리방침의 변경', content: '① 본 방침은 법령·정책 또는 보안기술의 변경에 따라 수정될 수 있습니다.\n② 개정 시 시행일자 및 주요 변경 사항을 서비스 내 공지사항을 통해 안내합니다.\n③ 이용자에게 불리한 내용이 변경될 경우 시행 30일 이전부터 공지하며, 별도 이메일 통지를 병행합니다.\n④ 변경된 방침은 공지일로부터 7일 이후부터 효력이 발생합니다 (불리한 변경의 경우 30일 이후 시행).' }
    ];
    return React.createElement('div', { className: 'min-h-screen bg-[#1a1a2e] text-white pb-28' },
      React.createElement('div', { className: 'sticky top-0 z-20 flex items-center p-4 bg-[#1a1a2e] border-b border-white/10' },
        React.createElement('button', { onClick: () => history.back(), className: 'mr-3 p-2 hover:bg-white/10 rounded-lg transition-all text-gray-300' }, '←'),
        React.createElement('span', { className: 'font-bold text-lg' }, '개인정보 처리방침')
      ),
      React.createElement('div', { className: 'px-4 py-5' },
        React.createElement('div', { className: 'glass rounded-2xl p-5 mb-4 text-center' },
          React.createElement('div', { className: 'text-3xl mb-2' }, '🔐'),
          React.createElement('h1', { className: 'text-base font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent mb-1' }, '사주ON 개인정보 처리방침'),
          React.createElement('p', { className: 'text-xs text-gray-500' }, '개인정보보호법 제30조 기준 · 회원님의 정보를 소중히 보호합니다')
        ),
        React.createElement('div', { className: 'space-y-2' },
          articles.map((a, i) =>
            React.createElement('div', { key: i, className: `glass rounded-xl overflow-hidden transition-all ${openIdx === i ? 'ring-1 ring-purple-500/40' : ''}` },
              React.createElement('button', {
                className: 'w-full flex items-center justify-between p-4 text-left hover:bg-white/5 transition-all',
                onClick: () => setOpenIdx(openIdx === i ? null : i)
              },
                React.createElement('div', { className: 'flex items-center gap-3' },
                  React.createElement('span', { className: `text-xs font-bold px-2 py-0.5 rounded-full ${openIdx === i ? 'bg-purple-500/30 text-purple-300' : 'bg-white/10 text-gray-400'}` }, String(i+1).padStart(2,'0')),
                  React.createElement('span', { className: `font-medium text-sm ${openIdx === i ? 'text-purple-300' : 'text-gray-200'}` }, a.title)
                ),
                React.createElement('span', { className: `text-gray-400 text-xs transition-transform duration-300 ${openIdx === i ? 'rotate-180' : ''}`, style: { display:'inline-block' } }, '▼')
              ),
              openIdx === i && React.createElement('div', { className: 'px-4 pb-4 pt-1 border-t border-white/5' },
                React.createElement('div', { className: 'bg-white/5 rounded-xl p-4' },
                  a.content.split('\n').map((line, li) =>
                    React.createElement('p', { key: li, className: 'text-sm text-gray-300 leading-7' }, line || '\u00A0')
                  )
                )
              )
            )
          )
        ),
        React.createElement('div', { className: 'glass rounded-xl p-4 mt-4 space-y-1.5' },
          React.createElement('p', { className: 'text-xs text-gray-500' }, '📅 시행일: 서비스 출시일 기준 적용'),
          React.createElement('p', { className: 'text-xs text-gray-500' }, '📧 개인정보 문의: godwk15@naver.com'),
          React.createElement('p', { className: 'text-xs text-gray-500' }, '🏛 침해 신고: 개인정보보호위원회 ☎ 182 / 개인정보침해신고센터 ☎ 118')
        )
      )
    );
  };

    const renderScreen = () => {
    switch(currentScreen) {
      case 'home': return React.createElement(HomeScreen);
      case 'input': return React.createElement(InputScreen);
      case 'free-result': return React.createElement(FreeResultScreen);
      case 'paid-result': return React.createElement(PaidResultScreen);
      case 'compatibility': return React.createElement(CompatibilityScreen);
      case 'compatibility-result': return React.createElement(CompatibilityResultScreen);
      case 'yearly': return React.createElement(YearlyScreen);
      case 'yearly-result': return React.createElement(YearlyResultScreen);
      case 'mypage': return React.createElement(MyPageScreen);
      case 'inquiry': return React.createElement(InquiryScreen);
      case 'history': return React.createElement(HistoryScreen);
      case 'about': return React.createElement(AboutScreen);
      case 'error-inquiry': return React.createElement(ErrorInquiryScreen);
      case 'feedback': return React.createElement(FeedbackScreen);
      case 'review': return React.createElement(ReviewScreen);
      case 'refund': return React.createElement(RefundScreen);
      case 'other-inquiry': return React.createElement(OtherInquiryScreen);
      case 'terms': return React.createElement(TermsScreen);
      case 'privacy': return React.createElement(PrivacyScreen);
      default: return React.createElement(HomeScreen);
    }
  };

  const baseNavItems = [
    { id: 'home', icon: '🏠', label: '홈' },
    { id: 'input', icon: '🔮', label: '사주' },
    { id: 'compatibility', icon: '💕', label: '궁합' },
    { id: 'yearly', icon: '🎊', label: '운세' },
  ];

  return React.createElement('div', { className: 'max-w-lg mx-auto relative' },
    React.createElement(Header),
    React.createElement('div', { className: 'pt-14' }, renderScreen()),
    React.createElement('nav', { className: 'fixed bottom-0 left-0 right-0 bg-[#1a1a2e] border-t border-white/10 z-40' },
      React.createElement('div', { className: 'max-w-lg mx-auto flex' },
        [...baseNavItems, ...(isLoggedIn ? [{ id: 'mypage', icon: '👤', label: 'MY' }] : [{ id: '__login__', icon: '🔑', label: '로그인' }])].map(item => React.createElement('button', { key: item.id, onClick: () => { 
          if (item.id === '__login__') { setShowLogin(true); return; }
          if (item.id === 'input') { setForm({ name:'', gender:'여성', calendar:'양력', year:'', month:'', day:'', hour:'', minute:'' }); setScreen('input'); window.scrollTo(0,0); return; }
          setScreen(item.id); 
        }, className: `flex-1 py-3 flex flex-col items-center ${currentScreen === item.id ? 'text-purple-400' : 'text-gray-500'}` },
          React.createElement('span', { className: 'text-lg' }, item.icon),
          React.createElement('span', { className: 'text-xs mt-1' }, item.label)
        ))
      )
    ),
    showLogin && React.createElement(LoginModal),
    showPayment && React.createElement(PaymentModal),
    showChargeModal && React.createElement(ChargeModal),
    showSideMenu && React.createElement(SideMenu)
  );
}

ReactDOM.createRoot(document.getElementById('app')).render(React.createElement(App));
</script>
</body>
</html>
